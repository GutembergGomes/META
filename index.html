<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GGOMES-LOG | Sistema de Gestão Agrícola Avançado</title>
    
    <!-- Tailwind CSS via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- jsPDF para relatórios -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://unpkg.com/jspdf-autotable@3.5.28/dist/jspdf.plugin.autotable.js"></script>
    
    <!-- Chart.js para gráficos -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <script>
    tailwind.config = {
        darkMode: 'class',
        theme: {
            extend: {
                colors: {
                    primary: {
                        50: '#f4f3ff',
                        100: '#e9e8ff',
                        200: '#d7d5ff',
                        300: '#bab8ff',
                        400: '#9a97ff',
                        500: '#7c7aff',
                        600: '#5D5CDE',
                        700: '#5a55cc',
                        800: '#4a46a8',
                        900: '#383670',
                        950: '#201f45',
                    }
                },
                fontFamily: {
                    'sans': ['Inter', 'system-ui', 'sans-serif'],
                },
                spacing: {
                    '128': '32rem',
                },
                animation: {
                    'fade-in': 'fadeIn 0.3s ease-out forwards',
                    'fade-out': 'fadeOut 0.3s ease-in forwards',
                    'slide-in': 'slideIn 0.3s ease-out forwards',
                    'pulse-slow': 'pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    'bounce-subtle': 'bounceSubtle 2s infinite',
                }
            }
        }
    }
    </script>
    
    <style>
        /* Animações customizadas */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes fadeOut {
            from { opacity: 1; transform: translateY(0); }
            to { opacity: 0; transform: translateY(-10px); }
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        @keyframes bounceSubtle {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-2px); }
        }
        
        /* Scrollbar personalizada */
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }
        
        .scrollbar-thin::-webkit-scrollbar { width: 6px; }
        .scrollbar-thin::-webkit-scrollbar-track { background: transparent; }
        .scrollbar-thin::-webkit-scrollbar-thumb {
            background-color: rgba(156, 163, 175, 0.5);
            border-radius: 3px;
        }
        .scrollbar-thin::-webkit-scrollbar-thumb:hover {
            background-color: rgba(156, 163, 175, 0.7);
        }
        
        /* Estados de carregamento */
        .loading { position: relative; }
        .loading::after {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(255, 255, 255, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: inherit;
            z-index: 10;
        }
        .dark .loading::after { background: rgba(0, 0, 0, 0.8); }
        
        /* Transições suaves */
        .transition-all-300 { transition: all 0.3s ease-in-out; }
        
        /* Efeitos hover personalizados */
        .hover-scale:hover { transform: scale(1.02); }
        
        /* Grid responsivo melhorado */
        .grid-responsive {
            display: grid;
            gap: 1rem;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        }
        
        /* Cards com sombra suave */
        .card-shadow {
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
        }
        .dark .card-shadow {
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.3), 0 1px 2px 0 rgba(0, 0, 0, 0.2);
        }
        
        /* Sidebar mobile melhorado */
        @media (max-width: 768px) {
            #app-container { position: relative; overflow-x: hidden; }
            #app-container aside {
                position: fixed;
                left: -100%;
                transition: left 0.3s cubic-bezier(0.4, 0, 0.2, 1);
                height: 100vh;
                z-index: 50;
                box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
            }
            #app-container.sidebar-open aside { left: 0; }
            #app-container.sidebar-open::before {
                content: '';
                position: fixed;
                top: 0; left: 0; right: 0; bottom: 0;
                background: rgba(0, 0, 0, 0.5);
                z-index: 40;
            }
        }
        
        /* Estados de formulário */
        .form-error {
            border-color: #ef4444 !important;
            box-shadow: 0 0 0 1px #ef4444 !important;
        }
        .form-success {
            border-color: #10b981 !important;
            box-shadow: 0 0 0 1px #10b981 !important;
        }
        
        /* Indicadores de progresso */
        .progress-bar { 
            transition: width 0.5s ease-in-out; 
            position: relative;
        }
        
        .progress-bar-animated::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            bottom: 0;
            right: 0;
            background-image: linear-gradient(45deg, rgba(255,255,255,.2) 25%, transparent 25%, transparent 50%, rgba(255,255,255,.2) 50%, rgba(255,255,255,.2) 75%, transparent 75%, transparent);
            background-size: 30px 30px;
            animation: progress-bar-stripes 1s linear infinite;
        }
        
        @keyframes progress-bar-stripes {
            0% { background-position: 30px 0; }
            100% { background-position: 0 0; }
        }
        
        /* Botões com estado loading */
        .btn-loading { position: relative; pointer-events: none; }
        .btn-loading::after {
            content: '';
            position: absolute;
            width: 16px; height: 16px;
            margin: auto;
            border: 2px solid transparent;
            border-top-color: currentColor;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Tooltip personalizado */
        .tooltip {
            position: relative;
            display: inline-block;
        }
        
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 200px;
            background-color: #374151;
            color: white;
            text-align: center;
            border-radius: 6px;
            padding: 8px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 12px;
        }
        
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }
        
        /* Alerta pulsante */
        .alert-pulse {
            animation: pulse 2s infinite;
        }
        
        /* Status indicators */
        .status-indicator {
            position: relative;
        }
        
        .status-indicator::before {
            content: '';
            position: absolute;
            top: -2px;
            right: -2px;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: #ef4444;
        }
        
        .status-indicator.status-success::before {
            background-color: #10b981;
        }
        
        .status-indicator.status-warning::before {
            background-color: #f59e0b;
        }
        
        /* Tabelas responsivas aprimoradas */
        .table-container {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }
        
        @media (max-width: 640px) {
            .table-container table {
                font-size: 0.75rem;
            }
            
            .table-container th,
            .table-container td {
                padding: 0.5rem 0.25rem;
            }
        }

        /* Gradientes personalizados para dashboard */
        .gradient-bg-success {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }
        
        .gradient-bg-warning {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        }
        
        .gradient-bg-danger {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
        }
        
        /* Efeitos de brilho */
        .glow-effect {
            box-shadow: 0 0 20px rgba(93, 92, 222, 0.3);
        }
        
        /* Animação de contador */
        .counter-animation {
            animation: countUp 1.5s ease-out forwards;
        }
        
        @keyframes countUp {
            from { transform: scale(0.5); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
    </style>
</head>
<body class="bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 min-h-screen">
    <!-- Container principal da aplicação -->
    <div id="app-container" class="flex h-screen overflow-hidden">
        <!-- Menu lateral (Sidebar) -->
        <aside class="w-64 hidden md:block bg-white dark:bg-gray-800 card-shadow z-10 flex-shrink-0">
            <div class="h-full flex flex-col">
                <!-- Logo e título -->
                <div class="p-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-center">
                    <div class="text-center">
                        <h1 class="text-xl font-bold text-primary-600 dark:text-primary-400">GGOMES-LOG</h1>
                        <p class="text-xs text-gray-500 dark:text-gray-400">Gestão Agrícola</p>
                    </div>
                </div>
                
                <!-- Informações do usuário -->
                <div class="p-4 border-b border-gray-200 dark:border-gray-700">
                    <div class="flex items-center">
                        <div class="h-10 w-10 rounded-full bg-primary-100 dark:bg-primary-900 flex items-center justify-center">
                            <i class="fas fa-user text-primary-600 dark:text-primary-400"></i>
                        </div>
                        <div class="ml-3">
                            <p id="sidebar-user-name" class="font-medium text-gray-800 dark:text-white">Administrador</p>
                            <p id="sidebar-user-role" class="text-xs text-gray-500 dark:text-gray-400">Administrador</p>
                        </div>
                    </div>
                </div>
                
                <!-- Links de navegação -->
                <div class="py-4 flex-1 overflow-y-auto scrollbar-thin">
                    <nav class="px-2 space-y-1">
                        <div class="px-3 py-2 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                            Dashboard
                        </div>
                        
                        <a href="#dashboard" class="sidebar-link active bg-primary-100 dark:bg-primary-900 text-primary-700 dark:text-primary-300 flex items-center px-4 py-2 rounded-md font-medium mb-1 transition-all-300">
                            <i class="fas fa-chart-pie mr-3 text-lg"></i>
                            <span>Dashboard</span>
                        </a>
                        
                        <div class="px-3 py-2 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                            Produção
                        </div>
                        
                        <a href="#liberacoes" class="sidebar-link flex items-center px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md font-medium mb-1 transition-all-300">
                            <i class="fas fa-tasks mr-3 text-lg"></i>
                            <span>Liberações</span>
                        </a>

                        <a href="#metas" class="sidebar-link flex items-center px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md font-medium mb-1 transition-all-300">
                            <i class="fas fa-bullseye mr-3 text-lg"></i>
                            <span>Metas de Colheita</span>
                        </a>
                        
                        <div class="px-3 py-2 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                            Logística
                        </div>
                        
                        <a href="#caminhoes" class="sidebar-link flex items-center px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md font-medium mb-1 transition-all-300">
                            <i class="fas fa-truck mr-3 text-lg"></i>
                            <span>Metas de Caminhões</span>
                        </a>
                        
                        <div class="px-3 py-2 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                            Sistema
                        </div>
                        
                        <a href="#configuracoes" class="sidebar-link flex items-center px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md font-medium mb-1 transition-all-300">
                            <i class="fas fa-cog mr-3 text-lg"></i>
                            <span>Configurações</span>
                        </a>
                    </nav>
                </div>
                
                <!-- Rodapé do sidebar -->
                <div class="p-4 border-t border-gray-200 dark:border-gray-700 text-center">
                    <p class="text-xs text-gray-500 dark:text-gray-400">GGOMES-LOG &copy; 2025</p>
                    <p class="text-xs text-gray-500 dark:text-gray-400">Versão 2.1 Avançada</p>
                </div>
            </div>
        </aside>
        
        <!-- Conteúdo principal -->
        <div class="flex-1 flex flex-col overflow-hidden">
            <!-- Barra superior (Header) -->
            <header class="bg-white dark:bg-gray-800 card-shadow z-10">
                <div class="flex items-center justify-between px-4 py-3 border-b border-gray-200 dark:border-gray-700">
                    <!-- Toggle do menu lateral (mobile) -->
                    <button id="mobile-menu-toggle" class="md:hidden p-2 rounded-md text-gray-500 hover:text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:text-gray-300 dark:hover:bg-gray-700 transition-all-300">
                        <i class="fas fa-bars"></i>
                    </button>
                    
                    <!-- Título da página -->
                    <div class="flex-1 text-center md:text-left">
                        <h2 id="page-title" class="text-lg font-semibold text-gray-800 dark:text-white">Dashboard</h2>
                        <p id="page-subtitle" class="text-sm text-gray-500 dark:text-gray-400 hidden md:block">Visão geral do sistema e indicadores principais</p>
                    </div>
                    
                    <!-- Ações e perfil do usuário -->
                    <div class="flex items-center space-x-3">
                        <!-- Busca rápida -->
                        <div class="hidden lg:block relative">
                            <input type="text" id="search-global" placeholder="Buscar..." class="pl-8 pr-3 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded-md bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-all-300">
                            <i class="fas fa-search absolute left-2.5 top-2 text-gray-400 text-xs"></i>
                        </div>
                        
                        <!-- Notificações -->
                        <button id="btn-notifications" class="relative p-2 rounded-md text-gray-500 hover:text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:text-gray-300 dark:hover:bg-gray-700 transition-all-300">
                            <i class="fas fa-bell"></i>
                            <span id="notification-badge" class="absolute -top-1 -right-1 h-4 w-4 bg-red-500 text-white rounded-full text-xs flex items-center justify-center hidden">0</span>
                        </button>
                        
                        <!-- Data atual -->
                        <div class="hidden sm:block mr-2">
                            <span id="current-date" class="text-sm text-gray-600 dark:text-gray-400">--/--/----</span>
                        </div>
                        
                        <!-- Toggle de tema claro/escuro -->
                        <button id="toggle-theme" class="p-2 rounded-md text-gray-500 hover:text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:text-gray-300 dark:hover:bg-gray-700 transition-all-300">
                            <i class="fas fa-moon dark:hidden"></i>
                            <i class="fas fa-sun hidden dark:inline-block"></i>
                        </button>
                        
                        <!-- Perfil do usuário -->
                        <div class="flex items-center">
                            <div class="mr-2 text-right hidden sm:block">
                                <div id="user-name" class="text-sm font-medium text-gray-800 dark:text-white">Administrador</div>
                                <div class="flex items-center">
                                    <span id="user-role-badge" class="px-2 py-1 rounded text-xs font-medium bg-primary-100 dark:bg-primary-900 text-primary-700 dark:text-primary-300">Admin</span>
                                </div>
                            </div>
                            <div class="h-8 w-8 rounded-full bg-primary-100 dark:bg-primary-900 flex items-center justify-center">
                                <i class="fas fa-user text-primary-600 dark:text-primary-400"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </header>
            
            <!-- Conteúdo principal -->
            <main class="flex-1 overflow-x-hidden overflow-y-auto bg-gray-100 dark:bg-gray-900 p-4">
                <!-- Toast container para mensagens -->
                <div id="toast-container" class="fixed top-4 right-4 z-50 space-y-4"></div>
                
                <!-- Loading overlay global -->
                <div id="loading-overlay" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
                    <div class="bg-white dark:bg-gray-800 rounded-lg p-6 flex items-center space-x-3">
                        <div class="animate-spin rounded-full h-6 w-6 border-b-2 border-primary-600"></div>
                        <span class="text-gray-700 dark:text-gray-300">Carregando...</span>
                    </div>
                </div>
                
                <!-- Conteúdo de Dashboard MELHORADO -->
                <div id="content-dashboard" class="content">
                    <div class="mb-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <h2 class="text-3xl font-bold text-gray-800 dark:text-white mb-2">Dashboard Executivo</h2>
                                <p class="text-gray-600 dark:text-gray-400">Visão estratégica em tempo real - Indicadores chave de performance</p>
                            </div>
                            <div class="flex items-center space-x-3">
                                <div class="text-right">
                                    <div id="dash-status-geral" class="text-sm font-medium text-green-600 dark:text-green-400">Sistema Operacional</div>
                                    <div id="dash-ultima-atualizacao" class="text-xs text-gray-500 dark:text-gray-400">Atualizado agora</div>
                                </div>
                                <button id="btn-refresh-dashboard" class="p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-all-300">
                                    <i class="fas fa-sync-alt"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Alertas Críticos -->
                    <div id="dashboard-alertas" class="mb-6 hidden">
                        <div class="bg-gradient-to-r from-red-50 to-orange-50 dark:from-red-900/20 dark:to-orange-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4">
                            <div class="flex items-center mb-3">
                                <i class="fas fa-exclamation-triangle text-red-500 text-lg mr-2"></i>
                                <h3 class="text-lg font-semibold text-red-800 dark:text-red-300">Alertas Críticos</h3>
                            </div>
                            <div id="lista-alertas-criticos" class="space-y-2">
                                <!-- Preenchido dinamicamente -->
                            </div>
                        </div>
                    </div>
                    
                    <!-- KPIs Principais -->
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 xl:grid-cols-6 gap-4 mb-8">
                        <!-- Total Colhido -->
                        <div class="bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-900/30 dark:to-emerald-900/30 rounded-lg card-shadow p-6 hover-scale transition-all-300 border border-green-200 dark:border-green-800">
                            <div class="flex items-center justify-between mb-4">
                                <div class="p-3 rounded-full bg-green-100 dark:bg-green-900">
                                    <i class="fas fa-weight-hanging text-green-600 dark:text-green-400 text-xl"></i>
                                </div>
                                <div id="dash-colhido-trend" class="text-green-600 dark:text-green-400 text-sm">
                                    <i class="fas fa-arrow-up mr-1"></i>+5.2%
                                </div>
                            </div>
                            <div>
                                <p class="text-sm font-medium text-green-700 dark:text-green-300 mb-1">Total Colhido (30d)</p>
                                <p id="dash-total-colhido" class="text-2xl font-bold text-green-800 dark:text-green-200">0 T</p>
                                <p id="dash-colhido-meta" class="text-xs text-green-600 dark:text-green-400 mt-1">Meta: 0 T</p>
                            </div>
                        </div>
                        
                        <!-- Eficiência Geral -->
                        <div class="bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-900/30 dark:to-indigo-900/30 rounded-lg card-shadow p-6 hover-scale transition-all-300 border border-blue-200 dark:border-blue-800">
                            <div class="flex items-center justify-between mb-4">
                                <div class="p-3 rounded-full bg-blue-100 dark:bg-blue-900">
                                    <i class="fas fa-tachometer-alt text-blue-600 dark:text-blue-400 text-xl"></i>
                                </div>
                                <div id="dash-eficiencia-trend" class="text-blue-600 dark:text-blue-400 text-sm">
                                    <i class="fas fa-arrow-up mr-1"></i>+2.1%
                                </div>
                            </div>
                            <div>
                                <p class="text-sm font-medium text-blue-700 dark:text-blue-300 mb-1">Eficiência Geral</p>
                                <p id="dash-eficiencia-geral" class="text-2xl font-bold text-blue-800 dark:text-blue-200">92%</p>
                                <p class="text-xs text-blue-600 dark:text-blue-400 mt-1">Acima da meta de 85%</p>
                            </div>
                        </div>
                        
                        <!-- Frentes Operacionais -->
                        <div class="bg-gradient-to-br from-purple-50 to-violet-50 dark:from-purple-900/30 dark:to-violet-900/30 rounded-lg card-shadow p-6 hover-scale transition-all-300 border border-purple-200 dark:border-purple-800">
                            <div class="flex items-center justify-between mb-4">
                                <div class="p-3 rounded-full bg-purple-100 dark:bg-purple-900">
                                    <i class="fas fa-map-marker-alt text-purple-600 dark:text-purple-400 text-xl"></i>
                                </div>
                                <div class="flex items-center space-x-1">
                                    <div id="dash-frentes-status" class="w-2 h-2 bg-green-500 rounded-full"></div>
                                    <span class="text-xs text-purple-600 dark:text-purple-400">Online</span>
                                </div>
                            </div>
                            <div>
                                <p class="text-sm font-medium text-purple-700 dark:text-purple-300 mb-1">Frentes Ativas</p>
                                <p id="dash-frentes-ativas" class="text-2xl font-bold text-purple-800 dark:text-purple-200">0/0</p>
                                <p id="dash-frentes-info" class="text-xs text-purple-600 dark:text-purple-400 mt-1">Próprias + Terceiras</p>
                            </div>
                        </div>
                        
                        <!-- Metas Atingidas -->
                        <div class="bg-gradient-to-br from-orange-50 to-amber-50 dark:from-orange-900/30 dark:to-amber-900/30 rounded-lg card-shadow p-6 hover-scale transition-all-300 border border-orange-200 dark:border-orange-800">
                            <div class="flex items-center justify-between mb-4">
                                <div class="p-3 rounded-full bg-orange-100 dark:bg-orange-900">
                                    <i class="fas fa-bullseye text-orange-600 dark:text-orange-400 text-xl"></i>
                                </div>
                                <div id="dash-metas-progresso" class="text-orange-600 dark:text-orange-400 text-sm">
                                    87%
                                </div>
                            </div>
                            <div>
                                <p class="text-sm font-medium text-orange-700 dark:text-orange-300 mb-1">Metas Atingidas</p>
                                <p id="dash-metas-atingidas" class="text-2xl font-bold text-orange-800 dark:text-orange-200">0/0</p>
                                <p class="text-xs text-orange-600 dark:text-orange-400 mt-1">Este mês</p>
                            </div>
                        </div>
                        
                        <!-- Caminhões Ativos -->
                        <div class="bg-gradient-to-br from-teal-50 to-cyan-50 dark:from-teal-900/30 dark:to-cyan-900/30 rounded-lg card-shadow p-6 hover-scale transition-all-300 border border-teal-200 dark:border-teal-800">
                            <div class="flex items-center justify-between mb-4">
                                <div class="p-3 rounded-full bg-teal-100 dark:bg-teal-900">
                                    <i class="fas fa-truck text-teal-600 dark:text-teal-400 text-xl"></i>
                                </div>
                                <div id="dash-caminhoes-trend" class="text-teal-600 dark:text-teal-400 text-sm">
                                    Operacional
                                </div>
                            </div>
                            <div>
                                <p class="text-sm font-medium text-teal-700 dark:text-teal-300 mb-1">Caminhões Ativos</p>
                                <p id="dash-caminhoes-ativos" class="text-2xl font-bold text-teal-800 dark:text-teal-200">0/0</p>
                                <p id="dash-caminhoes-info" class="text-xs text-teal-600 dark:text-teal-400 mt-1">Próprios + Terceiros</p>
                            </div>
                        </div>
                        
                        <!-- Liberações Ativas -->
                        <div class="bg-gradient-to-br from-rose-50 to-pink-50 dark:from-rose-900/30 dark:to-pink-900/30 rounded-lg card-shadow p-6 hover-scale transition-all-300 border border-rose-200 dark:border-rose-800">
                            <div class="flex items-center justify-between mb-4">
                                <div class="p-3 rounded-full bg-rose-100 dark:bg-rose-900">
                                    <i class="fas fa-tasks text-rose-600 dark:text-rose-400 text-xl"></i>
                                </div>
                                <div id="dash-liberacoes-status" class="text-rose-600 dark:text-rose-400 text-sm">
                                    Ativo
                                </div>
                            </div>
                            <div>
                                <p class="text-sm font-medium text-rose-700 dark:text-rose-300 mb-1">Liberações</p>
                                <p id="dash-total-liberacoes" class="text-2xl font-bold text-rose-800 dark:text-rose-200">0</p>
                                <p id="dash-liberacoes-info" class="text-xs text-rose-600 dark:text-rose-400 mt-1">Abertas + Em Andamento</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Gráficos Principais -->
                    <div class="grid grid-cols-1 xl:grid-cols-3 gap-6 mb-8">
                        <!-- Evolução da Colheita -->
                        <div class="xl:col-span-2 bg-white dark:bg-gray-800 rounded-lg card-shadow p-6">
                            <div class="flex items-center justify-between mb-6">
                                <div>
                                    <h3 class="text-lg font-semibold text-gray-800 dark:text-white">Evolução da Colheita</h3>
                                    <p class="text-sm text-gray-500 dark:text-gray-400">Últimos 30 dias - Comparativo com metas</p>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <button id="btn-chart-period" class="text-xs px-3 py-1 bg-primary-100 dark:bg-primary-900 text-primary-700 dark:text-primary-300 rounded-full">30d</button>
                                    <button class="text-xs px-3 py-1 text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full">7d</button>
                                </div>
                            </div>
                            <div class="h-80">
                                <canvas id="chart-evolucao-colheita"></canvas>
                            </div>
                        </div>
                        
                        <!-- Performance das Frentes -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg card-shadow p-6">
                            <div class="flex items-center justify-between mb-6">
                                <div>
                                    <h3 class="text-lg font-semibold text-gray-800 dark:text-white">Performance das Frentes</h3>
                                    <p class="text-sm text-gray-500 dark:text-gray-400">% Meta atingida</p>
                                </div>
                                <i class="fas fa-chart-bar text-gray-400"></i>
                            </div>
                            <div class="h-80">
                                <canvas id="chart-performance-frentes"></canvas>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Gráficos Secundários -->
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
                        <!-- Status das Liberações -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg card-shadow p-6">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-semibold text-gray-800 dark:text-white">Status das Liberações</h3>
                                <div class="flex items-center space-x-2">
                                    <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                                    <span class="text-xs text-gray-500">Real-time</span>
                                </div>
                            </div>
                            <div class="h-48">
                                <canvas id="chart-liberacoes-status"></canvas>
                            </div>
                        </div>
                        
                        <!-- Performance de Caminhões -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg card-shadow p-6">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-semibold text-gray-800 dark:text-white">Performance Caminhões</h3>
                                <i class="fas fa-truck text-gray-400"></i>
                            </div>
                            <div class="h-48">
                                <canvas id="chart-caminhoes-performance"></canvas>
                            </div>
                        </div>
                        
                        <!-- Eficiência por Turno -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg card-shadow p-6">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-semibold text-gray-800 dark:text-white">Eficiência por Turno</h3>
                                <i class="fas fa-clock text-gray-400"></i>
                            </div>
                            <div class="h-48">
                                <canvas id="chart-eficiencia-turno"></canvas>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Tabelas de Detalhes -->
                    <div class="grid grid-cols-1 xl:grid-cols-2 gap-6 mb-6">
                        <!-- Top 5 Frentes Performance -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg card-shadow p-6">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-semibold text-gray-800 dark:text-white">🏆 Top Performance</h3>
                                <span class="text-xs px-2 py-1 bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300 rounded-full">Este mês</span>
                            </div>
                            <div class="space-y-3">
                                <div id="dash-top-frentes" class="space-y-3">
                                    <!-- Preenchido dinamicamente -->
                                </div>
                            </div>
                        </div>
                        
                        <!-- Atividade Recente -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg card-shadow p-6">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-semibold text-gray-800 dark:text-white">📈 Atividade Recente</h3>
                                <span class="text-xs text-gray-500 dark:text-gray-400">Últimas 24h</span>
                            </div>
                            <div class="space-y-3 max-h-64 overflow-y-auto scrollbar-thin">
                                <div id="dash-atividade-recente" class="space-y-3">
                                    <!-- Preenchido dinamicamente -->
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Resumo Executivo -->
                    <div class="bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-700 rounded-lg card-shadow p-6 border border-gray-200 dark:border-gray-600">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-lg font-semibold text-gray-800 dark:text-white">💼 Resumo Executivo</h3>
                            <div class="flex items-center space-x-2">
                                <div class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></div>
                                <span class="text-xs text-gray-500 dark:text-gray-400">Atualização automática</span>
                            </div>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                            <div>
                                <h4 class="font-medium text-gray-700 dark:text-gray-300 mb-2">📊 Performance Geral</h4>
                                <p id="dash-resumo-performance" class="text-sm text-gray-600 dark:text-gray-400">
                                    Sistema operando com eficiência de 92%, superando a meta estabelecida.
                                </p>
                            </div>
                            <div>
                                <h4 class="font-medium text-gray-700 dark:text-gray-300 mb-2">⚠️ Pontos de Atenção</h4>
                                <div id="dash-resumo-alertas" class="text-sm text-gray-600 dark:text-gray-400">
                                    Todas as frentes operando dentro dos parâmetros normais.
                                </div>
                            </div>
                            <div>
                                <h4 class="font-medium text-gray-700 dark:text-gray-300 mb-2">🎯 Próximas Ações</h4>
                                <div id="dash-resumo-acoes" class="text-sm text-gray-600 dark:text-gray-400">
                                    Manter ritmo atual para atingir metas mensais.
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Conteúdo de Liberações -->
                <div id="content-liberacoes" class="content hidden">
                    <div class="mb-6">
                        <h2 class="text-2xl font-bold text-gray-800 dark:text-white mb-2">Liberações</h2>
                        <p class="text-gray-600 dark:text-gray-400">Gerenciamento completo de liberações de produção</p>
                    </div>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        <!-- Formulário de liberação -->
                        <div class="lg:col-span-1">
                            <div class="bg-white dark:bg-gray-800 rounded-lg card-shadow p-6">
                                <div class="flex items-center justify-between mb-4">
                                    <h3 class="text-lg font-semibold text-gray-800 dark:text-white">Nova Liberação</h3>
                                    <button id="btn-clear-form-liberacao" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors">
                                        <i class="fas fa-times"></i>
                                    </button>
                                </div>
                                
                                <form id="form-liberacao" class="space-y-4">
                                    <div>
                                        <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="liberacao-frente">
                                            Frente <span class="text-red-500">*</span>
                                        </label>
                                        <input type="text" id="liberacao-frente" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-3 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white transition-all-300" placeholder="Ex: Frente 01" required>
                                        <div class="invalid-feedback text-red-500 text-sm mt-1 hidden"></div>
                                    </div>
                                    
                                    <div>
                                        <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="liberacao-fazenda">
                                            Fazenda <span class="text-red-500">*</span>
                                        </label>
                                        <input type="text" id="liberacao-fazenda" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-3 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white transition-all-300" placeholder="Ex: Fazenda São João" required>
                                        <div class="invalid-feedback text-red-500 text-sm mt-1 hidden"></div>
                                    </div>
                                    
                                    <div>
                                        <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="liberacao-numero">
                                            Número da Liberação
                                        </label>
                                        <input type="text" id="liberacao-numero" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-3 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white transition-all-300" placeholder="Ex: LIB-2025-001">
                                    </div>
                                    
                                    <div>
                                        <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="liberacao-status">
                                            Status <span class="text-red-500">*</span>
                                        </label>
                                        <select id="liberacao-status" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-3 dark:bg-gray-700 dark:border-gray-600 dark:text-white transition-all-300" required>
                                            <option value="aberto">Aberto</option>
                                            <option value="fechado">Fechado</option>
                                            <option value="em-andamento">Em Andamento</option>
                                            <option value="cancelado">Cancelado</option>
                                        </select>
                                    </div>
                                    
                                    <div class="grid grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="liberacao-previsto">
                                                Previsto (T) <span class="text-red-500">*</span>
                                            </label>
                                            <input type="number" step="0.01" id="liberacao-previsto" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-3 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white transition-all-300" placeholder="1000" required>
                                        </div>
                                        
                                        <div>
                                            <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="liberacao-realizado">
                                                Realizado (T) <span class="text-red-500">*</span>
                                            </label>
                                            <input type="number" step="0.01" id="liberacao-realizado" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-3 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white transition-all-300" placeholder="850" required>
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="liberacao-data">
                                            Data <span class="text-red-500">*</span>
                                        </label>
                                        <input type="date" id="liberacao-data" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-3 dark:bg-gray-700 dark:border-gray-600 dark:text-white transition-all-300" required>
                                    </div>
                                    
                                    <div>
                                        <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="liberacao-observacoes">
                                            Observações
                                        </label>
                                        <textarea id="liberacao-observacoes" rows="3" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-3 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white transition-all-300" placeholder="Observações adicionais"></textarea>
                                    </div>
                                    
                                    <div class="flex items-center space-x-3 pt-4">
                                        <button type="submit" id="btn-submit-liberacao" class="flex-1 inline-flex items-center justify-center px-4 py-3 bg-primary-600 hover:bg-primary-700 text-white font-medium rounded-lg text-sm transition-all-300 hover-scale">
                                            <i class="fas fa-save mr-2"></i> 
                                            <span id="btn-submit-text">Salvar Liberação</span>
                                        </button>
                                        <button type="button" id="btn-cancel-liberacao" class="px-4 py-3 bg-gray-200 hover:bg-gray-300 text-gray-700 dark:bg-gray-700 dark:hover:bg-gray-600 dark:text-white font-medium rounded-lg text-sm transition-all-300">
                                            <i class="fas fa-times"></i>
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                        
                        <!-- Resumo e tabela -->
                        <div class="lg:col-span-2">
                            <!-- Filtros e busca -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg card-shadow p-6 mb-6">
                                <div class="flex justify-between items-center mb-4">
                                    <h3 class="text-lg font-semibold text-gray-800 dark:text-white">Filtros e Busca</h3>
                                    <div class="flex space-x-2">
                                        <button id="btn-clear-filters" class="px-3 py-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 transition-colors">
                                            <i class="fas fa-times mr-1"></i> Limpar
                                        </button>
                                        <button id="btn-export-liberacoes" class="inline-flex items-center px-4 py-2 bg-green-600 hover:bg-green-700 text-white text-sm font-medium rounded-lg transition-all-300 hover-scale">
                                            <i class="fas fa-file-export mr-2"></i> Exportar
                                        </button>
                                    </div>
                                </div>
                                
                                <!-- Busca -->
                                <div class="mb-4">
                                    <div class="relative">
                                        <input type="text" id="search-liberacoes" placeholder="Buscar por frente, fazenda, número..." class="pl-10 pr-4 py-2 w-full border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-all-300">
                                        <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
                                    </div>
                                </div>
                                
                                <!-- Filtros -->
                                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                    <div>
                                        <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="filtro-liberacao-frente">
                                            Frente
                                        </label>
                                        <select id="filtro-liberacao-frente" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:text-white transition-all-300">
                                            <option value="">Todas</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="filtro-liberacao-fazenda">
                                            Fazenda
                                        </label>
                                        <select id="filtro-liberacao-fazenda" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:text-white transition-all-300">
                                            <option value="">Todas</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="filtro-liberacao-status">
                                            Status
                                        </label>
                                        <select id="filtro-liberacao-status" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:text-white transition-all-300">
                                            <option value="">Todos</option>
                                            <option value="aberto">Aberto</option>
                                            <option value="fechado">Fechado</option>
                                            <option value="em-andamento">Em Andamento</option>
                                            <option value="cancelado">Cancelado</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Resumo expandido -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg card-shadow p-6 mb-6">
                                <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-4">Resumo</h3>
                                <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4">
                                    <div class="bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/30 dark:to-blue-800/30 p-4 rounded-lg text-center">
                                        <div class="text-xs text-blue-600 dark:text-blue-400 font-medium mb-1">Total Previsto</div>
                                        <div id="resumo-total-previsto" class="text-xl font-bold text-blue-800 dark:text-blue-300">0 T</div>
                                    </div>
                                    <div class="bg-gradient-to-br from-green-50 to-green-100 dark:from-green-900/30 dark:to-green-800/30 p-4 rounded-lg text-center">
                                        <div class="text-xs text-green-600 dark:text-green-400 font-medium mb-1">Total Realizado</div>
                                        <div id="resumo-total-realizado" class="text-xl font-bold text-green-800 dark:text-green-300">0 T</div>
                                    </div>
                                    <div class="bg-gradient-to-br from-red-50 to-red-100 dark:from-red-900/30 dark:to-red-800/30 p-4 rounded-lg text-center">
                                        <div class="text-xs text-red-600 dark:text-red-400 font-medium mb-1">Total Restante</div>
                                        <div id="resumo-total-restante" class="text-xl font-bold text-red-800 dark:text-red-300">0 T</div>
                                    </div>
                                    <div class="bg-gradient-to-br from-green-50 to-green-100 dark:from-green-900/30 dark:to-green-800/30 p-4 rounded-lg text-center">
                                        <div class="text-xs text-green-600 dark:text-green-400 font-medium mb-1">Aberto</div>
                                        <div id="resumo-status-aberto" class="text-xl font-bold text-green-800 dark:text-green-300">0</div>
                                    </div>
                                    <div class="bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/30 dark:to-blue-800/30 p-4 rounded-lg text-center">
                                        <div class="text-xs text-blue-600 dark:text-blue-400 font-medium mb-1">Fechado</div>
                                        <div id="resumo-status-fechado" class="text-xl font-bold text-blue-800 dark:text-blue-300">0</div>
                                    </div>
                                    <div class="bg-gradient-to-br from-purple-50 to-purple-100 dark:from-purple-900/30 dark:to-purple-800/30 p-4 rounded-lg text-center">
                                        <div class="text-xs text-purple-600 dark:text-purple-400 font-medium mb-1">Total Geral</div>
                                        <div id="resumo-total-geral" class="text-xl font-bold text-purple-800 dark:text-purple-300">0</div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Tabela de liberações -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg card-shadow p-6">
                                <div class="flex justify-between items-center mb-4">
                                    <h3 class="text-lg font-semibold text-gray-800 dark:text-white">Liberações</h3>
                                    <div class="flex items-center space-x-2">
                                        <span id="results-count" class="text-sm text-gray-500 dark:text-gray-400">0 resultados</span>
                                        <button id="btn-refresh-liberacoes" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors">
                                            <i class="fas fa-sync-alt"></i>
                                        </button>
                                    </div>
                                </div>
                                
                                <div class="table-container">
                                    <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                        <thead class="bg-gray-50 dark:bg-gray-700">
                                            <tr>
                                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors" data-sort="frente">
                                                    Frente <i class="fas fa-sort ml-1"></i>
                                                </th>
                                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors" data-sort="fazenda">
                                                    Fazenda <i class="fas fa-sort ml-1"></i>
                                                </th>
                                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Nº Liberação</th>
                                                <th class="px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors" data-sort="status">
                                                    Status <i class="fas fa-sort ml-1"></i>
                                                </th>
                                                <th class="px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors" data-sort="previsto">
                                                    Previsto <i class="fas fa-sort ml-1"></i>
                                                </th>
                                                <th class="px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors" data-sort="realizado">
                                                    Realizado <i class="fas fa-sort ml-1"></i>
                                                </th>
                                                <th class="px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Restante</th>
                                                <th class="px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Progresso</th>
                                                <th class="px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Ações</th>
                                            </tr>
                                        </thead>
                                        <tbody id="tabela-liberacoes" class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                            <!-- Preenchido dinamicamente -->
                                        </tbody>
                                    </table>
                                </div>
                                
                                <!-- Paginação -->
                                <div id="pagination-liberacoes" class="flex items-center justify-between mt-4 pt-4 border-t border-gray-200 dark:border-gray-700">
                                    <!-- Preenchido dinamicamente -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Conteúdo de Metas de Colheita -->
                <div id="content-metas" class="content hidden">
                    <div class="mb-6">
                        <h2 class="text-2xl font-bold text-gray-800 dark:text-white mb-2">Metas de Colheita</h2>
                        <p class="text-gray-600 dark:text-gray-400">Gestão completa de frentes próprias/terceiras, metas e acompanhamento da colheita</p>
                    </div>
                    
                    <!-- Abas de Metas -->
                    <div class="mb-6">
                        <div class="border-b border-gray-200 dark:border-gray-700">
                            <nav class="-mb-px flex space-x-8">
                                <button class="tab-button active py-2 px-1 border-b-2 border-primary-500 font-medium text-sm text-primary-600 dark:text-primary-400 transition-all-300" data-tab="frentes">
                                    <i class="fas fa-map-marker-alt mr-2"></i>Frentes
                                </button>
                                <button class="tab-button py-2 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300 transition-all-300" data-tab="metas-proprias">
                                    <i class="fas fa-home mr-2"></i>Metas Próprias
                                </button>
                                <button class="tab-button py-2 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300 transition-all-300" data-tab="metas-terceiras">
                                    <i class="fas fa-handshake mr-2"></i>Metas Terceiras
                                </button>
                                <button class="tab-button py-2 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300 transition-all-300" data-tab="diario">
                                    <i class="fas fa-calendar-day mr-2"></i>Lançamento Diário
                                </button>
                                <button class="tab-button py-2 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300 transition-all-300" data-tab="acompanhamento">
                                    <i class="fas fa-chart-line mr-2"></i>Acompanhamento
                                </button>
                            </nav>
                        </div>
                    </div>

                    <!-- Aba Frentes -->
                    <div id="tab-frentes" class="tab-content">
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <!-- Formulário de Frentes -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg card-shadow p-6">
                                <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-4">Cadastrar Frente</h3>
                                
                                <form id="form-frente" class="space-y-4">
                                    <div>
                                        <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="frente-nome">
                                            Nome da Frente <span class="text-red-500">*</span>
                                        </label>
                                        <input type="text" id="frente-nome" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-3 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white transition-all-300" placeholder="Ex: Frente 01" required>
                                        <div class="invalid-feedback text-red-500 text-sm mt-1 hidden"></div>
                                    </div>
                                    
                                    <div>
                                        <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="frente-fazenda">
                                            Fazenda <span class="text-red-500">*</span>
                                        </label>
                                        <input type="text" id="frente-fazenda" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-3 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white transition-all-300" placeholder="Ex: Fazenda São João" required>
                                        <div class="invalid-feedback text-red-500 text-sm mt-1 hidden"></div>
                                    </div>
                                    
                                    <div>
                                        <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="frente-tipo">
                                            Tipo da Frente <span class="text-red-500">*</span>
                                        </label>
                                        <select id="frente-tipo" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-3 dark:bg-gray-700 dark:border-gray-600 dark:text-white transition-all-300" required>
                                            <option value="propria">Própria</option>
                                            <option value="terceira">Terceira</option>
                                            <option value="desconhecido">Desconhecido</option>
                                        </select>
                                    </div>
                                    
                                    <div>
                                        <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="frente-responsavel">
                                            Responsável
                                        </label>
                                        <input type="text" id="frente-responsavel" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-3 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white transition-all-300" placeholder="Ex: João Silva">
                                    </div>
                                    
                                    <div>
                                        <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="frente-status">
                                            Status <span class="text-red-500">*</span>
                                        </label>
                                        <select id="frente-status" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-3 dark:bg-gray-700 dark:border-gray-600 dark:text-white transition-all-300" required>
                                            <option value="ativa">Ativa</option>
                                            <option value="inativa">Inativa</option>
                                            <option value="manutencao">Manutenção</option>
                                        </select>
                                    </div>
                                    
                                    <div>
                                        <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="frente-observacoes">
                                            Observações
                                        </label>
                                        <textarea id="frente-observacoes" rows="3" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-3 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white transition-all-300" placeholder="Observações sobre a frente"></textarea>
                                    </div>
                                    
                                    <div class="flex items-center space-x-3 pt-4">
                                        <button type="submit" class="flex-1 inline-flex items-center justify-center px-4 py-3 bg-primary-600 hover:bg-primary-700 text-white font-medium rounded-lg text-sm transition-all-300 hover-scale">
                                            <i class="fas fa-save mr-2"></i> <span id="btn-submit-frente-text">Salvar Frente</span>
                                        </button>
                                        <button type="reset" class="px-4 py-3 bg-gray-200 hover:bg-gray-300 text-gray-700 dark:bg-gray-700 dark:hover:bg-gray-600 dark:text-white font-medium rounded-lg text-sm transition-all-300">
                                            <i class="fas fa-times"></i>
                                        </button>
                                    </div>
                                </form>
                            </div>

                            <!-- Lista de Frentes -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg card-shadow p-6">
                                <div class="flex justify-between items-center mb-4">
                                    <h3 class="text-lg font-semibold text-gray-800 dark:text-white">Frentes Cadastradas</h3>
                                    <button id="btn-refresh-frentes" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors">
                                        <i class="fas fa-sync-alt"></i>
                                    </button>
                                </div>
                                
                                <div class="table-container">
                                    <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                        <thead class="bg-gray-50 dark:bg-gray-700">
                                            <tr>
                                                <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Nome</th>
                                                <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Fazenda</th>
                                                <th class="px-3 py-2 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Tipo</th>
                                                <th class="px-3 py-2 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Status</th>
                                                <th class="px-3 py-2 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Ações</th>
                                            </tr>
                                        </thead>
                                        <tbody id="tabela-frentes" class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                            <!-- Preenchido dinamicamente -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Aba Metas Próprias -->
                    <div id="tab-metas-proprias" class="tab-content hidden">
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <!-- Formulário de Metas Próprias -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg card-shadow p-6">
                                <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-4">
                                    <i class="fas fa-home text-blue-600 dark:text-blue-400 mr-2"></i>
                                    Definir Meta Própria
                                </h3>
                                
                                <form id="form-meta-propria" class="space-y-4">
                                    <div>
                                        <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="meta-propria-frente">
                                            Frente Própria <span class="text-red-500">*</span>
                                        </label>
                                        <select id="meta-propria-frente" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-3 dark:bg-gray-700 dark:border-gray-600 dark:text-white transition-all-300" required>
                                            <option value="">Selecione uma frente própria</option>
                                        </select>
                                        <div class="invalid-feedback text-red-500 text-sm mt-1 hidden"></div>
                                    </div>
                                    
                                    <div>
                                        <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="meta-propria-periodo">
                                            Período <span class="text-red-500">*</span>
                                        </label>
                                        <select id="meta-propria-periodo" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-3 dark:bg-gray-700 dark:border-gray-600 dark:text-white transition-all-300" required>
                                            <option value="diario">Diário</option>
                                            <option value="semanal">Semanal</option>
                                            <option value="mensal">Mensal</option>
                                        </select>
                                    </div>
                                    
                                    <div>
                                        <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="meta-propria-valor">
                                            Meta (Toneladas) <span class="text-red-500">*</span>
                                        </label>
                                        <input type="number" step="0.01" id="meta-propria-valor" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-3 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white transition-all-300" placeholder="Ex: 150.00" required>
                                        <div class="invalid-feedback text-red-500 text-sm mt-1 hidden"></div>
                                    </div>
                                    
                                    <div class="grid grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="meta-propria-data-inicio">
                                                Data de Início <span class="text-red-500">*</span>
                                            </label>
                                            <input type="date" id="meta-propria-data-inicio" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-3 dark:bg-gray-700 dark:border-gray-600 dark:text-white transition-all-300" required>
                                        </div>
                                        
                                        <div>
                                            <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="meta-propria-data-fim">
                                                Data de Fim <span class="text-red-500">*</span>
                                            </label>
                                            <input type="date" id="meta-propria-data-fim" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-3 dark:bg-gray-700 dark:border-gray-600 dark:text-white transition-all-300" required>
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="meta-propria-observacoes">
                                            Observações
                                        </label>
                                        <textarea id="meta-propria-observacoes" rows="3" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-3 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white transition-all-300" placeholder="Observações sobre a meta própria"></textarea>
                                    </div>
                                    
                                    <div class="flex items-center space-x-3 pt-4">
                                        <button type="submit" class="flex-1 inline-flex items-center justify-center px-4 py-3 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg text-sm transition-all-300 hover-scale">
                                            <i class="fas fa-save mr-2"></i> <span id="btn-submit-meta-propria-text">Salvar Meta Própria</span>
                                        </button>
                                        <button type="reset" class="px-4 py-3 bg-gray-200 hover:bg-gray-300 text-gray-700 dark:bg-gray-700 dark:hover:bg-gray-600 dark:text-white font-medium rounded-lg text-sm transition-all-300">
                                            <i class="fas fa-times"></i>
                                        </button>
                                    </div>
                                </form>
                            </div>

                            <!-- Lista de Metas Próprias -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg card-shadow p-6">
                                <div class="flex justify-between items-center mb-4">
                                    <h3 class="text-lg font-semibold text-gray-800 dark:text-white">
                                        <i class="fas fa-home text-blue-600 dark:text-blue-400 mr-2"></i>
                                        Metas Próprias
                                    </h3>
                                    <button id="btn-refresh-metas-proprias" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors">
                                        <i class="fas fa-sync-alt"></i>
                                    </button>
                                </div>
                                
                                <div class="table-container">
                                    <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                        <thead class="bg-gray-50 dark:bg-gray-700">
                                            <tr>
                                                <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Frente</th>
                                                <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Período</th>
                                                <th class="px-3 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Meta (T)</th>
                                                <th class="px-3 py-2 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Status</th>
                                                <th class="px-3 py-2 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Ações</th>
                                            </tr>
                                        </thead>
                                        <tbody id="tabela-metas-proprias" class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                            <!-- Preenchido dinamicamente -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Aba Metas Terceiras -->
                    <div id="tab-metas-terceiras" class="tab-content hidden">
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <!-- Formulário de Metas Terceiras -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg card-shadow p-6">
                                <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-4">
                                    <i class="fas fa-handshake text-orange-600 dark:text-orange-400 mr-2"></i>
                                    Definir Meta Terceira
                                </h3>
                                
                                <form id="form-meta-terceira" class="space-y-4">
                                    <div>
                                        <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="meta-terceira-frente">
                                            Frente Terceira <span class="text-red-500">*</span>
                                        </label>
                                        <select id="meta-terceira-frente" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-3 dark:bg-gray-700 dark:border-gray-600 dark:text-white transition-all-300" required>
                                            <option value="">Selecione uma frente terceira</option>
                                        </select>
                                        <div class="invalid-feedback text-red-500 text-sm mt-1 hidden"></div>
                                    </div>
                                    
                                    <div>
                                        <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="meta-terceira-periodo">
                                            Período <span class="text-red-500">*</span>
                                        </label>
                                        <select id="meta-terceira-periodo" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-3 dark:bg-gray-700 dark:border-gray-600 dark:text-white transition-all-300" required>
                                            <option value="diario">Diário</option>
                                            <option value="semanal">Semanal</option>
                                            <option value="mensal">Mensal</option>
                                        </select>
                                    </div>
                                    
                                    <div>
                                        <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="meta-terceira-valor">
                                            Meta (Toneladas) <span class="text-red-500">*</span>
                                        </label>
                                        <input type="number" step="0.01" id="meta-terceira-valor" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-3 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white transition-all-300" placeholder="Ex: 120.00" required>
                                        <div class="invalid-feedback text-red-500 text-sm mt-1 hidden"></div>
                                    </div>
                                    
                                    <div class="grid grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="meta-terceira-data-inicio">
                                                Data de Início <span class="text-red-500">*</span>
                                            </label>
                                            <input type="date" id="meta-terceira-data-inicio" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-3 dark:bg-gray-700 dark:border-gray-600 dark:text-white transition-all-300" required>
                                        </div>
                                        
                                        <div>
                                            <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="meta-terceira-data-fim">
                                                Data de Fim <span class="text-red-500">*</span>
                                            </label>
                                            <input type="date" id="meta-terceira-data-fim" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-3 dark:bg-gray-700 dark:border-gray-600 dark:text-white transition-all-300" required>
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="meta-terceira-observacoes">
                                            Observações
                                        </label>
                                        <textarea id="meta-terceira-observacoes" rows="3" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-3 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white transition-all-300" placeholder="Observações sobre a meta terceira"></textarea>
                                    </div>
                                    
                                    <div class="flex items-center space-x-3 pt-4">
                                        <button type="submit" class="flex-1 inline-flex items-center justify-center px-4 py-3 bg-orange-600 hover:bg-orange-700 text-white font-medium rounded-lg text-sm transition-all-300 hover-scale">
                                            <i class="fas fa-save mr-2"></i> <span id="btn-submit-meta-terceira-text">Salvar Meta Terceira</span>
                                        </button>
                                        <button type="reset" class="px-4 py-3 bg-gray-200 hover:bg-gray-300 text-gray-700 dark:bg-gray-700 dark:hover:bg-gray-600 dark:text-white font-medium rounded-lg text-sm transition-all-300">
                                            <i class="fas fa-times"></i>
                                        </button>
                                    </div>
                                </form>
                            </div>

                            <!-- Lista de Metas Terceiras -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg card-shadow p-6">
                                <div class="flex justify-between items-center mb-4">
                                    <h3 class="text-lg font-semibold text-gray-800 dark:text-white">
                                        <i class="fas fa-handshake text-orange-600 dark:text-orange-400 mr-2"></i>
                                        Metas Terceiras
                                    </h3>
                                    <button id="btn-refresh-metas-terceiras" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors">
                                        <i class="fas fa-sync-alt"></i>
                                    </button>
                                </div>
                                
                                <div class="table-container">
                                    <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                        <thead class="bg-gray-50 dark:bg-gray-700">
                                            <tr>
                                                <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Frente</th>
                                                <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Período</th>
                                                <th class="px-3 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Meta (T)</th>
                                                <th class="px-3 py-2 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Status</th>
                                                <th class="px-3 py-2 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Ações</th>
                                            </tr>
                                        </thead>
                                        <tbody id="tabela-metas-terceiras" class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                            <!-- Preenchido dinamicamente -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Aba Lançamento Diário -->
                    <div id="tab-diario" class="tab-content hidden">
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <!-- Formulário de Lançamento Diário -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg card-shadow p-6">
                                <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-4">Lançamento Diário</h3>
                                
                                <form id="form-lancamento" class="space-y-4">
                                    <div>
                                        <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="lancamento-frente">
                                            Frente <span class="text-red-500">*</span>
                                        </label>
                                        <select id="lancamento-frente" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-3 dark:bg-gray-700 dark:border-gray-600 dark:text-white transition-all-300" required>
                                            <option value="">Selecione uma frente</option>
                                        </select>
                                        <div class="invalid-feedback text-red-500 text-sm mt-1 hidden"></div>
                                    </div>
                                    
                                    <div>
                                        <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="lancamento-data">
                                            Data <span class="text-red-500">*</span>
                                        </label>
                                        <input type="date" id="lancamento-data" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-3 dark:bg-gray-700 dark:border-gray-600 dark:text-white transition-all-300" required>
                                    </div>
                                    
                                    <div>
                                        <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="lancamento-colhido">
                                            Quantidade Colhida (T) <span class="text-red-500">*</span>
                                        </label>
                                        <input type="number" step="0.01" id="lancamento-colhido" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-3 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white transition-all-300" placeholder="Ex: 120.50" required>
                                        <div class="invalid-feedback text-red-500 text-sm mt-1 hidden"></div>
                                    </div>
                                    
                                    <div>
                                        <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="lancamento-turno">
                                            Turno <span class="text-red-500">*</span>
                                        </label>
                                        <select id="lancamento-turno" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-3 dark:bg-gray-700 dark:border-gray-600 dark:text-white transition-all-300" required>
                                            <option value="manha">Manhã</option>
                                            <option value="tarde">Tarde</option>
                                            <option value="noite">Noite</option>
                                        </select>
                                    </div>
                                    
                                    <div>
                                        <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="lancamento-operador">
                                            Operador
                                        </label>
                                        <input type="text" id="lancamento-operador" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-3 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white transition-all-300" placeholder="Ex: José Santos">
                                    </div>
                                    
                                    <div>
                                        <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="lancamento-observacoes">
                                            Observações
                                        </label>
                                        <textarea id="lancamento-observacoes" rows="3" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-3 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white transition-all-300" placeholder="Observações do dia"></textarea>
                                    </div>
                                    
                                    <div class="flex items-center space-x-3 pt-4">
                                        <button type="submit" class="flex-1 inline-flex items-center justify-center px-4 py-3 bg-primary-600 hover:bg-primary-700 text-white font-medium rounded-lg text-sm transition-all-300 hover-scale">
                                            <i class="fas fa-save mr-2"></i> <span id="btn-submit-lancamento-text">Salvar Lançamento</span>
                                        </button>
                                        <button type="reset" class="px-4 py-3 bg-gray-200 hover:bg-gray-300 text-gray-700 dark:bg-gray-700 dark:hover:bg-gray-600 dark:text-white font-medium rounded-lg text-sm transition-all-300">
                                            <i class="fas fa-times"></i>
                                        </button>
                                    </div>
                                </form>
                            </div>

                            <!-- Lançamentos Recentes -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg card-shadow p-6">
                                <div class="flex justify-between items-center mb-4">
                                    <h3 class="text-lg font-semibold text-gray-800 dark:text-white">Lançamentos Recentes</h3>
                                    <button id="btn-refresh-lancamentos" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors">
                                        <i class="fas fa-sync-alt"></i>
                                    </button>
                                </div>
                                
                                <div class="table-container">
                                    <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                        <thead class="bg-gray-50 dark:bg-gray-700">
                                            <tr>
                                                <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Data</th>
                                                <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Frente</th>
                                                <th class="px-3 py-2 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Tipo</th>
                                                <th class="px-3 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Colhido (T)</th>
                                                <th class="px-3 py-2 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Turno</th>
                                                <th class="px-3 py-2 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Ações</th>
                                            </tr>
                                        </thead>
                                        <tbody id="tabela-lancamentos" class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                            <!-- Preenchido dinamicamente -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Aba Acompanhamento MELHORADA -->
                    <div id="tab-acompanhamento" class="tab-content hidden">
                        <!-- Filtros de Acompanhamento Avançados -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg card-shadow p-6 mb-6">
                            <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-4">
                                <i class="fas fa-filter mr-2"></i>Filtros Avançados de Acompanhamento
                            </h3>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 mb-4">
                                <div>
                                    <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="filtro-acompanhamento-frente">
                                        Frente
                                    </label>
                                    <select id="filtro-acompanhamento-frente" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:text-white transition-all-300">
                                        <option value="">Todas as frentes</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="filtro-acompanhamento-tipo">
                                        Tipo
                                    </label>
                                    <select id="filtro-acompanhamento-tipo" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:text-white transition-all-300">
                                        <option value="">Todos os tipos</option>
                                        <option value="propria">Próprias</option>
                                        <option value="terceira">Terceiras</option>
                                        <option value="desconhecido">Desconhecidas</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="filtro-acompanhamento-data-inicio">
                                        Data Início
                                    </label>
                                    <input type="date" id="filtro-acompanhamento-data-inicio" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:text-white transition-all-300">
                                </div>
                                <div>
                                    <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="filtro-acompanhamento-data-fim">
                                        Data Fim
                                    </label>
                                    <input type="date" id="filtro-acompanhamento-data-fim" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:text-white transition-all-300">
                                </div>
                                <div class="flex items-end">
                                    <label class="flex items-center">
                                        <input type="checkbox" id="filtro-incluir-inativos" class="rounded border-gray-300 text-primary-600 shadow-sm focus:border-primary-300 focus:ring focus:ring-primary-200 focus:ring-opacity-50">
                                        <span class="ml-2 text-sm text-gray-700 dark:text-gray-300">Incluir Inativas</span>
                                    </label>
                                </div>
                            </div>
                            
                            <div class="flex flex-wrap gap-3">
                                <button id="btn-aplicar-filtro-acompanhamento" class="inline-flex items-center px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white font-medium rounded-lg text-sm transition-all-300 hover-scale">
                                    <i class="fas fa-filter mr-2"></i> Aplicar Filtros
                                </button>
                                <button id="btn-limpar-filtro-acompanhamento" class="inline-flex items-center px-4 py-2 bg-gray-500 hover:bg-gray-600 text-white font-medium rounded-lg text-sm transition-all-300">
                                    <i class="fas fa-times mr-2"></i> Limpar
                                </button>
                                <button id="btn-auto-refresh-acompanhamento" class="inline-flex items-center px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg text-sm transition-all-300">
                                    <i class="fas fa-sync-alt mr-2"></i> Auto-Refresh
                                </button>
                                <button id="btn-exportar-acompanhamento" class="inline-flex items-center px-4 py-2 bg-green-600 hover:bg-green-700 text-white font-medium rounded-lg text-sm transition-all-300 hover-scale">
                                    <i class="fas fa-file-export mr-2"></i> Exportar Relatório
                                </button>
                            </div>
                        </div>

                        <!-- Resumo Avançado do Acompanhamento -->
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-4 mb-6">
                            <div class="bg-white dark:bg-gray-800 rounded-lg card-shadow p-6 text-center hover-scale transition-all-300">
                                <div class="flex items-center justify-center mb-2">
                                    <i class="fas fa-home text-blue-600 dark:text-blue-400 text-2xl mr-2"></i>
                                    <div>
                                        <div class="text-2xl font-bold text-blue-600 dark:text-blue-400" id="resumo-metas-proprias-ativas">0</div>
                                        <div class="text-sm text-gray-500 dark:text-gray-400">Metas Próprias</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-white dark:bg-gray-800 rounded-lg card-shadow p-6 text-center hover-scale transition-all-300">
                                <div class="flex items-center justify-center mb-2">
                                    <i class="fas fa-handshake text-orange-600 dark:text-orange-400 text-2xl mr-2"></i>
                                    <div>
                                        <div class="text-2xl font-bold text-orange-600 dark:text-orange-400" id="resumo-metas-terceiras-ativas">0</div>
                                        <div class="text-sm text-gray-500 dark:text-gray-400">Metas Terceiras</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-white dark:bg-gray-800 rounded-lg card-shadow p-6 text-center hover-scale transition-all-300">
                                <div class="flex items-center justify-center mb-2">
                                    <i class="fas fa-weight-hanging text-green-600 dark:text-green-400 text-2xl mr-2"></i>
                                    <div>
                                        <div class="text-2xl font-bold text-green-600 dark:text-green-400" id="resumo-total-colhido">0 T</div>
                                        <div class="text-sm text-gray-500 dark:text-gray-400">Total Colhido</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-white dark:bg-gray-800 rounded-lg card-shadow p-6 text-center hover-scale transition-all-300">
                                <div class="flex items-center justify-center mb-2">
                                    <i class="fas fa-bullseye text-purple-600 dark:text-purple-400 text-2xl mr-2"></i>
                                    <div>
                                        <div class="text-2xl font-bold text-purple-600 dark:text-purple-400" id="resumo-total-meta">0 T</div>
                                        <div class="text-sm text-gray-500 dark:text-gray-400">Meta Total</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-white dark:bg-gray-800 rounded-lg card-shadow p-6 text-center hover-scale transition-all-300">
                                <div class="flex items-center justify-center mb-2">
                                    <i class="fas fa-percentage text-indigo-600 dark:text-indigo-400 text-2xl mr-2"></i>
                                    <div>
                                        <div class="text-2xl font-bold text-indigo-600 dark:text-indigo-400" id="resumo-percentual-meta">0%</div>
                                        <div class="text-sm text-gray-500 dark:text-gray-400">% da Meta</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-white dark:bg-gray-800 rounded-lg card-shadow p-6 text-center hover-scale transition-all-300">
                                <div class="flex items-center justify-center mb-2">
                                    <i class="fas fa-chart-line text-teal-600 dark:text-teal-400 text-2xl mr-2"></i>
                                    <div>
                                        <div class="text-sm font-bold text-teal-600 dark:text-teal-400" id="resumo-tendencia-info">Estável</div>
                                        <div class="text-sm text-gray-500 dark:text-gray-400">Tendência</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Tabela de Acompanhamento Avançada -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg card-shadow p-6">
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="text-lg font-semibold text-gray-800 dark:text-white">
                                    <i class="fas fa-chart-line mr-2"></i>Acompanhamento Detalhado por Frente
                                </h3>
                                <div class="flex items-center space-x-2">
                                    <span class="text-sm text-gray-500 dark:text-gray-400">Última atualização: <span id="ultima-atualizacao">--:--</span></span>
                                    <button id="btn-refresh-acompanhamento" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors">
                                        <i class="fas fa-sync-alt"></i>
                                    </button>
                                </div>
                            </div>
                            
                            <div class="table-container">
                                <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                    <thead class="bg-gray-50 dark:bg-gray-700">
                                        <tr>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors" data-sort-acompanhamento="nome">
                                                Frente <i class="fas fa-sort ml-1"></i>
                                            </th>
                                            <th class="px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Tipo</th>
                                            <th class="px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors" data-sort-acompanhamento="metaTotal">
                                                Meta (T) <i class="fas fa-sort ml-1"></i>
                                            </th>
                                            <th class="px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors" data-sort-acompanhamento="colhidoTotal">
                                                Colhido (T) <i class="fas fa-sort ml-1"></i>
                                            </th>
                                            <th class="px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors" data-sort-acompanhamento="restante">
                                                Restante (T) <i class="fas fa-sort ml-1"></i>
                                            </th>
                                            <th class="px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors" data-sort-acompanhamento="percentualMeta">
                                                % Meta <i class="fas fa-sort ml-1"></i>
                                            </th>
                                            <th class="px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Status</th>
                                            <th class="px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Tendência</th>
                                            <th class="px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Progresso</th>
                                            <th class="px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Ações</th>
                                        </tr>
                                    </thead>
                                    <tbody id="tabela-acompanhamento" class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                        <!-- Preenchido dinamicamente -->
                                    </tbody>
                                </table>
                            </div>
                            
                            <!-- Legenda de Status -->
                            <div class="mt-4 pt-4 border-t border-gray-200 dark:border-gray-700">
                                <h4 class="text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Legenda de Status:</h4>
                                <div class="flex flex-wrap gap-4 text-xs">
                                    <span class="flex items-center">
                                        <div class="w-3 h-3 bg-green-500 rounded-full mr-2"></div>
                                        Meta Atingida (≥100%)
                                    </span>
                                    <span class="flex items-center">
                                        <div class="w-3 h-3 bg-blue-500 rounded-full mr-2"></div>
                                        Próximo à Meta (≥90%)
                                    </span>
                                    <span class="flex items-center">
                                        <div class="w-3 h-3 bg-yellow-500 rounded-full mr-2"></div>
                                        Em Progresso (≥70%)
                                    </span>
                                    <span class="flex items-center">
                                        <div class="w-3 h-3 bg-orange-500 rounded-full mr-2"></div>
                                        Atenção (≥50%)
                                    </span>
                                    <span class="flex items-center">
                                        <div class="w-3 h-3 bg-red-500 rounded-full mr-2"></div>
                                        Crítico (&lt;50%)
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Nova seção: Metas de Caminhões -->
                <div id="content-caminhoes" class="content hidden">
                    <div class="mb-6">
                        <h2 class="text-2xl font-bold text-gray-800 dark:text-white mb-2">Metas de Caminhões</h2>
                        <p class="text-gray-600 dark:text-gray-400">Gestão completa de caminhões próprios/terceiros e suas metas de transporte</p>
                    </div>
                    
                    <!-- Abas de Caminhões -->
                    <div class="mb-6">
                        <div class="border-b border-gray-200 dark:border-gray-700">
                            <nav class="-mb-px flex space-x-8">
                                <button class="tab-caminhao-button active py-2 px-1 border-b-2 border-primary-500 font-medium text-sm text-primary-600 dark:text-primary-400 transition-all-300" data-tab="cadastro-caminhoes">
                                    <i class="fas fa-truck mr-2"></i>Cadastro de Caminhões
                                </button>
                                <button class="tab-caminhao-button py-2 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300 transition-all-300" data-tab="metas-caminhoes-proprios">
                                    <i class="fas fa-home mr-2"></i>Metas Próprios
                                </button>
                                <button class="tab-caminhao-button py-2 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300 transition-all-300" data-tab="metas-caminhoes-terceiros">
                                    <i class="fas fa-handshake mr-2"></i>Metas Terceiros
                                </button>
                                <button class="tab-caminhao-button py-2 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300 transition-all-300" data-tab="acompanhamento-caminhoes">
                                    <i class="fas fa-chart-bar mr-2"></i>Acompanhamento
                                </button>
                            </nav>
                        </div>
                    </div>

                    <!-- Aba Cadastro de Caminhões -->
                    <div id="tab-cadastro-caminhoes" class="tab-caminhao-content">
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <!-- Formulário de Cadastro de Caminhões -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg card-shadow p-6">
                                <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-4">Cadastrar Caminhão</h3>
                                
                                <form id="form-caminhao" class="space-y-4">
                                    <div>
                                        <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="caminhao-placa">
                                            Placa <span class="text-red-500">*</span>
                                        </label>
                                        <input type="text" id="caminhao-placa" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-3 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white transition-all-300" placeholder="Ex: ABC-1234" required>
                                        <div class="invalid-feedback text-red-500 text-sm mt-1 hidden"></div>
                                    </div>
                                    
                                    <div>
                                        <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="caminhao-modelo">
                                            Modelo <span class="text-red-500">*</span>
                                        </label>
                                        <input type="text" id="caminhao-modelo" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-3 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white transition-all-300" placeholder="Ex: Scania R450" required>
                                        <div class="invalid-feedback text-red-500 text-sm mt-1 hidden"></div>
                                    </div>
                                    
                                    <div>
                                        <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="caminhao-tipo">
                                            Tipo <span class="text-red-500">*</span>
                                        </label>
                                        <select id="caminhao-tipo" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-3 dark:bg-gray-700 dark:border-gray-600 dark:text-white transition-all-300" required>
                                            <option value="proprio">Próprio</option>
                                            <option value="terceiro">Terceiro</option>
                                        </select>
                                    </div>
                                    
                                    <div>
                                        <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="caminhao-capacidade">
                                            Capacidade (T) <span class="text-red-500">*</span>
                                        </label>
                                        <input type="number" step="0.1" id="caminhao-capacidade" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-3 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white transition-all-300" placeholder="Ex: 30.0" required>
                                        <div class="invalid-feedback text-red-500 text-sm mt-1 hidden"></div>
                                    </div>
                                    
                                    <div>
                                        <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="caminhao-motorista">
                                            Motorista
                                        </label>
                                        <input type="text" id="caminhao-motorista" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-3 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white transition-all-300" placeholder="Ex: João Silva">
                                    </div>
                                    
                                    <div>
                                        <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="caminhao-status">
                                            Status <span class="text-red-500">*</span>
                                        </label>
                                        <select id="caminhao-status" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-3 dark:bg-gray-700 dark:border-gray-600 dark:text-white transition-all-300" required>
                                            <option value="ativo">Ativo</option>
                                            <option value="inativo">Inativo</option>
                                            <option value="manutencao">Manutenção</option>
                                        </select>
                                    </div>
                                    
                                    <div>
                                        <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="caminhao-observacoes">
                                            Observações
                                        </label>
                                        <textarea id="caminhao-observacoes" rows="3" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-3 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white transition-all-300" placeholder="Observações sobre o caminhão"></textarea>
                                    </div>
                                    
                                    <div class="flex items-center space-x-3 pt-4">
                                        <button type="submit" class="flex-1 inline-flex items-center justify-center px-4 py-3 bg-primary-600 hover:bg-primary-700 text-white font-medium rounded-lg text-sm transition-all-300 hover-scale">
                                            <i class="fas fa-save mr-2"></i> <span id="btn-submit-caminhao-text">Salvar Caminhão</span>
                                        </button>
                                        <button type="reset" class="px-4 py-3 bg-gray-200 hover:bg-gray-300 text-gray-700 dark:bg-gray-700 dark:hover:bg-gray-600 dark:text-white font-medium rounded-lg text-sm transition-all-300">
                                            <i class="fas fa-times"></i>
                                        </button>
                                    </div>
                                </form>
                            </div>

                            <!-- Lista de Caminhões -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg card-shadow p-6">
                                <div class="flex justify-between items-center mb-4">
                                    <h3 class="text-lg font-semibold text-gray-800 dark:text-white">Caminhões Cadastrados</h3>
                                    <button id="btn-refresh-caminhoes" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors">
                                        <i class="fas fa-sync-alt"></i>
                                    </button>
                                </div>
                                
                                <div class="table-container">
                                    <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                        <thead class="bg-gray-50 dark:bg-gray-700">
                                            <tr>
                                                <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Placa</th>
                                                <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Modelo</th>
                                                <th class="px-3 py-2 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Tipo</th>
                                                <th class="px-3 py-2 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Capacidade</th>
                                                <th class="px-3 py-2 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Status</th>
                                                <th class="px-3 py-2 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Ações</th>
                                            </tr>
                                        </thead>
                                        <tbody id="tabela-caminhoes" class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                            <!-- Preenchido dinamicamente -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Aba Metas Caminhões Próprios -->
                    <div id="tab-metas-caminhoes-proprios" class="tab-caminhao-content hidden">
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <!-- Formulário de Metas Caminhões Próprios -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg card-shadow p-6">
                                <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-4">
                                    <i class="fas fa-home text-blue-600 dark:text-blue-400 mr-2"></i>
                                    Definir Meta Caminhão Próprio
                                </h3>
                                
                                <form id="form-meta-caminhao-proprio" class="space-y-4">
                                    <div>
                                        <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="meta-caminhao-proprio-caminhao">
                                            Caminhão Próprio <span class="text-red-500">*</span>
                                        </label>
                                        <select id="meta-caminhao-proprio-caminhao" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-3 dark:bg-gray-700 dark:border-gray-600 dark:text-white transition-all-300" required>
                                            <option value="">Selecione um caminhão próprio</option>
                                        </select>
                                        <div class="invalid-feedback text-red-500 text-sm mt-1 hidden"></div>
                                    </div>
                                    
                                    <div>
                                        <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="meta-caminhao-proprio-periodo">
                                            Período <span class="text-red-500">*</span>
                                        </label>
                                        <select id="meta-caminhao-proprio-periodo" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-3 dark:bg-gray-700 dark:border-gray-600 dark:text-white transition-all-300" required>
                                            <option value="diario">Diário</option>
                                            <option value="semanal">Semanal</option>
                                            <option value="mensal">Mensal</option>
                                        </select>
                                    </div>
                                    
                                    <div>
                                        <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="meta-caminhao-proprio-viagens">
                                            Meta de Viagens <span class="text-red-500">*</span>
                                        </label>
                                        <input type="number" step="1" id="meta-caminhao-proprio-viagens" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-3 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white transition-all-300" placeholder="Ex: 10" required>
                                        <div class="invalid-feedback text-red-500 text-sm mt-1 hidden"></div>
                                    </div>
                                    
                                    <div>
                                        <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="meta-caminhao-proprio-toneladas">
                                            Meta em Toneladas <span class="text-red-500">*</span>
                                        </label>
                                        <input type="number" step="0.01" id="meta-caminhao-proprio-toneladas" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-3 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white transition-all-300" placeholder="Ex: 300.00" required>
                                        <div class="invalid-feedback text-red-500 text-sm mt-1 hidden"></div>
                                    </div>
                                    
                                    <div class="grid grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="meta-caminhao-proprio-data-inicio">
                                                Data de Início <span class="text-red-500">*</span>
                                            </label>
                                            <input type="date" id="meta-caminhao-proprio-data-inicio" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-3 dark:bg-gray-700 dark:border-gray-600 dark:text-white transition-all-300" required>
                                        </div>
                                        
                                        <div>
                                            <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="meta-caminhao-proprio-data-fim">
                                                Data de Fim <span class="text-red-500">*</span>
                                            </label>
                                            <input type="date" id="meta-caminhao-proprio-data-fim" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-3 dark:bg-gray-700 dark:border-gray-600 dark:text-white transition-all-300" required>
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="meta-caminhao-proprio-observacoes">
                                            Observações
                                        </label>
                                        <textarea id="meta-caminhao-proprio-observacoes" rows="3" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-3 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white transition-all-300" placeholder="Observações sobre a meta do caminhão próprio"></textarea>
                                    </div>
                                    
                                    <div class="flex items-center space-x-3 pt-4">
                                        <button type="submit" class="flex-1 inline-flex items-center justify-center px-4 py-3 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg text-sm transition-all-300 hover-scale">
                                            <i class="fas fa-save mr-2"></i> <span id="btn-submit-meta-caminhao-proprio-text">Salvar Meta Próprio</span>
                                        </button>
                                        <button type="reset" class="px-4 py-3 bg-gray-200 hover:bg-gray-300 text-gray-700 dark:bg-gray-700 dark:hover:bg-gray-600 dark:text-white font-medium rounded-lg text-sm transition-all-300">
                                            <i class="fas fa-times"></i>
                                        </button>
                                    </div>
                                </form>
                            </div>

                            <!-- Lista de Metas Caminhões Próprios -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg card-shadow p-6">
                                <div class="flex justify-between items-center mb-4">
                                    <h3 class="text-lg font-semibold text-gray-800 dark:text-white">
                                        <i class="fas fa-home text-blue-600 dark:text-blue-400 mr-2"></i>
                                        Metas Caminhões Próprios
                                    </h3>
                                    <button id="btn-refresh-metas-caminhoes-proprios" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors">
                                        <i class="fas fa-sync-alt"></i>
                                    </button>
                                </div>
                                
                                <div class="table-container">
                                    <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                        <thead class="bg-gray-50 dark:bg-gray-700">
                                            <tr>
                                                <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Caminhão</th>
                                                <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Período</th>
                                                <th class="px-3 py-2 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Viagens</th>
                                                <th class="px-3 py-2 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Toneladas</th>
                                                <th class="px-3 py-2 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Status</th>
                                                <th class="px-3 py-2 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Ações</th>
                                            </tr>
                                        </thead>
                                        <tbody id="tabela-metas-caminhoes-proprios" class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                            <!-- Preenchido dinamicamente -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Aba Metas Caminhões Terceiros -->
                    <div id="tab-metas-caminhoes-terceiros" class="tab-caminhao-content hidden">
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <!-- Formulário de Metas Caminhões Terceiros -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg card-shadow p-6">
                                <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-4">
                                    <i class="fas fa-handshake text-orange-600 dark:text-orange-400 mr-2"></i>
                                    Definir Meta Caminhão Terceiro
                                </h3>
                                
                                <form id="form-meta-caminhao-terceiro" class="space-y-4">
                                    <div>
                                        <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="meta-caminhao-terceiro-caminhao">
                                            Caminhão Terceiro <span class="text-red-500">*</span>
                                        </label>
                                        <select id="meta-caminhao-terceiro-caminhao" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-3 dark:bg-gray-700 dark:border-gray-600 dark:text-white transition-all-300" required>
                                            <option value="">Selecione um caminhão terceiro</option>
                                        </select>
                                        <div class="invalid-feedback text-red-500 text-sm mt-1 hidden"></div>
                                    </div>
                                    
                                    <div>
                                        <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="meta-caminhao-terceiro-periodo">
                                            Período <span class="text-red-500">*</span>
                                        </label>
                                        <select id="meta-caminhao-terceiro-periodo" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-3 dark:bg-gray-700 dark:border-gray-600 dark:text-white transition-all-300" required>
                                            <option value="diario">Diário</option>
                                            <option value="semanal">Semanal</option>
                                            <option value="mensal">Mensal</option>
                                        </select>
                                    </div>
                                    
                                    <div>
                                        <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="meta-caminhao-terceiro-viagens">
                                            Meta de Viagens <span class="text-red-500">*</span>
                                        </label>
                                        <input type="number" step="1" id="meta-caminhao-terceiro-viagens" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-3 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white transition-all-300" placeholder="Ex: 8" required>
                                        <div class="invalid-feedback text-red-500 text-sm mt-1 hidden"></div>
                                    </div>
                                    
                                    <div>
                                        <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="meta-caminhao-terceiro-toneladas">
                                            Meta em Toneladas <span class="text-red-500">*</span>
                                        </label>
                                        <input type="number" step="0.01" id="meta-caminhao-terceiro-toneladas" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-3 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white transition-all-300" placeholder="Ex: 240.00" required>
                                        <div class="invalid-feedback text-red-500 text-sm mt-1 hidden"></div>
                                    </div>
                                    
                                    <div class="grid grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="meta-caminhao-terceiro-data-inicio">
                                                Data de Início <span class="text-red-500">*</span>
                                            </label>
                                            <input type="date" id="meta-caminhao-terceiro-data-inicio" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-3 dark:bg-gray-700 dark:border-gray-600 dark:text-white transition-all-300" required>
                                        </div>
                                        
                                        <div>
                                            <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="meta-caminhao-terceiro-data-fim">
                                                Data de Fim <span class="text-red-500">*</span>
                                            </label>
                                            <input type="date" id="meta-caminhao-terceiro-data-fim" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-3 dark:bg-gray-700 dark:border-gray-600 dark:text-white transition-all-300" required>
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <label class="block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium" for="meta-caminhao-terceiro-observacoes">
                                            Observações
                                        </label>
                                        <textarea id="meta-caminhao-terceiro-observacoes" rows="3" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-3 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white transition-all-300" placeholder="Observações sobre a meta do caminhão terceiro"></textarea>
                                    </div>
                                    
                                    <div class="flex items-center space-x-3 pt-4">
                                        <button type="submit" class="flex-1 inline-flex items-center justify-center px-4 py-3 bg-orange-600 hover:bg-orange-700 text-white font-medium rounded-lg text-sm transition-all-300 hover-scale">
                                            <i class="fas fa-save mr-2"></i> <span id="btn-submit-meta-caminhao-terceiro-text">Salvar Meta Terceiro</span>
                                        </button>
                                        <button type="reset" class="px-4 py-3 bg-gray-200 hover:bg-gray-300 text-gray-700 dark:bg-gray-700 dark:hover:bg-gray-600 dark:text-white font-medium rounded-lg text-sm transition-all-300">
                                            <i class="fas fa-times"></i>
                                        </button>
                                    </div>
                                </form>
                            </div>

                            <!-- Lista de Metas Caminhões Terceiros -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg card-shadow p-6">
                                <div class="flex justify-between items-center mb-4">
                                    <h3 class="text-lg font-semibold text-gray-800 dark:text-white">
                                        <i class="fas fa-handshake text-orange-600 dark:text-orange-400 mr-2"></i>
                                        Metas Caminhões Terceiros
                                    </h3>
                                    <button id="btn-refresh-metas-caminhoes-terceiros" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors">
                                        <i class="fas fa-sync-alt"></i>
                                    </button>
                                </div>
                                
                                <div class="table-container">
                                    <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                        <thead class="bg-gray-50 dark:bg-gray-700">
                                            <tr>
                                                <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Caminhão</th>
                                                <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Período</th>
                                                <th class="px-3 py-2 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Viagens</th>
                                                <th class="px-3 py-2 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Toneladas</th>
                                                <th class="px-3 py-2 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Status</th>
                                                <th class="px-3 py-2 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Ações</th>
                                            </tr>
                                        </thead>
                                        <tbody id="tabela-metas-caminhoes-terceiros" class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                            <!-- Preenchido dinamicamente -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Aba Acompanhamento de Caminhões -->
                    <div id="tab-acompanhamento-caminhoes" class="tab-caminhao-content hidden">
                        <!-- Resumo dos Caminhões -->
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                            <div class="bg-white dark:bg-gray-800 rounded-lg card-shadow p-6 text-center hover-scale transition-all-300">
                                <div class="flex items-center justify-center mb-2">
                                    <i class="fas fa-truck text-blue-600 dark:text-blue-400 text-2xl mr-2"></i>
                                    <div>
                                        <div class="text-2xl font-bold text-blue-600 dark:text-blue-400" id="resumo-caminhoes-proprios">0</div>
                                        <div class="text-sm text-gray-500 dark:text-gray-400">Próprios Ativos</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-white dark:bg-gray-800 rounded-lg card-shadow p-6 text-center hover-scale transition-all-300">
                                <div class="flex items-center justify-center mb-2">
                                    <i class="fas fa-handshake text-orange-600 dark:text-orange-400 text-2xl mr-2"></i>
                                    <div>
                                        <div class="text-2xl font-bold text-orange-600 dark:text-orange-400" id="resumo-caminhoes-terceiros">0</div>
                                        <div class="text-sm text-gray-500 dark:text-gray-400">Terceiros Ativos</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-white dark:bg-gray-800 rounded-lg card-shadow p-6 text-center hover-scale transition-all-300">
                                <div class="flex items-center justify-center mb-2">
                                    <i class="fas fa-route text-green-600 dark:text-green-400 text-2xl mr-2"></i>
                                    <div>
                                        <div class="text-2xl font-bold text-green-600 dark:text-green-400" id="resumo-total-viagens">0</div>
                                        <div class="text-sm text-gray-500 dark:text-gray-400">Total Viagens</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-white dark:bg-gray-800 rounded-lg card-shadow p-6 text-center hover-scale transition-all-300">
                                <div class="flex items-center justify-center mb-2">
                                    <i class="fas fa-weight-hanging text-purple-600 dark:text-purple-400 text-2xl mr-2"></i>
                                    <div>
                                        <div class="text-2xl font-bold text-purple-600 dark:text-purple-400" id="resumo-total-transportado">0 T</div>
                                        <div class="text-sm text-gray-500 dark:text-gray-400">Total Transportado</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Tabela de Acompanhamento de Caminhões -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg card-shadow p-6">
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="text-lg font-semibold text-gray-800 dark:text-white">
                                    <i class="fas fa-chart-bar mr-2"></i>Performance dos Caminhões
                                </h3>
                                <div class="flex items-center space-x-2">
                                    <button id="btn-exportar-caminhoes" class="inline-flex items-center px-4 py-2 bg-green-600 hover:bg-green-700 text-white text-sm font-medium rounded-lg transition-all-300 hover-scale">
                                        <i class="fas fa-file-export mr-2"></i> Exportar
                                    </button>
                                    <button id="btn-refresh-acompanhamento-caminhoes" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors">
                                        <i class="fas fa-sync-alt"></i>
                                    </button>
                                </div>
                            </div>
                            
                            <div class="table-container">
                                <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                    <thead class="bg-gray-50 dark:bg-gray-700">
                                        <tr>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Caminhão</th>
                                            <th class="px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Tipo</th>
                                            <th class="px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Motorista</th>
                                            <th class="px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Meta Viagens</th>
                                            <th class="px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Viagens Realizadas</th>
                                            <th class="px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Meta Toneladas</th>
                                            <th class="px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Toneladas Transportadas</th>
                                            <th class="px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">% Performance</th>
                                            <th class="px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Status</th>
                                        </tr>
                                    </thead>
                                    <tbody id="tabela-acompanhamento-caminhoes" class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                        <!-- Preenchido dinamicamente -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Conteúdo de Configurações -->
                <div id="content-configuracoes" class="content hidden">
                    <div class="mb-6">
                        <h2 class="text-2xl font-bold text-gray-800 dark:text-white mb-2">Configurações</h2>
                        <p class="text-gray-600 dark:text-gray-400">Configurações do sistema e gestão de dados</p>
                    </div>
                    
                    <!-- Backup e Restauração -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg card-shadow p-6 mb-6">
                        <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-4">Backup e Restauração</h3>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                            <div class="bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg">
                                <h4 class="text-md font-medium text-blue-800 dark:text-blue-300 mb-2">Exportar Dados</h4>
                                <p class="text-sm text-blue-600 dark:text-blue-400 mb-4">Exporte todos os dados para um arquivo JSON de backup</p>
                                <button id="btn-exportar-json" class="inline-flex items-center px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg text-sm transition-all-300 hover-scale">
                                    <i class="fas fa-download mr-2"></i> Exportar Backup
                                </button>
                            </div>
                            
                            <div class="bg-green-50 dark:bg-green-900/20 p-4 rounded-lg">
                                <h4 class="text-md font-medium text-green-800 dark:text-green-300 mb-2">Importar Dados</h4>
                                <p class="text-sm text-green-600 dark:text-green-400 mb-4">Importe dados de um arquivo JSON previamente exportado</p>
                                
                                <button id="btn-importar-json" class="inline-flex items-center px-4 py-2 bg-green-600 hover:bg-green-700 text-white font-medium rounded-lg text-sm transition-all-300 hover-scale">
                                    <i class="fas fa-upload mr-2"></i> Importar Backup
                                </button>
                                <input type="file" id="import-json-file" accept=".json" class="hidden">
                            </div>
                        </div>
                        
                        <div class="border-t border-gray-200 dark:border-gray-700 pt-6">
                            <div class="bg-red-50 dark:bg-red-900/20 p-4 rounded-lg">
                                <h4 class="text-md font-medium text-red-800 dark:text-red-300 mb-2">Limpar Todos os Dados</h4>
                                <p class="text-sm text-red-600 dark:text-red-400 mb-4">
                                    <span class="font-semibold">Atenção:</span> Esta ação irá remover permanentemente todos os dados do sistema.
                                </p>
                                <button id="btn-limpar-dados" class="inline-flex items-center px-4 py-2 bg-red-600 hover:bg-red-700 text-white font-medium rounded-lg text-sm transition-all-300 hover-scale">
                                    <i class="fas fa-trash-alt mr-2"></i> Limpar Todos os Dados
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Relatórios -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg card-shadow p-6 mb-6">
                        <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-4">Relatórios do Sistema</h3>
                        
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                            <button id="btn-relatorio-liberacoes" class="inline-flex items-center justify-center px-6 py-4 bg-green-600 hover:bg-green-700 text-white font-medium rounded-lg text-sm transition-all-300 hover-scale">
                                <i class="fas fa-chart-line mr-2"></i> Relatório de Liberações
                            </button>
                            <button id="btn-relatorio-metas" class="inline-flex items-center justify-center px-6 py-4 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg text-sm transition-all-300 hover-scale">
                                <i class="fas fa-bullseye mr-2"></i> Relatório de Metas
                            </button>
                            <button id="btn-relatorio-colheita" class="inline-flex items-center justify-center px-6 py-4 bg-orange-600 hover:bg-orange-700 text-white font-medium rounded-lg text-sm transition-all-300 hover-scale">
                                <i class="fas fa-seedling mr-2"></i> Relatório de Colheita
                            </button>
                            <button id="btn-relatorio-caminhoes" class="inline-flex items-center justify-center px-6 py-4 bg-purple-600 hover:bg-purple-700 text-white font-medium rounded-lg text-sm transition-all-300 hover-scale">
                                <i class="fas fa-truck mr-2"></i> Relatório de Caminhões
                            </button>
                        </div>
                    </div>
                    
                    <!-- Sobre o Sistema -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg card-shadow p-6">
                        <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-4">Sobre o Sistema</h3>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <div class="text-sm text-gray-600 dark:text-gray-400 space-y-2">
                                    <p><strong class="text-gray-800 dark:text-white">Nome:</strong> GGOMES-LOG</p>
                                    <p><strong class="text-gray-800 dark:text-white">Versão:</strong> 2.1 Avançada</p>
                                    <p><strong class="text-gray-800 dark:text-white">Descrição:</strong> Sistema avançado de gestão agrícola para acompanhamento de colheita, metas próprias/terceiras, logística com caminhões e análises preditivas.</p>
                                    <p><strong class="text-gray-800 dark:text-white">Desenvolvido por:</strong> GGOMES Technologies</p>
                                </div>
                            </div>
                            
                            <div>
                                <h4 class="text-md font-medium text-gray-800 dark:text-white mb-3">Melhorias da Versão Avançada</h4>
                                <ul class="text-sm text-gray-600 dark:text-gray-400 space-y-1">
                                    <li>• <strong>Dashboard Executivo:</strong> KPIs avançados e análises em tempo real</li>
                                    <li>• <strong>Gestão de Caminhões:</strong> Controle completo de frota própria e terceira</li>
                                    <li>• <strong>Metas de Transporte:</strong> Definição e acompanhamento de metas logísticas</li>
                                    <li>• <strong>Gráficos Avançados:</strong> Evolução temporal e comparativos</li>
                                    <li>• <strong>Alertas Inteligentes:</strong> Notificações baseadas em regras</li>
                                    <li>• <strong>Performance Otimizada:</strong> Cache inteligente de dados</li>
                                    <li>• <strong>Indicadores Avançados:</strong> Tendências e projeções</li>
                                    <li>• <strong>Auto-Refresh:</strong> Atualização automática de dados</li>
                                    <li>• <strong>Relatórios Detalhados:</strong> Análises mais profundas</li>
                                    <li>• <strong>Interface Melhorada:</strong> Responsividade aprimorada</li>
                                </ul>
                            </div>
                        </div>
                        
                        <div class="mt-6 pt-4 border-t border-gray-200 dark:border-gray-700">
                            <p class="text-xs text-gray-500 dark:text-gray-400 text-center">
                                © 2025 GGOMES Technologies. Todos os direitos reservados. Versão Avançada com IA e Gestão de Caminhões.
                            </p>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>
    
    <!-- Modal de confirmação para limpar dados -->
    <div id="modal-limpar-dados" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white dark:bg-gray-800 rounded-lg p-6 max-w-md w-full mx-4 animate-fade-in">
            <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-4">Confirmação de Limpeza</h3>
            
            <p class="text-gray-700 dark:text-gray-300 mb-4">
                <span class="text-red-500 font-semibold">Atenção:</span> Esta ação irá remover <span class="font-semibold">PERMANENTEMENTE</span> todos os dados do sistema.
            </p>
            
            <p class="text-gray-700 dark:text-gray-300 mb-6">
                Para confirmar, digite "CONFIRMAR" no campo abaixo:
            </p>
            
            <div class="mb-6">
                <input type="text" id="confirmacao-texto" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-red-500 focus:border-red-500 block w-full p-3 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white transition-all-300" placeholder="Digite CONFIRMAR">
            </div>
            
            <div class="flex justify-end space-x-4">
                <button id="btn-cancelar-limpar" class="inline-flex items-center px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-700 dark:bg-gray-700 dark:hover:bg-gray-600 dark:text-white font-medium rounded-lg text-sm transition-all-300">
                    <i class="fas fa-times mr-2"></i> Cancelar
                </button>
                <button id="btn-confirmar-limpar" class="inline-flex items-center px-4 py-2 bg-red-600 hover:bg-red-700 text-white font-medium rounded-lg text-sm opacity-50 cursor-not-allowed transition-all-300" disabled>
                    <i class="fas fa-trash-alt mr-2"></i> Sim, Limpar Tudo
                </button>
            </div>
        </div>
    </div>
    
    <!-- Modal de notificações -->
    <div id="modal-notifications" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white dark:bg-gray-800 rounded-lg p-6 max-w-md w-full mx-4 animate-fade-in">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold text-gray-900 dark:text-white">Notificações</h3>
                <button id="btn-close-notifications" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div id="notifications-list" class="space-y-3 max-h-64 overflow-y-auto scrollbar-thin">
                <!-- Preenchido dinamicamente -->
            </div>
            
            <div class="mt-4 pt-4 border-t border-gray-200 dark:border-gray-700">
                <button id="btn-clear-notifications" class="w-full text-center text-sm text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 transition-colors">
                    Limpar todas as notificações
                </button>
            </div>
        </div>
    </div>

<script>
// ===== SISTEMA DE GESTÃO AGRÍCOLA GGOMES-LOG v2.1 AVANÇADO COM CAMINHÕES =====

// Configuração global da aplicação
const AppConfig = {
    version: '2.1-advanced',
    name: 'GGOMES-LOG',
    pagination: { itemsPerPage: 10 },
    charts: {},
    notifications: [],
    autoRefresh: false,
    refreshInterval: null
};

// Cache para otimização de performance
const AcompanhamentoCache = {
    data: null,
    timestamp: null,
    filters: null,
    isValid: function(currentFilters) {
        if (!this.data || !this.timestamp) return false;
        const cacheAge = Date.now() - this.timestamp;
        const maxAge = 30000; // 30 segundos
        return cacheAge < maxAge && JSON.stringify(this.filters) === JSON.stringify(currentFilters);
    },
    set: function(data, filters) {
        this.data = data;
        this.timestamp = Date.now();
        this.filters = { ...filters };
    },
    get: function() {
        return this.data;
    },
    clear: function() {
        this.data = null;
        this.timestamp = null;
        this.filters = null;
    }
};

// Estado de ordenação da tabela de acompanhamento
let currentAcompanhamentoSort = { field: 'percentualMeta', direction: 'desc' };

// Sistema básico de toasts melhorado
const Toast = {
    show: function(message, type = 'success', duration = 4000) {
        const toastContainer = document.getElementById('toast-container');
        if (!toastContainer) return;
        
        const toast = document.createElement('div');
        const colorClasses = {
            'success': 'bg-green-100 dark:bg-green-800 text-green-700 dark:text-green-300 border-green-200 dark:border-green-700',
            'error': 'bg-red-100 dark:bg-red-800 text-red-700 dark:text-red-300 border-red-200 dark:border-red-700',
            'warning': 'bg-yellow-100 dark:bg-yellow-800 text-yellow-700 dark:text-yellow-300 border-yellow-200 dark:border-yellow-700',
            'info': 'bg-blue-100 dark:bg-blue-800 text-blue-700 dark:text-blue-300 border-blue-200 dark:border-blue-700'
        };
        
        const iconClasses = {
            'success': 'fa-check-circle',
            'error': 'fa-exclamation-circle',
            'warning': 'fa-exclamation-triangle',
            'info': 'fa-info-circle'
        };
        
        toast.className = `animate-fade-in p-4 mb-3 rounded-lg border card-shadow flex items-center justify-between max-w-sm ${colorClasses[type] || colorClasses.info}`;
        
        toast.innerHTML = `
            <div class="flex items-center">
                <i class="fas ${iconClasses[type] || iconClasses.info} mr-3 text-lg"></i>
                <span class="text-sm font-medium">${message}</span>
            </div>
            <button class="ml-4 text-current hover:opacity-70 focus:outline-none transition-opacity">
                <i class="fas fa-times"></i>
            </button>
        `;
        
        const closeBtn = toast.querySelector('button');
        closeBtn.addEventListener('click', () => this.remove(toast));
        
        toastContainer.appendChild(toast);
        
        if (duration > 0) {
            setTimeout(() => this.remove(toast), duration);
        }
    },
    
    remove: function(toast) {
        if (toast && toast.parentNode) {
            toast.classList.remove('animate-fade-in');
            toast.classList.add('animate-fade-out');
            setTimeout(() => {
                if (toast.parentNode) {
                    toast.parentNode.removeChild(toast);
                }
            }, 300);
        }
    }
};

// Sistema de Banco de Dados Local melhorado
const DB = {
    // Inicialização do banco de dados
    init: function() {
        this.initializeDefaultData();
        this.updateLastAccess();
    },
    
    // Inicializar dados padrão se não existirem
    initializeDefaultData: function() {
        if (!localStorage.getItem('ggomes_liberacoes')) {
            const hoje = Utils.getLocalDateString();
            const ontem = new Date();
            ontem.setDate(ontem.getDate() - 1);
            const dataOntem = Utils.formatDateForInput(ontem);
            
            const liberacoesIniciais = [
                {
                    id: 'LIB-001',
                    frente: 'Frente 01',
                    fazenda: 'Fazenda São João',
                    numero: 'LIB-2025-001',
                    status: 'fechado',
                    previsto: 1000,
                    realizado: 950,
                    restante: 50,
                    data: dataOntem,
                    observacoes: 'Liberação concluída com sucesso',
                    dataRegistro: new Date().toISOString()
                },
                {
                    id: 'LIB-002',
                    frente: 'Frente 02',
                    fazenda: 'Fazenda Boa Vista',
                    numero: 'LIB-2025-002',
                    status: 'em-andamento',
                    previsto: 1500,
                    realizado: 1200,
                    restante: 300,
                    data: hoje,
                    observacoes: 'Em progresso, boa produtividade',
                    dataRegistro: new Date().toISOString()
                },
                {
                    id: 'LIB-003',
                    frente: 'Frente 01',
                    fazenda: 'Fazenda São João',
                    numero: 'LIB-2025-003',
                    status: 'aberto',
                    previsto: 800,
                    realizado: 200,
                    restante: 600,
                    data: hoje,
                    observacoes: 'Iniciada hoje pela manhã',
                    dataRegistro: new Date().toISOString()
                }
            ];
            localStorage.setItem('ggomes_liberacoes', JSON.stringify(liberacoesIniciais));
            
            const frentesIniciais = [
                {
                    id: 'FRENTE-001',
                    nome: 'Frente 01',
                    fazenda: 'Fazenda São João',
                    tipo: 'propria',
                    responsavel: 'João Silva',
                    status: 'ativa',
                    observacoes: 'Frente principal com alta produtividade',
                    dataRegistro: new Date().toISOString()
                },
                {
                    id: 'FRENTE-002',
                    nome: 'Frente 02',
                    fazenda: 'Fazenda Boa Vista',
                    tipo: 'propria',
                    responsavel: 'Maria Santos',
                    status: 'ativa',
                    observacoes: 'Frente secundária em expansão',
                    dataRegistro: new Date().toISOString()
                },
                {
                    id: 'FRENTE-003',
                    nome: 'Frente Terceira A',
                    fazenda: 'Fazenda Esperança',
                    tipo: 'terceira',
                    responsavel: 'Pedro Lima',
                    status: 'ativa',
                    observacoes: 'Nova frente terceirizada',
                    dataRegistro: new Date().toISOString()
                },
                {
                    id: 'FRENTE-004',
                    nome: 'Frente Desconhecida X',
                    fazenda: 'Fazenda Nova',
                    tipo: 'desconhecido',
                    responsavel: 'A definir',
                    status: 'inativa',
                    observacoes: 'Frente em análise para classificação',
                    dataRegistro: new Date().toISOString()
                }
            ];
            localStorage.setItem('ggomes_frentes', JSON.stringify(frentesIniciais));
            
            const metasIniciais = [
                {
                    id: 'META-001',
                    frenteId: 'FRENTE-001',
                    tipo: 'propria',
                    periodo: 'diario',
                    valor: 180,
                    dataInicio: hoje,
                    dataFim: hoje,
                    observacoes: 'Meta diária padrão própria',
                    dataRegistro: new Date().toISOString()
                },
                {
                    id: 'META-002',
                    frenteId: 'FRENTE-003',
                    tipo: 'terceira',
                    periodo: 'diario',
                    valor: 150,
                    dataInicio: hoje,
                    dataFim: hoje,
                    observacoes: 'Meta inicial terceirizada',
                    dataRegistro: new Date().toISOString()
                }
            ];
            localStorage.setItem('ggomes_metas', JSON.stringify(metasIniciais));
            
            const lancamentosIniciais = [
                {
                    id: 'LANC-001',
                    frenteId: 'FRENTE-001',
                    data: dataOntem,
                    colhido: 175.5,
                    turno: 'manha',
                    operador: 'José Santos',
                    observacoes: 'Excelente rendimento matinal',
                    dataRegistro: new Date().toISOString()
                },
                {
                    id: 'LANC-002',
                    frenteId: 'FRENTE-003',
                    data: dataOntem,
                    colhido: 140.2,
                    turno: 'tarde',
                    operador: 'Pedro Lima',
                    observacoes: 'Boa produtividade terceirizada',
                    dataRegistro: new Date().toISOString()
                }
            ];
            localStorage.setItem('ggomes_lancamentos', JSON.stringify(lancamentosIniciais));
            
            // Dados iniciais de caminhões
            const caminhoesIniciais = [
                {
                    id: 'CAM-001',
                    placa: 'ABC-1234',
                    modelo: 'Scania R450',
                    tipo: 'proprio',
                    capacidade: 30.0,
                    motorista: 'Carlos Silva',
                    status: 'ativo',
                    observacoes: 'Caminhão principal da frota',
                    dataRegistro: new Date().toISOString()
                },
                {
                    id: 'CAM-002',
                    placa: 'DEF-5678',
                    modelo: 'Mercedes Actros',
                    tipo: 'proprio',
                    capacidade: 28.5,
                    motorista: 'José Santos',
                    status: 'ativo',
                    observacoes: 'Caminhão secundário',
                    dataRegistro: new Date().toISOString()
                },
                {
                    id: 'CAM-003',
                    placa: 'GHI-9012',
                    modelo: 'Volvo FH',
                    tipo: 'terceiro',
                    capacidade: 32.0,
                    motorista: 'João Terceiro',
                    status: 'ativo',
                    observacoes: 'Caminhão terceirizado contratado',
                    dataRegistro: new Date().toISOString()
                }
            ];
            localStorage.setItem('ggomes_caminhoes', JSON.stringify(caminhoesIniciais));
            
            // Metas iniciais de caminhões
            const metasCaminhoesIniciais = [
                {
                    id: 'META-CAM-001',
                    caminhaoId: 'CAM-001',
                    tipo: 'proprio',
                    periodo: 'diario',
                    metaViagens: 10,
                    metaToneladas: 300,
                    dataInicio: hoje,
                    dataFim: hoje,
                    observacoes: 'Meta diária padrão',
                    dataRegistro: new Date().toISOString()
                },
                {
                    id: 'META-CAM-002',
                    caminhaoId: 'CAM-003',
                    tipo: 'terceiro',
                    periodo: 'diario',
                    metaViagens: 8,
                    metaToneladas: 256,
                    dataInicio: hoje,
                    dataFim: hoje,
                    observacoes: 'Meta terceirizada',
                    dataRegistro: new Date().toISOString()
                }
            ];
            localStorage.setItem('ggomes_metas_caminhoes', JSON.stringify(metasCaminhoesIniciais));
        }
        
        if (!localStorage.getItem('ggomes_config')) {
            localStorage.setItem('ggomes_config', JSON.stringify({
                version: '2.1-advanced',
                temaEscuro: true,
                ultimoAcesso: new Date().toISOString(),
                notifications: [],
                preferences: { itemsPerPage: 10, autoRefresh: false }
            }));
        }
        
        const tabelas = ['liberacoes', 'frentes', 'metas', 'lancamentos', 'caminhoes', 'metas_caminhoes'];
        tabelas.forEach(tabela => {
            if (!localStorage.getItem(`ggomes_${tabela}`)) {
                localStorage.setItem(`ggomes_${tabela}`, JSON.stringify([]));
            }
        });
    },
    
    updateLastAccess: function() {
        const config = JSON.parse(localStorage.getItem('ggomes_config') || '{}');
        config.ultimoAcesso = new Date().toISOString();
        localStorage.setItem('ggomes_config', JSON.stringify(config));
    },
    
    clearAll: function() {
        try {
            const tabelas = ['liberacoes', 'frentes', 'metas', 'lancamentos', 'caminhoes', 'metas_caminhoes'];
            tabelas.forEach(tabela => {
                localStorage.removeItem(`ggomes_${tabela}`);
                localStorage.setItem(`ggomes_${tabela}`, JSON.stringify([]));
            });
            
            const config = JSON.parse(localStorage.getItem('ggomes_config') || '{}');
            localStorage.setItem('ggomes_config', JSON.stringify({
                version: '2.1-advanced',
                temaEscuro: config.temaEscuro || true,
                ultimoAcesso: new Date().toISOString(),
                notifications: [],
                preferences: config.preferences || { itemsPerPage: 10, autoRefresh: false }
            }));
            
            AcompanhamentoCache.clear();
            return true;
        } catch (error) {
            console.error('Erro ao limpar dados:', error);
            return false;
        }
    },
    
    exportData: function() {
        try {
            const data = {
                liberacoes: JSON.parse(localStorage.getItem('ggomes_liberacoes') || '[]'),
                frentes: JSON.parse(localStorage.getItem('ggomes_frentes') || '[]'),
                metas: JSON.parse(localStorage.getItem('ggomes_metas') || '[]'),
                lancamentos: JSON.parse(localStorage.getItem('ggomes_lancamentos') || '[]'),
                caminhoes: JSON.parse(localStorage.getItem('ggomes_caminhoes') || '[]'),
                metasCaminhoes: JSON.parse(localStorage.getItem('ggomes_metas_caminhoes') || '[]'),
                config: JSON.parse(localStorage.getItem('ggomes_config') || '{}'),
                metaData: {
                    exportDate: new Date().toISOString(),
                    version: '2.1-advanced',
                    description: 'Backup completo do sistema GGOMES-LOG v2.1 Avançado com Caminhões'
                }
            };
            
            return JSON.stringify(data, null, 2);
        } catch (error) {
            console.error('Erro ao exportar dados:', error);
            throw new Error('Não foi possível exportar os dados.');
        }
    },
    
    importData: function(jsonData) {
        try {
            const data = JSON.parse(jsonData);
            
            if (!data.metaData || !data.metaData.version) {
                throw new Error('Arquivo de backup inválido: metadados ausentes.');
            }
            
            if (!data.liberacoes && !data.frentes && !data.metas && !data.lancamentos && !data.caminhoes) {
                throw new Error('Arquivo de backup vazio ou corrompido.');
            }
            
            const tabelas = ['liberacoes', 'frentes', 'metas', 'lancamentos', 'caminhoes'];
            tabelas.forEach(tabela => {
                if (data[tabela] && Array.isArray(data[tabela])) {
                    localStorage.setItem(`ggomes_${tabela}`, JSON.stringify(data[tabela]));
                }
            });
            
            // Importar metas de caminhões
            if (data.metasCaminhoes && Array.isArray(data.metasCaminhoes)) {
                localStorage.setItem('ggomes_metas_caminhoes', JSON.stringify(data.metasCaminhoes));
            }
            
            if (data.config) {
                const currentConfig = JSON.parse(localStorage.getItem('ggomes_config') || '{}');
                const newConfig = {
                    ...data.config,
                    version: '2.1-advanced',
                    temaEscuro: currentConfig.temaEscuro,
                    ultimoAcesso: new Date().toISOString(),
                    preferences: currentConfig.preferences || data.config.preferences || { itemsPerPage: 10, autoRefresh: false }
                };
                localStorage.setItem('ggomes_config', JSON.stringify(newConfig));
            }
            
            AcompanhamentoCache.clear();
            return true;
        } catch (error) {
            console.error('Erro ao importar dados:', error);
            throw error;
        }
    },
    
    // Módulo Liberações
    liberacoes: {
        getAll: function() {
            try {
                const liberacoes = localStorage.getItem('ggomes_liberacoes');
                return liberacoes ? JSON.parse(liberacoes) : [];
            } catch (error) {
                console.error("Erro ao obter liberações:", error);
                return [];
            }
        },
        
        get: function(id) {
            return this.getAll().find(l => l.id === id);
        },
        
        add: function(liberacao) {
            const requiredFields = ['frente', 'fazenda', 'status', 'previsto', 'realizado', 'data'];
            const missingFields = requiredFields.filter(field => !liberacao[field] && liberacao[field] !== 0);
            
            if (missingFields.length > 0) {
                throw new Error(`Campos obrigatórios ausentes: ${missingFields.join(', ')}`);
            }
            
            const liberacoes = this.getAll();
            
            if (!liberacao.id) {
                liberacao.id = Utils.gerarId('LIB');
            }
            
            if (liberacoes.some(l => l.id === liberacao.id)) {
                throw new Error(`Liberação com ID "${liberacao.id}" já existe.`);
            }
            
            liberacao.restante = Number(liberacao.previsto) - Number(liberacao.realizado);
            liberacao.dataRegistro = liberacao.dataRegistro || new Date().toISOString();
            
            if (Number(liberacao.previsto) < 0 || Number(liberacao.realizado) < 0) {
                throw new Error('Valores previstos e realizados devem ser positivos.');
            }
            
            liberacoes.push(liberacao);
            localStorage.setItem('ggomes_liberacoes', JSON.stringify(liberacoes));
            
            return liberacao;
        },
        
        update: function(liberacao) {
            if (!liberacao.id) {
                throw new Error('ID da liberação é obrigatório.');
            }
            
            const liberacoes = this.getAll();
            const index = liberacoes.findIndex(l => l.id === liberacao.id);
            
            if (index === -1) {
                throw new Error(`Liberação com ID "${liberacao.id}" não encontrada.`);
            }
            
            if (liberacao.previsto !== undefined || liberacao.realizado !== undefined) {
                const previsto = liberacao.previsto !== undefined ? Number(liberacao.previsto) : Number(liberacoes[index].previsto);
                const realizado = liberacao.realizado !== undefined ? Number(liberacao.realizado) : Number(liberacoes[index].realizado);
                liberacao.restante = previsto - realizado;
            }
            
            liberacoes[index] = { ...liberacoes[index], ...liberacao };
            localStorage.setItem('ggomes_liberacoes', JSON.stringify(liberacoes));
            
            return liberacoes[index];
        },
        
        remove: function(id) {
            const liberacoes = this.getAll();
            const index = liberacoes.findIndex(l => l.id === id);
            
            if (index === -1) {
                throw new Error(`Liberação com ID "${id}" não encontrada.`);
            }
            
            liberacoes.splice(index, 1);
            localStorage.setItem('ggomes_liberacoes', JSON.stringify(liberacoes));
            
            return true;
        },
        
        getTotals: function(filtroFrente = '', filtroFazenda = '', filtroStatus = '') {
            let liberacoes = this.getAll();
            
            if (filtroFrente) liberacoes = liberacoes.filter(l => l.frente === filtroFrente);
            if (filtroFazenda) liberacoes = liberacoes.filter(l => l.fazenda === filtroFazenda);
            if (filtroStatus) liberacoes = liberacoes.filter(l => l.status === filtroStatus);
            
            const totals = {
                previsto: 0, realizado: 0, restante: 0,
                statusAberto: 0, statusFechado: 0, statusEmAndamento: 0, statusCancelado: 0,
                totalGeral: 0, count: liberacoes.length
            };
            
            liberacoes.forEach(l => {
                const previsto = Number(l.previsto) || 0;
                const realizado = Number(l.realizado) || 0;
                const restante = Number(l.restante) || 0;
                
                totals.previsto += previsto;
                totals.realizado += realizado;
                totals.restante += restante;
                totals.totalGeral += previsto;
                
                switch(l.status) {
                    case 'aberto': totals.statusAberto++; break;
                    case 'fechado': totals.statusFechado++; break;
                    case 'em-andamento': totals.statusEmAndamento++; break;
                    case 'cancelado': totals.statusCancelado++; break;
                }
            });
            
            return totals;
        },
        
        getUniqueValues: function() {
            const liberacoes = this.getAll();
            const frentes = new Set();
            const fazendas = new Set();
            const status = new Set();
            
            liberacoes.forEach(l => {
                frentes.add(l.frente);
                fazendas.add(l.fazenda);
                if (l.status) status.add(l.status);
            });
            
            return {
                frentes: Array.from(frentes).sort(),
                fazendas: Array.from(fazendas).sort(),
                status: Array.from(status).sort()
            };
        },
        
        search: function(term, filters = {}) {
            let liberacoes = this.getAll();
            
            Object.keys(filters).forEach(key => {
                if (filters[key]) {
                    liberacoes = liberacoes.filter(l => l[key] === filters[key]);
                }
            });
            
            if (term) {
                const lowerTerm = term.toLowerCase();
                liberacoes = liberacoes.filter(l => 
                    (l.frente && l.frente.toLowerCase().includes(lowerTerm)) ||
                    (l.fazenda && l.fazenda.toLowerCase().includes(lowerTerm)) ||
                    (l.numero && l.numero.toLowerCase().includes(lowerTerm)) ||
                    (l.observacoes && l.observacoes.toLowerCase().includes(lowerTerm))
                );
            }
            
            return liberacoes;
        },
        
        paginate: function(liberacoes, page = 1, itemsPerPage = 10) {
            const startIndex = (page - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            
            return {
                data: liberacoes.slice(startIndex, endIndex),
                totalPages: Math.ceil(liberacoes.length / itemsPerPage),
                currentPage: page,
                totalItems: liberacoes.length,
                itemsPerPage: itemsPerPage
            };
        }
    },

    // Módulo Frentes
    frentes: {
        getAll: function() {
            try {
                const frentes = localStorage.getItem('ggomes_frentes');
                return frentes ? JSON.parse(frentes) : [];
            } catch (error) {
                console.error("Erro ao obter frentes:", error);
                return [];
            }
        },
        
        get: function(id) {
            return this.getAll().find(f => f.id === id);
        },
        
        add: function(frente) {
            const requiredFields = ['nome', 'fazenda', 'tipo', 'status'];
            const missingFields = requiredFields.filter(field => !frente[field]);
            
            if (missingFields.length > 0) {
                throw new Error(`Campos obrigatórios ausentes: ${missingFields.join(', ')}`);
            }
            
            const frentes = this.getAll();
            
            if (!frente.id) {
                frente.id = Utils.gerarId('FRENTE');
            }
            
            if (frentes.some(f => f.nome === frente.nome && f.fazenda === frente.fazenda)) {
                throw new Error(`Já existe uma frente com o nome "${frente.nome}" na fazenda "${frente.fazenda}".`);
            }
            
            frente.dataRegistro = frente.dataRegistro || new Date().toISOString();
            frentes.push(frente);
            localStorage.setItem('ggomes_frentes', JSON.stringify(frentes));
            
            AcompanhamentoCache.clear();
            return frente;
        },
        
        update: function(frente) {
            if (!frente.id) {
                throw new Error('ID da frente é obrigatório.');
            }
            
            const frentes = this.getAll();
            const index = frentes.findIndex(f => f.id === frente.id);
            
            if (index === -1) {
                throw new Error(`Frente com ID "${frente.id}" não encontrada.`);
            }
            
            frentes[index] = { ...frentes[index], ...frente };
            localStorage.setItem('ggomes_frentes', JSON.stringify(frentes));
            
            AcompanhamentoCache.clear();
            return frentes[index];
        },
        
        remove: function(id) {
            const frentes = this.getAll();
            const index = frentes.findIndex(f => f.id === id);
            
            if (index === -1) {
                throw new Error(`Frente com ID "${id}" não encontrada.`);
            }
            
            const metas = DB.metas.getAll().filter(m => m.frenteId === id);
            const lancamentos = DB.lancamentos.getAll().filter(l => l.frenteId === id);
            
            if (metas.length > 0 || lancamentos.length > 0) {
                throw new Error('Não é possível excluir a frente pois há metas ou lançamentos vinculados a ela.');
            }
            
            frentes.splice(index, 1);
            localStorage.setItem('ggomes_frentes', JSON.stringify(frentes));
            
            AcompanhamentoCache.clear();
            return true;
        },
        
        getAtivas: function() {
            return this.getAll().filter(f => f.status === 'ativa');
        },
        
        getByTipo: function(tipo) {
            return this.getAll().filter(f => f.tipo === tipo);
        },
        
        getAtivasByTipo: function(tipo) {
            return this.getAll().filter(f => f.status === 'ativa' && f.tipo === tipo);
        }
    },

    // Módulo Metas
    metas: {
        getAll: function() {
            try {
                const metas = localStorage.getItem('ggomes_metas');
                return metas ? JSON.parse(metas) : [];
            } catch (error) {
                console.error("Erro ao obter metas:", error);
                return [];
            }
        },
        
        get: function(id) {
            return this.getAll().find(m => m.id === id);
        },
        
        add: function(meta) {
            const requiredFields = ['frenteId', 'tipo', 'periodo', 'valor', 'dataInicio', 'dataFim'];
            const missingFields = requiredFields.filter(field => !meta[field] && meta[field] !== 0);
            
            if (missingFields.length > 0) {
                throw new Error(`Campos obrigatórios ausentes: ${missingFields.join(', ')}`);
            }
            
            if (!meta.id) {
                meta.id = Utils.gerarId('META');
            }
            
            const metas = this.getAll();
            meta.dataRegistro = meta.dataRegistro || new Date().toISOString();
            metas.push(meta);
            localStorage.setItem('ggomes_metas', JSON.stringify(metas));
            
            AcompanhamentoCache.clear();
            return meta;
        },
        
        update: function(meta) {
            if (!meta.id) {
                throw new Error('ID da meta é obrigatório.');
            }
            
            const metas = this.getAll();
            const index = metas.findIndex(m => m.id === meta.id);
            
            if (index === -1) {
                throw new Error(`Meta com ID "${meta.id}" não encontrada.`);
            }
            
            metas[index] = { ...metas[index], ...meta };
            localStorage.setItem('ggomes_metas', JSON.stringify(metas));
            
            AcompanhamentoCache.clear();
            return metas[index];
        },
        
        remove: function(id) {
            const metas = this.getAll();
            const index = metas.findIndex(m => m.id === id);
            
            if (index === -1) {
                throw new Error(`Meta com ID "${id}" não encontrada.`);
            }
            
            metas.splice(index, 1);
            localStorage.setItem('ggomes_metas', JSON.stringify(metas));
            
            AcompanhamentoCache.clear();
            return true;
        },
        
        getAtivas: function(dataRef = null) {
            const data = dataRef || Utils.getLocalDateString();
            return this.getAll().filter(m => m.dataInicio <= data && m.dataFim >= data);
        },
        
        getByTipo: function(tipo) {
            return this.getAll().filter(m => m.tipo === tipo);
        },
        
        getAtivasByTipo: function(tipo, dataRef = null) {
            const data = dataRef || Utils.getLocalDateString();
            return this.getAll().filter(m => m.tipo === tipo && m.dataInicio <= data && m.dataFim >= data);
        }
    },

    // Módulo Lançamentos
    lancamentos: {
        getAll: function() {
            try {
                const lancamentos = localStorage.getItem('ggomes_lancamentos');
                return lancamentos ? JSON.parse(lancamentos) : [];
            } catch (error) {
                console.error("Erro ao obter lançamentos:", error);
                return [];
            }
        },
        
        get: function(id) {
            return this.getAll().find(l => l.id === id);
        },
        
        add: function(lancamento) {
            const requiredFields = ['frenteId', 'data', 'colhido', 'turno'];
            const missingFields = requiredFields.filter(field => !lancamento[field] && lancamento[field] !== 0);
            
            if (missingFields.length > 0) {
                throw new Error(`Campos obrigatórios ausentes: ${missingFields.join(', ')}`);
            }
            
            if (!lancamento.id) {
                lancamento.id = Utils.gerarId('LANC');
            }
            
            const lancamentos = this.getAll();
            lancamento.dataRegistro = lancamento.dataRegistro || new Date().toISOString();
            lancamentos.push(lancamento);
            localStorage.setItem('ggomes_lancamentos', JSON.stringify(lancamentos));
            
            AcompanhamentoCache.clear();
            return lancamento;
        },
        
        update: function(lancamento) {
            if (!lancamento.id) {
                throw new Error('ID do lançamento é obrigatório.');
            }
            
            const lancamentos = this.getAll();
            const index = lancamentos.findIndex(l => l.id === lancamento.id);
            
            if (index === -1) {
                throw new Error(`Lançamento com ID "${lancamento.id}" não encontrado.`);
            }
            
            lancamentos[index] = { ...lancamentos[index], ...lancamento };
            localStorage.setItem('ggomes_lancamentos', JSON.stringify(lancamentos));
            
            AcompanhamentoCache.clear();
            return lancamentos[index];
        },
        
        remove: function(id) {
            const lancamentos = this.getAll();
            const index = lancamentos.findIndex(l => l.id === id);
            
            if (index === -1) {
                throw new Error(`Lançamento com ID "${id}" não encontrado.`);
            }
            
            lancamentos.splice(index, 1);
            localStorage.setItem('ggomes_lancamentos', JSON.stringify(lancamentos));
            
            AcompanhamentoCache.clear();
            return true;
        },
        
        getByFrente: function(frenteId) {
            return this.getAll().filter(l => l.frenteId === frenteId);
        },
        
        getByPeriodo: function(dataInicio, dataFim) {
            return this.getAll().filter(l => l.data >= dataInicio && l.data <= dataFim);
        },
        
        getTotalColhidoPorFrente: function(frenteId, dataInicio, dataFim) {
            const lancamentos = this.getAll().filter(l => 
                l.frenteId === frenteId && 
                l.data >= dataInicio && 
                l.data <= dataFim
            );
            
            return lancamentos.reduce((total, l) => total + Number(l.colhido), 0);
        }
    },

    // Novo Módulo Caminhões
    caminhoes: {
        getAll: function() {
            try {
                const caminhoes = localStorage.getItem('ggomes_caminhoes');
                return caminhoes ? JSON.parse(caminhoes) : [];
            } catch (error) {
                console.error("Erro ao obter caminhões:", error);
                return [];
            }
        },
        
        get: function(id) {
            return this.getAll().find(c => c.id === id);
        },
        
        add: function(caminhao) {
            const requiredFields = ['placa', 'modelo', 'tipo', 'capacidade', 'status'];
            const missingFields = requiredFields.filter(field => !caminhao[field] && caminhao[field] !== 0);
            
            if (missingFields.length > 0) {
                throw new Error(`Campos obrigatórios ausentes: ${missingFields.join(', ')}`);
            }
            
            const caminhoes = this.getAll();
            
            if (!caminhao.id) {
                caminhao.id = Utils.gerarId('CAM');
            }
            
            if (caminhoes.some(c => c.placa === caminhao.placa)) {
                throw new Error(`Já existe um caminhão com a placa "${caminhao.placa}".`);
            }
            
            caminhao.dataRegistro = caminhao.dataRegistro || new Date().toISOString();
            caminhoes.push(caminhao);
            localStorage.setItem('ggomes_caminhoes', JSON.stringify(caminhoes));
            
            return caminhao;
        },
        
        update: function(caminhao) {
            if (!caminhao.id) {
                throw new Error('ID do caminhão é obrigatório.');
            }
            
            const caminhoes = this.getAll();
            const index = caminhoes.findIndex(c => c.id === caminhao.id);
            
            if (index === -1) {
                throw new Error(`Caminhão com ID "${caminhao.id}" não encontrado.`);
            }
            
            caminhoes[index] = { ...caminhoes[index], ...caminhao };
            localStorage.setItem('ggomes_caminhoes', JSON.stringify(caminhoes));
            
            return caminhoes[index];
        },
        
        remove: function(id) {
            const caminhoes = this.getAll();
            const index = caminhoes.findIndex(c => c.id === id);
            
            if (index === -1) {
                throw new Error(`Caminhão com ID "${id}" não encontrado.`);
            }
            
            const metas = DB.metasCaminhoes.getAll().filter(m => m.caminhaoId === id);
            
            if (metas.length > 0) {
                throw new Error('Não é possível excluir o caminhão pois há metas vinculadas a ele.');
            }
            
            caminhoes.splice(index, 1);
            localStorage.setItem('ggomes_caminhoes', JSON.stringify(caminhoes));
            
            return true;
        },
        
        getAtivos: function() {
            return this.getAll().filter(c => c.status === 'ativo');
        },
        
        getByTipo: function(tipo) {
            return this.getAll().filter(c => c.tipo === tipo);
        },
        
        getAtivosByTipo: function(tipo) {
            return this.getAll().filter(c => c.status === 'ativo' && c.tipo === tipo);
        }
    },

    // Novo Módulo Metas de Caminhões
    metasCaminhoes: {
        getAll: function() {
            try {
                const metas = localStorage.getItem('ggomes_metas_caminhoes');
                return metas ? JSON.parse(metas) : [];
            } catch (error) {
                console.error("Erro ao obter metas de caminhões:", error);
                return [];
            }
        },
        
        get: function(id) {
            return this.getAll().find(m => m.id === id);
        },
        
        add: function(meta) {
            const requiredFields = ['caminhaoId', 'tipo', 'periodo', 'metaViagens', 'metaToneladas', 'dataInicio', 'dataFim'];
            const missingFields = requiredFields.filter(field => !meta[field] && meta[field] !== 0);
            
            if (missingFields.length > 0) {
                throw new Error(`Campos obrigatórios ausentes: ${missingFields.join(', ')}`);
            }
            
            if (!meta.id) {
                meta.id = Utils.gerarId('META-CAM');
            }
            
            const metas = this.getAll();
            meta.dataRegistro = meta.dataRegistro || new Date().toISOString();
            metas.push(meta);
            localStorage.setItem('ggomes_metas_caminhoes', JSON.stringify(metas));
            
            return meta;
        },
        
        update: function(meta) {
            if (!meta.id) {
                throw new Error('ID da meta é obrigatório.');
            }
            
            const metas = this.getAll();
            const index = metas.findIndex(m => m.id === meta.id);
            
            if (index === -1) {
                throw new Error(`Meta com ID "${meta.id}" não encontrada.`);
            }
            
            metas[index] = { ...metas[index], ...meta };
            localStorage.setItem('ggomes_metas_caminhoes', JSON.stringify(metas));
            
            return metas[index];
        },
        
        remove: function(id) {
            const metas = this.getAll();
            const index = metas.findIndex(m => m.id === id);
            
            if (index === -1) {
                throw new Error(`Meta com ID "${id}" não encontrada.`);
            }
            
            metas.splice(index, 1);
            localStorage.setItem('ggomes_metas_caminhoes', JSON.stringify(metas));
            
            return true;
        },
        
        getAtivas: function(dataRef = null) {
            const data = dataRef || Utils.getLocalDateString();
            return this.getAll().filter(m => m.dataInicio <= data && m.dataFim >= data);
        },
        
        getByTipo: function(tipo) {
            return this.getAll().filter(m => m.tipo === tipo);
        },
        
        getAtivasByTipo: function(tipo, dataRef = null) {
            const data = dataRef || Utils.getLocalDateString();
            return this.getAll().filter(m => m.tipo === tipo && m.dataInicio <= data && m.dataFim >= data);
        }
    }
};

// Sistema de notificações
const NotificationManager = {
    add: function(message, type = 'info', duration = 5000) {
        const notification = {
            id: Utils.gerarId('NOT'),
            message,
            type,
            timestamp: new Date().toISOString(),
            read: false
        };
        
        AppConfig.notifications.unshift(notification);
        
        if (AppConfig.notifications.length > 50) {
            AppConfig.notifications = AppConfig.notifications.slice(0, 50);
        }
        
        this.updateBadge();
        Toast.show(message, type, duration);
        
        const config = JSON.parse(localStorage.getItem('ggomes_config') || '{}');
        config.notifications = AppConfig.notifications;
        localStorage.setItem('ggomes_config', JSON.stringify(config));
    },
    
    markAsRead: function(id) {
        const notification = AppConfig.notifications.find(n => n.id === id);
        if (notification) {
            notification.read = true;
            this.updateBadge();
        }
    },
    
    markAllAsRead: function() {
        AppConfig.notifications.forEach(n => n.read = true);
        this.updateBadge();
    },
    
    clear: function() {
        AppConfig.notifications = [];
        this.updateBadge();
        
        const config = JSON.parse(localStorage.getItem('ggomes_config') || '{}');
        config.notifications = [];
        localStorage.setItem('ggomes_config', JSON.stringify(config));
    },
    
    updateBadge: function() {
        const unreadCount = AppConfig.notifications.filter(n => !n.read).length;
        const badge = document.getElementById('notification-badge');
        
        if (badge) {
            if (unreadCount > 0) {
                badge.textContent = unreadCount > 99 ? '99+' : unreadCount;
                badge.classList.remove('hidden');
            } else {
                badge.classList.add('hidden');
            }
        }
    },
    
    load: function() {
        const config = JSON.parse(localStorage.getItem('ggomes_config') || '{}');
        AppConfig.notifications = config.notifications || [];
        this.updateBadge();
    }
};

// Utilidades CORRIGIDAS
const Utils = {
    // CORREÇÃO: Função para obter data local formatada corretamente
    getLocalDateString: function() {
        const now = new Date();
        const year = now.getFullYear();
        const month = String(now.getMonth() + 1).padStart(2, '0');
        const day = String(now.getDate()).padStart(2, '0');
        return `${year}-${month}-${day}`;
    },
    
    // CORREÇÃO: Formatar data para input date
    formatDateForInput: function(date) {
        if (!date) return this.getLocalDateString();
        
        const d = date instanceof Date ? date : new Date(date);
        const year = d.getFullYear();
        const month = String(d.getMonth() + 1).padStart(2, '0');
        const day = String(d.getDate()).padStart(2, '0');
        return `${year}-${month}-${day}`;
    },
    
    formatarToneladas: function(valor) {
        const numero = Number(valor) || 0;
        return numero.toLocaleString('pt-BR', { 
            minimumFractionDigits: 1, 
            maximumFractionDigits: 1 
        }) + ' T';
    },
    
    formatarData: function(dataStr) {
        if (!dataStr) return '--/--/----';
        
        try {
            const data = new Date(dataStr + 'T00:00:00'); // Força interpretação local
            return data.toLocaleDateString('pt-BR');
        } catch (error) {
            return '--/--/----';
        }
    },
    
    formatarDataHora: function(dataStr) {
        if (!dataStr) return '--/--/---- --:--';
        
        try {
            const data = new Date(dataStr);
            return data.toLocaleString('pt-BR');
        } catch (error) {
            return '--/--/---- --:--';
        }
    },
    
    gerarId: function(prefixo = 'ID') {
        return `${prefixo}-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;
    },
    
    getStatusConfig: function(status) {
        const configs = {
            'aberto': { 
                texto: 'Aberto', 
                cor: 'green', 
                bg: 'bg-green-100 dark:bg-green-900', 
                text: 'text-green-700 dark:text-green-300',
                icon: 'fa-play-circle'
            },
            'fechado': { 
                texto: 'Fechado', 
                cor: 'blue', 
                bg: 'bg-blue-100 dark:bg-blue-900', 
                text: 'text-blue-700 dark:text-blue-300',
                icon: 'fa-check-circle'
            },
            'em-andamento': { 
                texto: 'Em Andamento', 
                cor: 'yellow', 
                bg: 'bg-yellow-100 dark:bg-yellow-900', 
                text: 'text-yellow-700 dark:text-yellow-300',
                icon: 'fa-clock'
            },
            'cancelado': { 
                texto: 'Cancelado', 
                cor: 'red', 
                bg: 'bg-red-100 dark:bg-red-900', 
                text: 'text-red-700 dark:text-red-300',
                icon: 'fa-times-circle'
            },
            'ativa': { 
                texto: 'Ativa', 
                cor: 'green', 
                bg: 'bg-green-100 dark:bg-green-900', 
                text: 'text-green-700 dark:text-green-300',
                icon: 'fa-check-circle'
            },
            'ativo': { 
                texto: 'Ativo', 
                cor: 'green', 
                bg: 'bg-green-100 dark:bg-green-900', 
                text: 'text-green-700 dark:text-green-300',
                icon: 'fa-check-circle'
            },
            'inativa': { 
                texto: 'Inativa', 
                cor: 'red', 
                bg: 'bg-red-100 dark:bg-red-900', 
                text: 'text-red-700 dark:text-red-300',
                icon: 'fa-times-circle'
            },
            'inativo': { 
                texto: 'Inativo', 
                cor: 'red', 
                bg: 'bg-red-100 dark:bg-red-900', 
                text: 'text-red-700 dark:text-red-300',
                icon: 'fa-times-circle'
            },
            'manutencao': { 
                texto: 'Manutenção', 
                cor: 'yellow', 
                bg: 'bg-yellow-100 dark:bg-yellow-900', 
                text: 'text-yellow-700 dark:text-yellow-300',
                icon: 'fa-tools'
            }
        };
        
        return configs[status] || { 
            texto: status || 'Desconhecido', 
            cor: 'gray', 
            bg: 'bg-gray-100 dark:bg-gray-900', 
            text: 'text-gray-700 dark:text-gray-300',
            icon: 'fa-question-circle'
        };
    },
    
    getTipoConfig: function(tipo) {
        const configs = {
            'propria': {
                texto: 'Própria',
                cor: 'blue',
                bg: 'bg-blue-100 dark:bg-blue-900',
                text: 'text-blue-700 dark:text-blue-300',
                icon: 'fa-home'
            },
            'proprio': {
                texto: 'Próprio',
                cor: 'blue',
                bg: 'bg-blue-100 dark:bg-blue-900',
                text: 'text-blue-700 dark:text-blue-300',
                icon: 'fa-home'
            },
            'terceira': {
                texto: 'Terceira',
                cor: 'orange',
                bg: 'bg-orange-100 dark:bg-orange-900',
                text: 'text-orange-700 dark:text-orange-300',
                icon: 'fa-handshake'
            },
            'terceiro': {
                texto: 'Terceiro',
                cor: 'orange',
                bg: 'bg-orange-100 dark:bg-orange-900',
                text: 'text-orange-700 dark:text-orange-300',
                icon: 'fa-handshake'
            },
            'desconhecido': {
                texto: 'Desconhecido',
                cor: 'gray',
                bg: 'bg-gray-100 dark:bg-gray-900',
                text: 'text-gray-700 dark:text-gray-300',
                icon: 'fa-question-circle'
            }
        };
        
        return configs[tipo] || {
            texto: tipo || 'Desconhecido',
            cor: 'gray',
            bg: 'bg-gray-100 dark:bg-gray-900',
            text: 'text-gray-700 dark:text-gray-300',
            icon: 'fa-question-circle'
        };
    },
    
    showLoading: function(show = true) {
        const overlay = document.getElementById('loading-overlay');
        if (overlay) {
            if (show) {
                overlay.classList.remove('hidden');
            } else {
                overlay.classList.add('hidden');
            }
        }
    },
    
    exportarPDF: function(titulo, dados, colunas, nomeArquivo) {
        if (!window.jspdf || !window.jspdf.jsPDF) {
            Toast.show('Biblioteca PDF não carregada', 'error');
            return;
        }
        
        if (!dados || !dados.length) {
            Toast.show('Não há dados para exportar', 'error');
            return;
        }
        
        try {
            this.showLoading(true);
            
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            doc.setFontSize(18);
            doc.setFont(undefined, 'bold');
            doc.text(titulo, 14, 22);
            
            doc.setFontSize(10);
            doc.setFont(undefined, 'normal');
            doc.text(`Gerado em: ${new Date().toLocaleString('pt-BR')}`, 14, 30);
            doc.text(`Sistema: GGOMES-LOG v${AppConfig.version}`, 14, 35);
            
            doc.autoTable({
                head: [colunas.map(col => col.header)],
                body: dados.map(item => colunas.map(col => {
                    if (typeof col.dataKey === 'function') {
                        return col.dataKey(item);
                    }
                    return item[col.dataKey] || '';
                })),
                startY: 42,
                theme: 'grid',
                styles: {
                    fontSize: 8,
                    cellPadding: 3,
                    lineColor: [200, 200, 200],
                    lineWidth: 0.1
                },
                headStyles: {
                    fillColor: [93, 92, 222],
                    textColor: [255, 255, 255],
                    fontStyle: 'bold',
                    fontSize: 9
                },
                alternateRowStyles: {
                    fillColor: [248, 249, 250]
                }
            });
            
            const pageCount = doc.internal.getNumberOfPages();
            for(let i = 1; i <= pageCount; i++) {
                doc.setPage(i);
                doc.setFontSize(8);
                doc.text(
                    `Página ${i} de ${pageCount} - GGOMES-LOG Sistema de Gestão Agrícola`, 
                    doc.internal.pageSize.width / 2, 
                    doc.internal.pageSize.height - 10, 
                    { align: 'center' }
                );
            }
            
            doc.save(nomeArquivo || 'relatorio.pdf');
            
            Toast.show('Relatório PDF gerado com sucesso', 'success');
        } catch (error) {
            console.error('Erro ao gerar PDF:', error);
            Toast.show('Erro ao gerar PDF: ' + error.message, 'error');
        } finally {
            this.showLoading(false);
        }
    },

    getNomeFrente: function(frenteId) {
        const frente = DB.frentes.get(frenteId);
        return frente ? frente.nome : 'Frente não encontrada';
    },
    
    getNomeCaminhao: function(caminhaoId) {
        const caminhao = DB.caminhoes.get(caminhaoId);
        return caminhao ? `${caminhao.placa} - ${caminhao.modelo}` : 'Caminhão não encontrado';
    },

    getStatusMeta: function(progresso) {
        if (progresso >= 100) return { texto: 'Atingida', cor: 'green' };
        if (progresso >= 80) return { texto: 'Próximo', cor: 'yellow' };
        if (progresso >= 50) return { texto: 'Progresso', cor: 'blue' };
        return { texto: 'Abaixo', cor: 'red' };
    },
    
    debounce: function(func, wait) {
        let timeout;
        return function executedFunction(...args) {
            const later = () => {
                clearTimeout(timeout);
                func(...args);
            };
            clearTimeout(timeout);
            timeout = setTimeout(later, wait);
        };
    },
    
    validateForm: function(formElement) {
        const inputs = formElement.querySelectorAll('input[required], select[required], textarea[required]');
        let isValid = true;
        
        inputs.forEach(input => {
            const feedback = input.parentNode.querySelector('.invalid-feedback');
            
            if (!input.value.trim()) {
                input.classList.add('form-error');
                if (feedback) {
                    feedback.textContent = 'Este campo é obrigatório';
                    feedback.classList.remove('hidden');
                }
                isValid = false;
            } else {
                input.classList.remove('form-error');
                input.classList.add('form-success');
                if (feedback) {
                    feedback.classList.add('hidden');
                }
            }
        });
        
        return isValid;
    },
    
    clearFormValidation: function(formElement) {
        const inputs = formElement.querySelectorAll('input, select, textarea');
        inputs.forEach(input => {
            input.classList.remove('form-error', 'form-success');
            const feedback = input.parentNode.querySelector('.invalid-feedback');
            if (feedback) {
                feedback.classList.add('hidden');
            }
        });
    }
};

// Sistema de gráficos MELHORADO
const ChartManager = {
    init: function() {
        if (window.Chart) {
            Chart.defaults.color = document.documentElement.classList.contains('dark') ? '#e5e7eb' : '#374151';
            Chart.defaults.borderColor = document.documentElement.classList.contains('dark') ? '#374151' : '#e5e7eb';
            Chart.defaults.backgroundColor = document.documentElement.classList.contains('dark') ? '#1f2937' : '#ffffff';
        }
    },
    
    // Gráfico de Evolução da Colheita (novo)
    createEvolucaoColheitaChart: function() {
        const ctx = document.getElementById('chart-evolucao-colheita');
        if (!ctx || !window.Chart) return;
        
        const lancamentos = DB.lancamentos.getAll();
        const metas = DB.metas.getAll();
        
        // Últimos 30 dias
        const hoje = new Date();
        const dataInicial = new Date(hoje.getTime() - 30 * 24 * 60 * 60 * 1000);
        
        const labels = [];
        const dataColhido = [];
        const dataMetas = [];
        
        for (let i = 0; i < 30; i++) {
            const data = new Date(dataInicial.getTime() + i * 24 * 60 * 60 * 1000);
            const dataStr = Utils.formatDateForInput(data);
            
            labels.push(data.toLocaleDateString('pt-BR', { day: '2-digit', month: '2-digit' }));
            
            // Calcular total colhido do dia
            const colhidoDia = lancamentos
                .filter(l => l.data === dataStr)
                .reduce((sum, l) => sum + Number(l.colhido), 0);
            
            dataColhido.push(colhidoDia);
            
            // Calcular meta do dia
            const metaDia = metas
                .filter(m => m.dataInicio <= dataStr && m.dataFim >= dataStr)
                .reduce((sum, m) => sum + Number(m.valor), 0);
            
            dataMetas.push(metaDia);
        }
        
        const data = {
            labels: labels,
            datasets: [
                {
                    label: 'Colhido',
                    data: dataColhido,
                    borderColor: '#10b981',
                    backgroundColor: 'rgba(16, 185, 129, 0.1)',
                    fill: true,
                    tension: 0.4
                },
                {
                    label: 'Meta',
                    data: dataMetas,
                    borderColor: '#f59e0b',
                    backgroundColor: 'rgba(245, 158, 11, 0.1)',
                    borderDash: [5, 5],
                    fill: false
                }
            ]
        };
        
        AppConfig.charts.evolucaoColheitaChart = new Chart(ctx, {
            type: 'line',
            data: data,
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'top',
                    },
                    tooltip: {
                        mode: 'index',
                        intersect: false,
                        callbacks: {
                            label: function(context) {
                                return `${context.dataset.label}: ${Utils.formatarToneladas(context.parsed.y)}`;
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: {
                            callback: function(value) {
                                return Utils.formatarToneladas(value);
                            }
                        }
                    }
                },
                interaction: {
                    mode: 'nearest',
                    axis: 'x',
                    intersect: false
                }
            }
        });
    },
    
    // Gráfico de Performance das Frentes (novo)
    createPerformanceFrentesChart: function() {
        const ctx = document.getElementById('chart-performance-frentes');
        if (!ctx || !window.Chart) return;
        
        const frentes = DB.frentes.getAll();
        const metas = DB.metas.getAll();
        const lancamentos = DB.lancamentos.getAll();
        
        const dados = frentes.map(frente => {
            const metasFrente = metas.filter(m => m.frenteId === frente.id);
            const lancamentosFrente = lancamentos.filter(l => l.frenteId === frente.id);
            
            const totalMeta = metasFrente.reduce((sum, m) => sum + Number(m.valor), 0);
            const totalColhido = lancamentosFrente.reduce((sum, l) => sum + Number(l.colhido), 0);
            
            const percentual = totalMeta > 0 ? (totalColhido / totalMeta) * 100 : 0;
            
            return {
                nome: frente.nome,
                percentual: percentual,
                cor: frente.tipo === 'propria' ? '#3b82f6' : '#f97316'
            };
        }).sort((a, b) => b.percentual - a.percentual);
        
        if (dados.length === 0) {
            ctx.parentNode.innerHTML = '<div class="flex items-center justify-center h-80 text-gray-500">Sem dados para exibir</div>';
            return;
        }
        
        const data = {
            labels: dados.map(d => d.nome),
            datasets: [{
                data: dados.map(d => d.percentual),
                backgroundColor: dados.map(d => d.cor),
                borderWidth: 1,
                borderColor: '#ffffff'
            }]
        };
        
        AppConfig.charts.performanceFrentesChart = new Chart(ctx, {
            type: 'bar',
            data: data,
            options: {
                responsive: true,
                maintainAspectRatio: false,
                indexAxis: 'y',
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return `${context.parsed.x.toFixed(1)}% da meta`;
                            }
                        }
                    }
                },
                scales: {
                    x: {
                        beginAtZero: true,
                        max: 150,
                        ticks: {
                            callback: function(value) {
                                return value + '%';
                            }
                        }
                    }
                }
            }
        });
    },
    
    // Gráfico de Eficiência por Turno (novo)
    createEficienciaTurnoChart: function() {
        const ctx = document.getElementById('chart-eficiencia-turno');
        if (!ctx || !window.Chart) return;
        
        const lancamentos = DB.lancamentos.getAll();
        
        const eficienciaTurno = {
            manha: { total: 0, count: 0 },
            tarde: { total: 0, count: 0 },
            noite: { total: 0, count: 0 }
        };
        
        lancamentos.forEach(l => {
            if (eficienciaTurno[l.turno]) {
                eficienciaTurno[l.turno].total += Number(l.colhido);
                eficienciaTurno[l.turno].count++;
            }
        });
        
        const dados = Object.keys(eficienciaTurno).map(turno => {
            const media = eficienciaTurno[turno].count > 0 ? 
                eficienciaTurno[turno].total / eficienciaTurno[turno].count : 0;
            return {
                turno: turno.charAt(0).toUpperCase() + turno.slice(1),
                media: media
            };
        });
        const data = {
            labels: dados.map(d => d.turno),
            datasets: [{
                data: dados.map(d => d.media),
                backgroundColor: [
                    '#f59e0b', // Manhã
                    '#3b82f6', // Tarde
                    '#8b5cf6'  // Noite
                ],
                borderWidth: 2,
                borderColor: '#ffffff'
            }]
        };
        
       AppConfig.charts.eficienciaTurnoChart = new Chart(ctx, {
            type: 'doughnut',
            data: data,
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'bottom'
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return `${context.label}: ${Utils.formatarToneladas(context.parsed)}`;
                            }
                        }
                    }
                }
            }
        });
    },
    
    // Gráfico de Status das Liberações
    createLiberacoesStatusChart: function() {
        const ctx = document.getElementById('chart-liberacoes-status');
        if (!ctx || !window.Chart) return;
        
        const liberacoes = DB.liberacoes.getAll();
        const status = {};
        
        liberacoes.forEach(l => {
            status[l.status] = (status[l.status] || 0) + 1;
        });
        
        const cores = {
            'aberto': '#10b981',
            'fechado': '#3b82f6',
            'em-andamento': '#f59e0b',
            'cancelado': '#ef4444'
        };
        
        const data = {
            labels: Object.keys(status).map(s => Utils.getStatusConfig(s).texto),
            datasets: [{
                data: Object.values(status),
                backgroundColor: Object.keys(status).map(s => cores[s] || '#6b7280'),
                borderWidth: 1,
                borderColor: '#ffffff'
            }]
        };
        
        AppConfig.charts.liberacoesStatusChart = new Chart(ctx, {
            type: 'doughnut',
            data: data,
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'bottom'
                    }
                }
            }
        });
    },
    
    // Gráfico de Performance de Caminhões
    createCaminhoesPerformanceChart: function() {
        const ctx = document.getElementById('chart-caminhoes-performance');
        if (!ctx || !window.Chart) return;
        
        const caminhoes = DB.caminhoes.getAtivos();
        const metasCaminhoes = DB.metasCaminhoes.getAtivas();
        
        const dados = caminhoes.map(caminhao => {
            const metasCaminhao = metasCaminhoes.filter(m => m.caminhaoId === caminhao.id);
            const totalMetaViagens = metasCaminhao.reduce((sum, m) => sum + Number(m.metaViagens), 0);
            
            // Simular viagens realizadas (normalmente vem de outro módulo)
            const viagensRealizadas = Math.floor(totalMetaViagens * (0.8 + Math.random() * 0.4));
            const percentual = totalMetaViagens > 0 ? (viagensRealizadas / totalMetaViagens) * 100 : 0;
            
            return {
                placa: caminhao.placa,
                percentual: percentual,
                cor: caminhao.tipo === 'proprio' ? '#3b82f6' : '#f97316'
            };
        });
        
        if (dados.length === 0) {
            ctx.parentNode.innerHTML = '<div class="flex items-center justify-center h-48 text-gray-500">Sem dados para exibir</div>';
            return;
        }
        
        const data = {
            labels: dados.map(d => d.placa),
            datasets: [{
                data: dados.map(d => d.percentual),
                backgroundColor: dados.map(d => d.cor),
                borderWidth: 1,
                borderColor: '#ffffff'
            }]
        };
        
        AppConfig.charts.caminhoesPerformanceChart = new Chart(ctx, {
            type: 'bar',
            data: data,
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return `${context.parsed.y.toFixed(1)}% da meta`;
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 120,
                        ticks: {
                            callback: function(value) {
                                return value + '%';
                            }
                        }
                    }
                }
            }
        });
    },
    
    destroyChart: function(chartName) {
        if (AppConfig.charts[chartName]) {
            AppConfig.charts[chartName].destroy();
            delete AppConfig.charts[chartName];
        }
    },
    
    updateTheme: function() {
        if (window.Chart) {
            Chart.defaults.color = document.documentElement.classList.contains('dark') ? '#e5e7eb' : '#374151';
            Chart.defaults.borderColor = document.documentElement.classList.contains('dark') ? '#374151' : '#e5e7eb';
            Chart.defaults.backgroundColor = document.documentElement.classList.contains('dark') ? '#1f2937' : '#ffffff';
            
            Object.values(AppConfig.charts).forEach(chart => {
                if (chart && chart.update) {
                    chart.update();
                }
            });
        }
    }
};

// Funções principais da aplicação
const App = {
    init: function() {
        this.initDB();
        this.initTheme();
        this.initNavigation();
        this.initEventListeners();
        this.initForms();
        this.loadInitialData();
        this.initDateInputs();
        this.startAutoRefresh();
        
        Toast.show('Sistema GGOMES-LOG v2.1 Avançado carregado com sucesso!', 'success');
        NotificationManager.add('Sistema inicializado com sucesso', 'success');
    },
    
    initDB: function() {
        DB.init();
        NotificationManager.load();
    },
    
    // CORREÇÃO: Inicialização dos campos de data
    initDateInputs: function() {
        const hoje = Utils.getLocalDateString();
        
        // Definir data atual para campos de data padrão
        const dateInputs = [
            'liberacao-data',
            'lancamento-data',
            'meta-propria-data-inicio',
            'meta-propria-data-fim',
            'meta-terceira-data-inicio',
            'meta-terceira-data-fim',
            'meta-caminhao-proprio-data-inicio',
            'meta-caminhao-proprio-data-fim',
            'meta-caminhao-terceiro-data-inicio',
            'meta-caminhao-terceiro-data-fim'
        ];
        
        dateInputs.forEach(id => {
            const input = document.getElementById(id);
            if (input && !input.value) {
                input.value = hoje;
            }
        });
        
        // Atualizar data no cabeçalho
        document.getElementById('current-date').textContent = Utils.formatarData(hoje);
    },
    
    initTheme: function() {
        const config = JSON.parse(localStorage.getItem('ggomes_config') || '{}');
        const isDarkMode = config.temaEscuro !== undefined ? config.temaEscuro : 
            window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
        
        if (isDarkMode) {
            document.documentElement.classList.add('dark');
        } else {
            document.documentElement.classList.remove('dark');
        }
        
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (event.matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
            ChartManager.updateTheme();
        });
        
        ChartManager.init();
    },
    
    initNavigation: function() {
        const links = document.querySelectorAll('.sidebar-link');
        
        links.forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const href = link.getAttribute('href');
                if (href && href.startsWith('#')) {
                    this.navigateTo(href.substring(1));
                }
            });
        });
        
        // Mobile menu toggle
        const mobileToggle = document.getElementById('mobile-menu-toggle');
        const appContainer = document.getElementById('app-container');
        
        if (mobileToggle && appContainer) {
            mobileToggle.addEventListener('click', () => {
                appContainer.classList.toggle('sidebar-open');
            });
            
            // Fechar menu ao clicar fora
            appContainer.addEventListener('click', (e) => {
                if (appContainer.classList.contains('sidebar-open') && 
                    !e.target.closest('aside') && 
                    !e.target.closest('#mobile-menu-toggle')) {
                    appContainer.classList.remove('sidebar-open');
                }
            });
        }
    },
    
    navigateTo: function(page) {
        // Atualizar links ativos
        document.querySelectorAll('.sidebar-link').forEach(link => {
            link.classList.remove('active', 'bg-primary-100', 'dark:bg-primary-900', 'text-primary-700', 'dark:text-primary-300');
            link.classList.add('text-gray-700', 'dark:text-gray-300');
        });
        
        const activeLink = document.querySelector(`[href="#${page}"]`);
        if (activeLink) {
            activeLink.classList.add('active', 'bg-primary-100', 'dark:bg-primary-900', 'text-primary-700', 'dark:text-primary-300');
            activeLink.classList.remove('text-gray-700', 'dark:text-gray-300');
        }
        
        // Mostrar conteúdo
        document.querySelectorAll('.content').forEach(content => {
            content.classList.add('hidden');
        });
        
        const targetContent = document.getElementById(`content-${page}`);
        if (targetContent) {
            targetContent.classList.remove('hidden');
        }
        
        // Atualizar título da página
        const titles = {
            'dashboard': { title: 'Dashboard', subtitle: 'Visão geral do sistema e indicadores principais' },
            'liberacoes': { title: 'Liberações', subtitle: 'Gerenciamento completo de liberações de produção' },
            'metas': { title: 'Metas de Colheita', subtitle: 'Gestão de frentes e acompanhamento de metas' },
            'caminhoes': { title: 'Metas de Caminhões', subtitle: 'Gestão de frota e metas de transporte' },
            'configuracoes': { title: 'Configurações', subtitle: 'Configurações do sistema e gestão de dados' }
        };
        
        const pageInfo = titles[page] || { title: 'GGOMES-LOG', subtitle: 'Sistema de Gestão Agrícola' };
        document.getElementById('page-title').textContent = pageInfo.title;
        document.getElementById('page-subtitle').textContent = pageInfo.subtitle;
        
        // Fechar menu mobile se aberto
        document.getElementById('app-container').classList.remove('sidebar-open');
        
        // Executar ações específicas da página
        this.onPageLoad(page);
    },
    
    onPageLoad: function(page) {
        switch(page) {
            case 'dashboard':
                this.loadDashboard();
                break;
            case 'liberacoes':
                this.loadLiberacoes();
                break;
            case 'metas':
                this.loadMetas();
                this.loadFrente();
                break;
            case 'caminhoes':
                this.loadCaminhoes();
                break;
            case 'configuracoes':
                break;
        }
    },
    
    loadDashboard: function() {
        setTimeout(() => {
            this.updateDashboardKPIs();
            ChartManager.createEvolucaoColheitaChart();
            ChartManager.createPerformanceFrentesChart();
            ChartManager.createLiberacoesStatusChart();
            ChartManager.createCaminhoesPerformanceChart();
            ChartManager.createEficienciaTurnoChart();
            this.updateDashboardTables();
        }, 100);
    },
    
    updateDashboardKPIs: function() {
        try {
            const liberacoes = DB.liberacoes.getAll();
            const frentes = DB.frentes.getAll();
            const caminhoes = DB.caminhoes.getAll();
            const lancamentos = DB.lancamentos.getAll();
            const metas = DB.metas.getAll();
            
            // Total Colhido (últimos 30 dias)
            const hoje = new Date();
            const dataInicial = new Date(hoje.getTime() - 30 * 24 * 60 * 60 * 1000);
            const dataInicialStr = Utils.formatDateForInput(dataInicial);
            const hojeStr = Utils.formatDateForInput(hoje);
            
            const totalColhido = lancamentos
                .filter(l => l.data >= dataInicialStr && l.data <= hojeStr)
                .reduce((sum, l) => sum + Number(l.colhido), 0);
            
            const totalMeta = metas
                .filter(m => m.dataInicio <= hojeStr && m.dataFim >= dataInicialStr)
                .reduce((sum, m) => sum + Number(m.valor), 0);
            
            document.getElementById('dash-total-colhido').textContent = Utils.formatarToneladas(totalColhido);
            document.getElementById('dash-colhido-meta').textContent = `Meta: ${Utils.formatarToneladas(totalMeta)}`;
            
            // Frentes Ativas
            const frentesAtivas = frentes.filter(f => f.status === 'ativa');
            const frentesProprias = frentesAtivas.filter(f => f.tipo === 'propria').length;
            const frentesTerceiras = frentesAtivas.filter(f => f.tipo === 'terceira').length;
            
            document.getElementById('dash-frentes-ativas').textContent = `${frentesAtivas.length}/${frentes.length}`;
            document.getElementById('dash-frentes-info').textContent = `${frentesProprias} Próprias + ${frentesTerceiras} Terceiras`;
            
            // Caminhões Ativos
            const caminhoesAtivos = caminhoes.filter(c => c.status === 'ativo');
            const caminhoesProprios = caminhoesAtivos.filter(c => c.tipo === 'proprio').length;
            const caminhoesTerceiros = caminhoesAtivos.filter(c => c.tipo === 'terceiro').length;
            
            document.getElementById('dash-caminhoes-ativos').textContent = `${caminhoesAtivos.length}/${caminhoes.length}`;
            document.getElementById('dash-caminhoes-info').textContent = `${caminhoesProprios} Próprios + ${caminhoesTerceiros} Terceiros`;
            
            // Liberações
            const liberacoesAbertas = liberacoes.filter(l => l.status === 'aberto' || l.status === 'em-andamento').length;
            document.getElementById('dash-total-liberacoes').textContent = liberacoesAbertas;
            
            // Metas Atingidas
            const metasAtingidas = this.calcularMetasAtingidas();
            document.getElementById('dash-metas-atingidas').textContent = `${metasAtingidas.atingidas}/${metasAtingidas.total}`;
            document.getElementById('dash-metas-progresso').textContent = `${metasAtingidas.percentual}%`;
            
            // Eficiência Geral
            const eficiencia = totalMeta > 0 ? Math.min(100, (totalColhido / totalMeta) * 100) : 0;
            document.getElementById('dash-eficiencia-geral').textContent = `${eficiencia.toFixed(0)}%`;
            
        } catch (error) {
            console.error('Erro ao atualizar KPIs do dashboard:', error);
        }
    },
    
    calcularMetasAtingidas: function() {
        const metas = DB.metas.getAtivas();
        const lancamentos = DB.lancamentos.getAll();
        const hoje = Utils.getLocalDateString();
        
        let atingidas = 0;
        let total = metas.length;
        
        metas.forEach(meta => {
            const totalColhido = DB.lancamentos.getTotalColhidoPorFrente(
                meta.frenteId, 
                meta.dataInicio, 
                meta.dataFim
            );
            
            if (totalColhido >= Number(meta.valor)) {
                atingidas++;
            }
        });
        
        const percentual = total > 0 ? Math.round((atingidas / total) * 100) : 0;
        
        return { atingidas, total, percentual };
    },
    
    updateDashboardTables: function() {
        this.updateTopPerformance();
        this.updateAtividadeRecente();
    },
    
    updateTopPerformance: function() {
        const container = document.getElementById('dash-top-frentes');
        if (!container) return;
        
        const frentes = DB.frentes.getAll();
        const metas = DB.metas.getAll();
        const lancamentos = DB.lancamentos.getAll();
        
        const performance = frentes.map(frente => {
            const metasFrente = metas.filter(m => m.frenteId === frente.id);
            const lancamentosFrente = lancamentos.filter(l => l.frenteId === frente.id);
            
            const totalMeta = metasFrente.reduce((sum, m) => sum + Number(m.valor), 0);
            const totalColhido = lancamentosFrente.reduce((sum, l) => sum + Number(l.colhido), 0);
            
            const percentual = totalMeta > 0 ? (totalColhido / totalMeta) * 100 : 0;
            
            return {
                frente,
                percentual,
                totalColhido,
                totalMeta
            };
        }).sort((a, b) => b.percentual - a.percentual).slice(0, 5);
        
        container.innerHTML = performance.map((item, index) => {
            const medal = index === 0 ? '🥇' : index === 1 ? '🥈' : index === 2 ? '🥉' : `${index + 1}º`;
            const tipoConfig = Utils.getTipoConfig(item.frente.tipo);
            
            return `
                <div class="flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg">
                    <div class="flex items-center">
                        <span class="text-lg mr-3">${medal}</span>
                        <div>
                            <div class="font-medium text-gray-900 dark:text-white">${item.frente.nome}</div>
                            <div class="text-sm text-gray-500 dark:text-gray-400">
                                <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${tipoConfig.bg} ${tipoConfig.text}">
                                    <i class="fas ${tipoConfig.icon} mr-1"></i>
                                    ${tipoConfig.texto}
                                </span>
                            </div>
                        </div>
                    </div>
                    <div class="text-right">
                        <div class="font-bold text-green-600 dark:text-green-400">${item.percentual.toFixed(1)}%</div>
                        <div class="text-xs text-gray-500 dark:text-gray-400">${Utils.formatarToneladas(item.totalColhido)}</div>
                    </div>
                </div>
            `;
        }).join('');
    },
    
    updateAtividadeRecente: function() {
        const container = document.getElementById('dash-atividade-recente');
        if (!container) return;
        
        const lancamentos = DB.lancamentos.getAll()
            .sort((a, b) => new Date(b.dataRegistro) - new Date(a.dataRegistro))
            .slice(0, 10);
        
        if (lancamentos.length === 0) {
            container.innerHTML = '<div class="text-center text-gray-500 dark:text-gray-400 py-4">Nenhuma atividade recente</div>';
            return;
        }
        
        container.innerHTML = lancamentos.map(lancamento => {
            const frente = DB.frentes.get(lancamento.frenteId);
            const tempoAtras = this.getTempoAtras(lancamento.dataRegistro);
            
            return `
                <div class="flex items-center space-x-3 p-3 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-lg transition-colors">
                    <div class="flex-shrink-0">
                        <div class="h-8 w-8 rounded-full bg-green-100 dark:bg-green-900 flex items-center justify-center">
                            <i class="fas fa-seedling text-green-600 dark:text-green-400 text-sm"></i>
                        </div>
                    </div>
                    <div class="flex-1 min-w-0">
                        <div class="text-sm font-medium text-gray-900 dark:text-white">
                            ${frente ? frente.nome : 'Frente não encontrada'}
                        </div>
                        <div class="text-sm text-gray-500 dark:text-gray-400">
                            Colhido: ${Utils.formatarToneladas(lancamento.colhido)} - ${lancamento.turno}
                        </div>
                    </div>
                    <div class="text-xs text-gray-400 dark:text-gray-500">
                        ${tempoAtras}
                    </div>
                </div>
            `;
        }).join('');
    },
    
    getTempoAtras: function(dataISO) {
        const agora = new Date();
        const data = new Date(dataISO);
        const diffMs = agora - data;
        const diffMinutos = Math.floor(diffMs / (1000 * 60));
        const diffHoras = Math.floor(diffMs / (1000 * 60 * 60));
        const diffDias = Math.floor(diffMs / (1000 * 60 * 60 * 24));
        
        if (diffMinutos < 60) {
            return `${diffMinutos}min`;
        } else if (diffHoras < 24) {
            return `${diffHoras}h`;
        } else {
            return `${diffDias}d`;
        }
    },
    
    initEventListeners: function() {
        // Toggle de tema
        document.getElementById('toggle-theme').addEventListener('click', () => {
            document.documentElement.classList.toggle('dark');
            const isDark = document.documentElement.classList.contains('dark');
            
            const config = JSON.parse(localStorage.getItem('ggomes_config') || '{}');
            config.temaEscuro = isDark;
            localStorage.setItem('ggomes_config', JSON.stringify(config));
            
            ChartManager.updateTheme();
        });
        
        // Notificações
        document.getElementById('btn-notifications').addEventListener('click', () => {
            this.showNotifications();
        });
        
        // Refresh dashboard
        document.getElementById('btn-refresh-dashboard').addEventListener('click', () => {
            this.loadDashboard();
            Toast.show('Dashboard atualizado', 'success');
        });
        
        // Auto-refresh toggle
        document.getElementById('btn-auto-refresh-acompanhamento').addEventListener('click', () => {
            this.toggleAutoRefresh();
        });
        
        // Configurações
        this.initConfigEventListeners();
        
        // Abas
        this.initTabEventListeners();
        
        // Formulários
        this.initFormEventListeners();
    },
    
    showNotifications: function() {
        const modal = document.getElementById('modal-notifications');
        const list = document.getElementById('notifications-list');
        
        if (AppConfig.notifications.length === 0) {
            list.innerHTML = '<div class="text-center text-gray-500 dark:text-gray-400 py-4">Nenhuma notificação</div>';
        } else {
            list.innerHTML = AppConfig.notifications.map(notification => `
                <div class="flex items-start space-x-3 p-3 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-lg transition-colors ${notification.read ? 'opacity-60' : ''}">
                    <div class="flex-shrink-0">
                        <div class="h-8 w-8 rounded-full bg-blue-100 dark:bg-blue-900 flex items-center justify-center">
                            <i class="fas fa-bell text-blue-600 dark:text-blue-400 text-sm"></i>
                        </div>
                    </div>
                    <div class="flex-1 min-w-0">
                        <div class="text-sm font-medium text-gray-900 dark:text-white">
                            ${notification.message}
                        </div>
                        <div class="text-xs text-gray-500 dark:text-gray-400">
                            ${Utils.formatarDataHora(notification.timestamp)}
                        </div>
                    </div>
                </div>
            `).join('');
        }
        
        modal.classList.remove('hidden');
        NotificationManager.markAllAsRead();
    },
    
    toggleAutoRefresh: function() {
        AppConfig.autoRefresh = !AppConfig.autoRefresh;
        const btn = document.getElementById('btn-auto-refresh-acompanhamento');
        
        if (AppConfig.autoRefresh) {
            btn.classList.add('bg-green-600', 'hover:bg-green-700');
            btn.classList.remove('bg-blue-600', 'hover:bg-blue-700');
            this.startAutoRefresh();
            Toast.show('Auto-refresh ativado', 'success');
        } else {
            btn.classList.remove('bg-green-600', 'hover:bg-green-700');
            btn.classList.add('bg-blue-600', 'hover:bg-blue-700');
            this.stopAutoRefresh();
            Toast.show('Auto-refresh desativado', 'info');
        }
    },
    
    startAutoRefresh: function() {
        if (AppConfig.refreshInterval) {
            clearInterval(AppConfig.refreshInterval);
        }
        
        if (AppConfig.autoRefresh) {
            AppConfig.refreshInterval = setInterval(() => {
                const currentContent = document.querySelector('.content:not(.hidden)');
                if (currentContent && currentContent.id === 'content-metas') {
                    // Só atualiza se estiver na aba de metas
                    const activeTab = document.querySelector('.tab-content:not(.hidden)');
                    if (activeTab && activeTab.id === 'tab-acompanhamento') {
                        this.loadAcompanhamento();
                    }
                }
            }, 30000); // 30 segundos
        }
    },
    
    stopAutoRefresh: function() {
        if (AppConfig.refreshInterval) {
            clearInterval(AppConfig.refreshInterval);
            AppConfig.refreshInterval = null;
        }
    },
    
    initConfigEventListeners: function() {
        // Exportar JSON
        document.getElementById('btn-exportar-json').addEventListener('click', () => {
            try {
                const data = DB.exportData();
                const blob = new Blob([data], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `ggomes-backup-${new Date().toISOString().split('T')[0]}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                Toast.show('Backup exportado com sucesso', 'success');
                NotificationManager.add('Backup de dados exportado', 'success');
            } catch (error) {
                Toast.show('Erro ao exportar backup: ' + error.message, 'error');
            }
        });
        
        // Importar JSON
        document.getElementById('btn-importar-json').addEventListener('click', () => {
            document.getElementById('import-json-file').click();
        });
        
        document.getElementById('import-json-file').addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    DB.importData(e.target.result);
                    Toast.show('Dados importados com sucesso', 'success');
                    NotificationManager.add('Backup de dados importado', 'success');
                    
                    // Recarregar a página atual
                    const currentPage = document.querySelector('.sidebar-link.active')?.getAttribute('href')?.substring(1) || 'dashboard';
                    this.navigateTo(currentPage);
                } catch (error) {
                    Toast.show('Erro ao importar dados: ' + error.message, 'error');
                }
            };
            reader.readAsText(file);
            
            // Limpar o input
            e.target.value = '';
        });
        
        // Limpar dados
        document.getElementById('btn-limpar-dados').addEventListener('click', () => {
            document.getElementById('modal-limpar-dados').classList.remove('hidden');
        });
        
        document.getElementById('btn-cancelar-limpar').addEventListener('click', () => {
            document.getElementById('modal-limpar-dados').classList.add('hidden');
            document.getElementById('confirmacao-texto').value = '';
            document.getElementById('btn-confirmar-limpar').disabled = true;
            document.getElementById('btn-confirmar-limpar').classList.add('opacity-50', 'cursor-not-allowed');
        });
        
        document.getElementById('confirmacao-texto').addEventListener('input', (e) => {
            const btn = document.getElementById('btn-confirmar-limpar');
            if (e.target.value === 'CONFIRMAR') {
                btn.disabled = false;
                btn.classList.remove('opacity-50', 'cursor-not-allowed');
            } else {
                btn.disabled = true;
                btn.classList.add('opacity-50', 'cursor-not-allowed');
            }
        });
        
        document.getElementById('btn-confirmar-limpar').addEventListener('click', () => {
            if (DB.clearAll()) {
                Toast.show('Todos os dados foram removidos', 'success');
                NotificationManager.add('Dados do sistema limpos', 'warning');
                document.getElementById('modal-limpar-dados').classList.add('hidden');
                this.navigateTo('dashboard');
            } else {
                Toast.show('Erro ao limpar dados', 'error');
            }
        });
        
        // Fechar modal de notificações
        document.getElementById('btn-close-notifications').addEventListener('click', () => {
            document.getElementById('modal-notifications').classList.add('hidden');
        });
        
        document.getElementById('btn-clear-notifications').addEventListener('click', () => {
            NotificationManager.clear();
            document.getElementById('modal-notifications').classList.add('hidden');
            Toast.show('Notificações removidas', 'success');
        });
        
        // Relatórios
        document.getElementById('btn-relatorio-liberacoes').addEventListener('click', () => {
            this.gerarRelatorioLiberacoes();
        });
        
        document.getElementById('btn-relatorio-metas').addEventListener('click', () => {
            this.gerarRelatorioMetas();
        });
        
        document.getElementById('btn-relatorio-colheita').addEventListener('click', () => {
            this.gerarRelatorioColheita();
        });
        
        document.getElementById('btn-relatorio-caminhoes').addEventListener('click', () => {
            this.gerarRelatorioCaminhoes();
        });
    },
    
    initTabEventListeners: function() {
        // Abas de Metas
        document.querySelectorAll('.tab-button').forEach(button => {
            button.addEventListener('click', () => {
                const tab = button.getAttribute('data-tab');
                this.switchTab(tab, 'tab-button', 'tab-content');
            });
        });
        
        // Abas de Caminhões
        document.querySelectorAll('.tab-caminhao-button').forEach(button => {
            button.addEventListener('click', () => {
                const tab = button.getAttribute('data-tab');
                this.switchTab(tab, 'tab-caminhao-button', 'tab-caminhao-content');
            });
        });
    },
    
    switchTab: function(targetTab, buttonClass, contentClass) {
        // Remover active de todos os botões
        document.querySelectorAll(`.${buttonClass}`).forEach(btn => {
            btn.classList.remove('active', 'border-primary-500', 'text-primary-600', 'dark:text-primary-400');
            btn.classList.add('border-transparent', 'text-gray-500', 'dark:text-gray-400');
        });
        
        // Adicionar active ao botão clicado
        const activeButton = document.querySelector(`[data-tab="${targetTab}"]`);
        if (activeButton) {
            activeButton.classList.add('active', 'border-primary-500', 'text-primary-600', 'dark:text-primary-400');
            activeButton.classList.remove('border-transparent', 'text-gray-500', 'dark:text-gray-400');
        }
        
        // Esconder todos os conteúdos
        document.querySelectorAll(`.${contentClass}`).forEach(content => {
            content.classList.add('hidden');
        });
        
        // Mostrar conteúdo ativo
        const activeContent = document.getElementById(`tab-${targetTab}`);
        if (activeContent) {
            activeContent.classList.remove('hidden');
        }
        
        // Executar ações específicas da aba
        this.onTabLoad(targetTab);
    },
    
    onTabLoad: function(tab) {
        switch(tab) {
            case 'frentes':
                this.loadFrente();
                break;
            case 'metas-proprias':
                this.loadMetasProprias();
                break;
            case 'metas-terceiras':
                this.loadMetasTerceiras();
                break;
            case 'diario':
                this.loadLancamentos();
                break;
            case 'acompanhamento':
                this.loadAcompanhamento();
                break;
            case 'cadastro-caminhoes':
                this.loadCaminhoes();
                break;
            case 'metas-caminhoes-proprios':
                this.loadMetasCaminhoesProprios();
                break;
            case 'metas-caminhoes-terceiros':
                this.loadMetasCaminhoesTerceiros();
                break;
            case 'acompanhamento-caminhoes':
                this.loadAcompanhamentoCaminhoes();
                break;
        }
    },
    
    initForms: function() {
        this.initFormLiberacao();
        this.initFormFrente();
        this.initFormMetaPropria();
        this.initFormMetaTerceira();
        this.initFormLancamento();
        this.initFormCaminhao();
        this.initFormMetaCaminhaoProprio();
        this.initFormMetaCaminhaoTerceiro();
    },
    
    initFormEventListeners: function() {
        // Refresh buttons
        const refreshButtons = [
            'btn-refresh-liberacoes',
            'btn-refresh-frentes',
            'btn-refresh-metas-proprias', 
            'btn-refresh-metas-terceiras',
            'btn-refresh-lancamentos',
            'btn-refresh-acompanhamento',
            'btn-refresh-caminhoes',
            'btn-refresh-metas-caminhoes-proprios',
            'btn-refresh-metas-caminhoes-terceiros',
            'btn-refresh-acompanhamento-caminhoes'
        ];
        
        refreshButtons.forEach(btnId => {
            const btn = document.getElementById(btnId);
            if (btn) {
                btn.addEventListener('click', () => {
                    const action = btnId.replace('btn-refresh-', '');
                    this.refreshData(action);
                });
            }
        });
        
        // Export buttons
        document.getElementById('btn-export-liberacoes').addEventListener('click', () => {
            this.exportarLiberacoes();
        });
        
        document.getElementById('btn-exportar-acompanhamento').addEventListener('click', () => {
            this.exportarAcompanhamento();
        });
        
        document.getElementById('btn-exportar-caminhoes').addEventListener('click', () => {
            this.exportarCaminhoes();
        });
        
        // Filtros de acompanhamento
        document.getElementById('btn-aplicar-filtro-acompanhamento').addEventListener('click', () => {
            this.aplicarFiltrosAcompanhamento();
        });
        
        document.getElementById('btn-limpar-filtro-acompanhamento').addEventListener('click', () => {
            this.limparFiltrosAcompanhamento();
        });
        
        // Clear filters
        document.getElementById('btn-clear-filters').addEventListener('click', () => {
            this.clearLiberacaoFilters();
        });
    },
    
    refreshData: function(type) {
        const refreshActions = {
            'liberacoes': () => this.loadLiberacoes(),
            'frentes': () => this.loadFrente(),
            'metas-proprias': () => this.loadMetasProprias(),
            'metas-terceiras': () => this.loadMetasTerceiras(),
            'lancamentos': () => this.loadLancamentos(),
            'acompanhamento': () => this.loadAcompanhamento(),
            'caminhoes': () => this.loadCaminhoes(),
            'metas-caminhoes-proprios': () => this.loadMetasCaminhoesProprios(),
            'metas-caminhoes-terceiros': () => this.loadMetasCaminhoesTerceiros(),
            'acompanhamento-caminhoes': () => this.loadAcompanhamentoCaminhoes()
        };
        
        if (refreshActions[type]) {
            refreshActions[type]();
            Toast.show('Dados atualizados', 'success');
        }
    },
    
    loadInitialData: function() {
        this.navigateTo('dashboard');
    },
    
    // ===== MÓDULO LIBERAÇÕES =====
    
    initFormLiberacao: function() {
        const form = document.getElementById('form-liberacao');
        
        form.addEventListener('submit', (e) => {
            e.preventDefault();
            this.saveLiberacao();
        });
        
        document.getElementById('btn-cancel-liberacao').addEventListener('click', () => {
            this.clearLiberacaoForm();
        });
        
        document.getElementById('btn-clear-form-liberacao').addEventListener('click', () => {
            this.clearLiberacaoForm();
        });
        
        // Search e filtros
        const searchInput = document.getElementById('search-liberacoes');
        if (searchInput) {
            searchInput.addEventListener('input', Utils.debounce(() => {
                this.filterLiberacoes();
            }, 300));
        }
        
        const filtros = ['filtro-liberacao-frente', 'filtro-liberacao-fazenda', 'filtro-liberacao-status'];
        filtros.forEach(filtroId => {
            const filtro = document.getElementById(filtroId);
            if (filtro) {
                filtro.addEventListener('change', () => {
                    this.filterLiberacoes();
                });
            }
        });
    },
    
    loadLiberacoes: function() {
        this.loadLiberacoesTable();
        this.updateLiberacoesFilters();
        this.updateLiberacoesResumo();
    },
    
    loadLiberacoesTable: function(page = 1) {
        const searchTerm = document.getElementById('search-liberacoes').value;
        const filters = {
            frente: document.getElementById('filtro-liberacao-frente').value,
            fazenda: document.getElementById('filtro-liberacao-fazenda').value,
            status: document.getElementById('filtro-liberacao-status').value
        };
        
        const liberacoes = DB.liberacoes.search(searchTerm, filters);
        const paginatedData = DB.liberacoes.paginate(liberacoes, page, AppConfig.pagination.itemsPerPage);
        
        this.renderLiberacoesTable(paginatedData.data);
        this.renderLiberacoesPagination(paginatedData);
        
        document.getElementById('results-count').textContent = `${paginatedData.totalItems} resultado${paginatedData.totalItems !== 1 ? 's' : ''}`;
    },
    
    renderLiberacoesTable: function(liberacoes) {
        const tbody = document.getElementById('tabela-liberacoes');
        
        if (liberacoes.length === 0) {
            tbody.innerHTML = `
                <tr>
                    <td colspan="9" class="px-4 py-8 text-center text-gray-500 dark:text-gray-400">
                        <i class="fas fa-search mb-2 text-2xl"></i>
                        <div>Nenhuma liberação encontrada</div>
                    </td>
                </tr>
            `;
            return;
        }
        
        tbody.innerHTML = liberacoes.map(liberacao => {
            const statusConfig = Utils.getStatusConfig(liberacao.status);
            const restante = Number(liberacao.previsto) - Number(liberacao.realizado);
            const progresso = Number(liberacao.previsto) > 0 ? 
                (Number(liberacao.realizado) / Number(liberacao.previsto)) * 100 : 0;
            
            let progressoClass = 'bg-red-500';
            if (progresso >= 80) progressoClass = 'bg-green-500';
            else if (progresso >= 50) progressoClass = 'bg-yellow-500';
            
            return `
                <tr class="hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                    <td class="px-4 py-3 text-sm font-medium text-gray-900 dark:text-white">${liberacao.frente}</td>
                    <td class="px-4 py-3 text-sm text-gray-700 dark:text-gray-300">${liberacao.fazenda}</td>
                    <td class="px-4 py-3 text-sm text-gray-700 dark:text-gray-300">${liberacao.numero || '--'}</td>
                    <td class="px-4 py-3 text-center">
                        <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${statusConfig.bg} ${statusConfig.text}">
                            <i class="fas ${statusConfig.icon} mr-1"></i>
                            ${statusConfig.texto}
                        </span>
                    </td>
                    <td class="px-4 py-3 text-right text-sm font-medium text-gray-900 dark:text-white">${Utils.formatarToneladas(liberacao.previsto)}</td>
                    <td class="px-4 py-3 text-right text-sm font-medium text-green-600 dark:text-green-400">${Utils.formatarToneladas(liberacao.realizado)}</td>
                    <td class="px-4 py-3 text-right text-sm font-medium text-red-600 dark:text-red-400">${Utils.formatarToneladas(restante)}</td>
                    <td class="px-4 py-3 text-center">
                        <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">
                            <div class="h-2 rounded-full ${progressoClass} transition-all-300" style="width: ${Math.min(progresso, 100)}%"></div>
                        </div>
                        <span class="text-xs text-gray-500 dark:text-gray-400 mt-1">${progresso.toFixed(1)}%</span>
                    </td>
                    <td class="px-4 py-3 text-center">
                        <div class="flex items-center justify-center space-x-2">
                            <button onclick="App.editLiberacao('${liberacao.id}')" class="text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 transition-colors" title="Editar">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button onclick="App.deleteLiberacao('${liberacao.id}')" class="text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300 transition-colors" title="Excluir">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                </tr>
            `;
        }).join('');
    },
    
    renderLiberacoesPagination: function(paginationData) {
        const container = document.getElementById('pagination-liberacoes');
        
        if (paginationData.totalPages <= 1) {
            container.innerHTML = '';
            return;
        }
        
        const pagination = this.createPagination(paginationData, (page) => {
            this.loadLiberacoesTable(page);
        });
        
        container.innerHTML = pagination;
    },
    
    createPagination: function(data, onPageClick) {
        const { currentPage, totalPages, totalItems, itemsPerPage } = data;
        
        let pagination = `
            <div class="flex items-center justify-between">
                <div class="flex-1 flex justify-between sm:hidden">
                    <button ${currentPage === 1 ? 'disabled' : ''} onclick="(${onPageClick})(${currentPage - 1})" 
                            class="relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 dark:bg-gray-800 dark:border-gray-600 dark:text-gray-300 dark:hover:bg-gray-700 transition-colors ${currentPage === 1 ? 'opacity-50 cursor-not-allowed' : ''}">
                        Anterior
                    </button>
                    <button ${currentPage === totalPages ? 'disabled' : ''} onclick="(${onPageClick})(${currentPage + 1})" 
                            class="ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 dark:bg-gray-800 dark:border-gray-600 dark:text-gray-300 dark:hover:bg-gray-700 transition-colors ${currentPage === totalPages ? 'opacity-50 cursor-not-allowed' : ''}">
                        Próximo
                    </button>
                </div>
                <div class="hidden sm:flex-1 sm:flex sm:items-center sm:justify-between">
                    <div>
                        <p class="text-sm text-gray-700 dark:text-gray-300">
                            Mostrando <span class="font-medium">${((currentPage - 1) * itemsPerPage) + 1}</span> a 
                            <span class="font-medium">${Math.min(currentPage * itemsPerPage, totalItems)}</span> de 
                            <span class="font-medium">${totalItems}</span> resultados
                        </p>
                    </div>
                    <div>
                        <nav class="relative z-0 inline-flex rounded-md shadow-sm -space-x-px">
        `;
        
        // Botão Anterior
        pagination += `
            <button ${currentPage === 1 ? 'disabled' : ''} onclick="(${onPageClick})(${currentPage - 1})"
                    class="relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 dark:bg-gray-800 dark:border-gray-600 dark:text-gray-400 dark:hover:bg-gray-700 transition-colors ${currentPage === 1 ? 'opacity-50 cursor-not-allowed' : ''}">
                <i class="fas fa-chevron-left"></i>
            </button>
        `;
        
        // Páginas
        const startPage = Math.max(1, currentPage - 2);
        const endPage = Math.min(totalPages, currentPage + 2);
        
        if (startPage > 1) {
            pagination += `
                <button onclick="(${onPageClick})(1)" class="relative inline-flex items-center px-4 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-700 hover:bg-gray-50 dark:bg-gray-800 dark:border-gray-600 dark:text-gray-300 dark:hover:bg-gray-700 transition-colors">1</button>
            `;
            if (startPage > 2) {
                pagination += `<span class="relative inline-flex items-center px-4 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-700 dark:bg-gray-800 dark:border-gray-600 dark:text-gray-300">...</span>`;
            }
        }
        
        for (let i = startPage; i <= endPage; i++) {
            const isActive = i === currentPage;
            pagination += `
                <button onclick="(${onPageClick})(${i})" 
                        class="relative inline-flex items-center px-4 py-2 border text-sm font-medium transition-colors
                        ${isActive ? 
                            'z-10 bg-primary-50 dark:bg-primary-900 border-primary-500 text-primary-600 dark:text-primary-400' : 
                            'border-gray-300 bg-white text-gray-700 hover:bg-gray-50 dark:bg-gray-800 dark:border-gray-600 dark:text-gray-300 dark:hover:bg-gray-700'
                        }">
                    ${i}
                </button>
            `;
        }
        
        if (endPage < totalPages) {
            if (endPage < totalPages - 1) {
                pagination += `<span class="relative inline-flex items-center px-4 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-700 dark:bg-gray-800 dark:border-gray-600 dark:text-gray-300">...</span>`;
            }
            pagination += `
                <button onclick="(${onPageClick})(${totalPages})" class="relative inline-flex items-center px-4 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-700 hover:bg-gray-50 dark:bg-gray-800 dark:border-gray-600 dark:text-gray-300 dark:hover:bg-gray-700 transition-colors">${totalPages}</button>
            `;
        }
        
        // Botão Próximo
        pagination += `
            <button ${currentPage === totalPages ? 'disabled' : ''} onclick="(${onPageClick})(${currentPage + 1})"
                    class="relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 dark:bg-gray-800 dark:border-gray-600 dark:text-gray-400 dark:hover:bg-gray-700 transition-colors ${currentPage === totalPages ? 'opacity-50 cursor-not-allowed' : ''}">
                <i class="fas fa-chevron-right"></i>
            </button>
        `;
        
        pagination += `
                        </nav>
                    </div>
                </div>
            </div>
        `;
        
        return pagination;
    },
    
    updateLiberacoesFilters: function() {
        const uniqueValues = DB.liberacoes.getUniqueValues();
        
        // Atualizar filtro de frentes
        const filtroFrente = document.getElementById('filtro-liberacao-frente');
        const currentFrente = filtroFrente.value;
        filtroFrente.innerHTML = '<option value="">Todas</option>' + 
            uniqueValues.frentes.map(frente => `<option value="${frente}">${frente}</option>`).join('');
        filtroFrente.value = currentFrente;
        
        // Atualizar filtro de fazendas
        const filtroFazenda = document.getElementById('filtro-liberacao-fazenda');
        const currentFazenda = filtroFazenda.value;
        filtroFazenda.innerHTML = '<option value="">Todas</option>' + 
            uniqueValues.fazendas.map(fazenda => `<option value="${fazenda}">${fazenda}</option>`).join('');
        filtroFazenda.value = currentFazenda;
    },
    
    updateLiberacoesResumo: function() {
        const searchTerm = document.getElementById('search-liberacoes').value;
        const filters = {
            frente: document.getElementById('filtro-liberacao-frente').value,
            fazenda: document.getElementById('filtro-liberacao-fazenda').value,
            status: document.getElementById('filtro-liberacao-status').value
        };
        
        const totals = DB.liberacoes.getTotals(filters.frente, filters.fazenda, filters.status);
        
        document.getElementById('resumo-total-previsto').textContent = Utils.formatarToneladas(totals.previsto);
        document.getElementById('resumo-total-realizado').textContent = Utils.formatarToneladas(totals.realizado);
        document.getElementById('resumo-total-restante').textContent = Utils.formatarToneladas(totals.restante);
        document.getElementById('resumo-status-aberto').textContent = totals.statusAberto;
        document.getElementById('resumo-status-fechado').textContent = totals.statusFechado;
        document.getElementById('resumo-total-geral').textContent = totals.count;
    },
    
    filterLiberacoes: function() {
        this.loadLiberacoesTable(1);
        this.updateLiberacoesResumo();
    },
    
    clearLiberacaoFilters: function() {
        document.getElementById('search-liberacoes').value = '';
        document.getElementById('filtro-liberacao-frente').value = '';
        document.getElementById('filtro-liberacao-fazenda').value = '';
        document.getElementById('filtro-liberacao-status').value = '';
        
        this.filterLiberacoes();
        Toast.show('Filtros limpos', 'info');
    },
    
    saveLiberacao: function() {
        const form = document.getElementById('form-liberacao');
        
        if (!Utils.validateForm(form)) {
            Toast.show('Por favor, preencha todos os campos obrigatórios', 'error');
            return;
        }
        
        const formData = new FormData(form);
        const liberacao = {
            frente: document.getElementById('liberacao-frente').value.trim(),
            fazenda: document.getElementById('liberacao-fazenda').value.trim(),
            numero: document.getElementById('liberacao-numero').value.trim(),
            status: document.getElementById('liberacao-status').value,
            previsto: parseFloat(document.getElementById('liberacao-previsto').value),
            realizado: parseFloat(document.getElementById('liberacao-realizado').value),
            data: document.getElementById('liberacao-data').value,
            observacoes: document.getElementById('liberacao-observacoes').value.trim()
        };
        
        try {
            const editId = form.getAttribute('data-edit-id');
            
            if (editId) {
                liberacao.id = editId;
                DB.liberacoes.update(liberacao);
                Toast.show('Liberação atualizada com sucesso', 'success');
                NotificationManager.add(`Liberação ${liberacao.numero || liberacao.frente} atualizada`, 'info');
            } else {
                DB.liberacoes.add(liberacao);
                Toast.show('Liberação cadastrada com sucesso', 'success');
                NotificationManager.add(`Nova liberação ${liberacao.numero || liberacao.frente} cadastrada`, 'success');
            }
            
            this.clearLiberacaoForm();
            this.loadLiberacoes();
            
        } catch (error) {
            console.error('Erro ao salvar liberação:', error);
            Toast.show('Erro ao salvar liberação: ' + error.message, 'error');
        }
    },
    
    clearLiberacaoForm: function() {
        const form = document.getElementById('form-liberacao');
        form.reset();
        form.removeAttribute('data-edit-id');
        
        const hoje = Utils.getLocalDateString();
        document.getElementById('liberacao-data').value = hoje;
        
        document.getElementById('btn-submit-text').textContent = 'Salvar Liberação';
        Utils.clearFormValidation(form);
    },
    
    editLiberacao: function(id) {
        const liberacao = DB.liberacoes.get(id);
        if (!liberacao) {
            Toast.show('Liberação não encontrada', 'error');
            return;
        }
        
        document.getElementById('liberacao-frente').value = liberacao.frente;
        document.getElementById('liberacao-fazenda').value = liberacao.fazenda;
        document.getElementById('liberacao-numero').value = liberacao.numero || '';
        document.getElementById('liberacao-status').value = liberacao.status;
        document.getElementById('liberacao-previsto').value = liberacao.previsto;
        document.getElementById('liberacao-realizado').value = liberacao.realizado;
        document.getElementById('liberacao-data').value = liberacao.data;
        document.getElementById('liberacao-observacoes').value = liberacao.observacoes || '';
        
        document.getElementById('form-liberacao').setAttribute('data-edit-id', id);
        document.getElementById('btn-submit-text').textContent = 'Atualizar Liberação';
        
        Toast.show('Liberação carregada para edição', 'info');
    },
    
    deleteLiberacao: function(id) {
        const liberacao = DB.liberacoes.get(id);
        if (!liberacao) {
            Toast.show('Liberação não encontrada', 'error');
            return;
        }
        
        this.showConfirmDialog(
            `Tem certeza que deseja excluir a liberação "${liberacao.numero || liberacao.frente}"?`,
            () => {
                try {
                    DB.liberacoes.remove(id);
                    Toast.show('Liberação excluída com sucesso', 'success');
                    NotificationManager.add(`Liberação ${liberacao.numero || liberacao.frente} excluída`, 'warning');
                    this.loadLiberacoes();
                } catch (error) {
                    console.error('Erro ao excluir liberação:', error);
                    Toast.show('Erro ao excluir liberação: ' + error.message, 'error');
                }
            }
        );
    },
    
    exportarLiberacoes: function() {
        const searchTerm = document.getElementById('search-liberacoes').value;
        const filters = {
            frente: document.getElementById('filtro-liberacao-frente').value,
            fazenda: document.getElementById('filtro-liberacao-fazenda').value,
            status: document.getElementById('filtro-liberacao-status').value
        };
        
        const liberacoes = DB.liberacoes.search(searchTerm, filters);
        
        if (liberacoes.length === 0) {
            Toast.show('Nenhuma liberação para exportar', 'warning');
            return;
        }
        
        const colunas = [
            { header: 'Frente', dataKey: 'frente' },
            { header: 'Fazenda', dataKey: 'fazenda' },
            { header: 'Número', dataKey: 'numero' },
            { header: 'Status', dataKey: (item) => Utils.getStatusConfig(item.status).texto },
            { header: 'Previsto (T)', dataKey: (item) => Utils.formatarToneladas(item.previsto) },
            { header: 'Realizado (T)', dataKey: (item) => Utils.formatarToneladas(item.realizado) },
            { header: 'Restante (T)', dataKey: (item) => Utils.formatarToneladas(Number(item.previsto) - Number(item.realizado)) },
            { header: 'Data', dataKey: (item) => Utils.formatarData(item.data) },
            { header: 'Observações', dataKey: 'observacoes' }
        ];
        
        Utils.exportarPDF(
            'Relatório de Liberações',
            liberacoes,
            colunas,
            `relatorio-liberacoes-${new Date().toISOString().split('T')[0]}.pdf`
        );
    },
    
    // ===== MÓDULO FRENTES =====
    
    initFormFrente: function() {
        const form = document.getElementById('form-frente');
        
        form.addEventListener('submit', (e) => {
            e.preventDefault();
            this.saveFrente();
        });
    },
    
    loadFrente: function() {
        this.loadFrentesTable();
        this.updateFrentesSelectors();
    },
    
    loadFrentesTable: function() {
        const frentes = DB.frentes.getAll();
        const tbody = document.getElementById('tabela-frentes');
        
        if (frentes.length === 0) {
            tbody.innerHTML = `
                <tr>
                    <td colspan="5" class="px-3 py-8 text-center text-gray-500 dark:text-gray-400">
                        <i class="fas fa-map-marker-alt mb-2 text-2xl"></i>
                        <div>Nenhuma frente cadastrada</div>
                    </td>
                </tr>
            `;
            return;
        }
        
        tbody.innerHTML = frentes.map(frente => {
            const statusConfig = Utils.getStatusConfig(frente.status);
            const tipoConfig = Utils.getTipoConfig(frente.tipo);
            
            return `
                <tr class="hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                    <td class="px-3 py-2 text-sm font-medium text-gray-900 dark:text-white">${frente.nome}</td>
                    <td class="px-3 py-2 text-sm text-gray-700 dark:text-gray-300">${frente.fazenda}</td>
                    <td class="px-3 py-2 text-center">
                        <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${tipoConfig.bg} ${tipoConfig.text}">
                            <i class="fas ${tipoConfig.icon} mr-1"></i>
                            ${tipoConfig.texto}
                        </span>
                    </td>
                    <td class="px-3 py-2 text-center">
                        <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${statusConfig.bg} ${statusConfig.text}">
                            <i class="fas ${statusConfig.icon} mr-1"></i>
                            ${statusConfig.texto}
                        </span>
                    </td>
                    <td class="px-3 py-2 text-center">
                        <div class="flex items-center justify-center space-x-2">
                            <button onclick="App.editFrente('${frente.id}')" class="text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 transition-colors" title="Editar">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button onclick="App.deleteFrente('${frente.id}')" class="text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300 transition-colors" title="Excluir">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                </tr>
            `;
        }).join('');
    },
    
    updateFrentesSelectors: function() {
        const frentes = DB.frentes.getAll();
        const frentesProprias = frentes.filter(f => f.tipo === 'propria');
        const frentesTerceiras = frentes.filter(f => f.tipo === 'terceira');
        
        // Atualizar seletores de metas próprias
        const selectorMetaPropria = document.getElementById('meta-propria-frente');
        if (selectorMetaPropria) {
            const currentValue = selectorMetaPropria.value;
            selectorMetaPropria.innerHTML = '<option value="">Selecione uma frente própria</option>' +
                frentesProprias.map(f => `<option value="${f.id}">${f.nome} - ${f.fazenda}</option>`).join('');
            selectorMetaPropria.value = currentValue;
        }
        
        // Atualizar seletores de metas terceiras
        const selectorMetaTerceira = document.getElementById('meta-terceira-frente');
        if (selectorMetaTerceira) {
            const currentValue = selectorMetaTerceira.value;
            selectorMetaTerceira.innerHTML = '<option value="">Selecione uma frente terceira</option>' +
                frentesTerceiras.map(f => `<option value="${f.id}">${f.nome} - ${f.fazenda}</option>`).join('');
            selectorMetaTerceira.value = currentValue;
        }
        
        // Atualizar seletor de lançamentos
        const selectorLancamento = document.getElementById('lancamento-frente');
        if (selectorLancamento) {
            const currentValue = selectorLancamento.value;
            selectorLancamento.innerHTML = '<option value="">Selecione uma frente</option>' +
                frentes.map(f => `<option value="${f.id}">${f.nome} - ${f.fazenda} (${Utils.getTipoConfig(f.tipo).texto})</option>`).join('');
            selectorLancamento.value = currentValue;
        }
        
        // Atualizar filtros de acompanhamento
        const filtroAcompanhamento = document.getElementById('filtro-acompanhamento-frente');
        if (filtroAcompanhamento) {
            const currentValue = filtroAcompanhamento.value;
            filtroAcompanhamento.innerHTML = '<option value="">Todas as frentes</option>' +
                frentes.map(f => `<option value="${f.id}">${f.nome} - ${f.fazenda}</option>`).join('');
            filtroAcompanhamento.value = currentValue;
        }
    },
    
    saveFrente: function() {
        const form = document.getElementById('form-frente');
        
        if (!Utils.validateForm(form)) {
            Toast.show('Por favor, preencha todos os campos obrigatórios', 'error');
            return;
        }
        
        const frente = {
            nome: document.getElementById('frente-nome').value.trim(),
            fazenda: document.getElementById('frente-fazenda').value.trim(),
            tipo: document.getElementById('frente-tipo').value,
            responsavel: document.getElementById('frente-responsavel').value.trim(),
            status: document.getElementById('frente-status').value,
            observacoes: document.getElementById('frente-observacoes').value.trim()
        };
        
        try {
            const editId = form.getAttribute('data-edit-id');
            
            if (editId) {
                frente.id = editId;
                DB.frentes.update(frente);
                Toast.show('Frente atualizada com sucesso', 'success');
                NotificationManager.add(`Frente ${frente.nome} atualizada`, 'info');
            } else {
                DB.frentes.add(frente);
                Toast.show('Frente cadastrada com sucesso', 'success');
                NotificationManager.add(`Nova frente ${frente.nome} cadastrada`, 'success');
            }
            
            this.clearFrenteForm();
            this.loadFrente();
            
        } catch (error) {
            console.error('Erro ao salvar frente:', error);
            Toast.show('Erro ao salvar frente: ' + error.message, 'error');
        }
    },
    
    clearFrenteForm: function() {
        const form = document.getElementById('form-frente');
        form.reset();
        form.removeAttribute('data-edit-id');
        
        document.getElementById('btn-submit-frente-text').textContent = 'Salvar Frente';
        Utils.clearFormValidation(form);
    },
    
    editFrente: function(id) {
        const frente = DB.frentes.get(id);
        if (!frente) {
            Toast.show('Frente não encontrada', 'error');
            return;
        }
        
        document.getElementById('frente-nome').value = frente.nome;
        document.getElementById('frente-fazenda').value = frente.fazenda;
        document.getElementById('frente-tipo').value = frente.tipo;
        document.getElementById('frente-responsavel').value = frente.responsavel || '';
        document.getElementById('frente-status').value = frente.status;
        document.getElementById('frente-observacoes').value = frente.observacoes || '';
        
        document.getElementById('form-frente').setAttribute('data-edit-id', id);
        document.getElementById('btn-submit-frente-text').textContent = 'Atualizar Frente';
        
        Toast.show('Frente carregada para edição', 'info');
    },
    
    deleteFrente: function(id) {
        const frente = DB.frentes.get(id);
        if (!frente) {
            Toast.show('Frente não encontrada', 'error');
            return;
        }
        
        this.showConfirmDialog(
            `Tem certeza que deseja excluir a frente "${frente.nome}"? Esta ação não pode ser desfeita.`,
            () => {
                try {
                    DB.frentes.remove(id);
                    Toast.show('Frente excluída com sucesso', 'success');
                    NotificationManager.add(`Frente ${frente.nome} excluída`, 'warning');
                    this.loadFrente();
                } catch (error) {
                    console.error('Erro ao excluir frente:', error);
                    Toast.show('Erro ao excluir frente: ' + error.message, 'error');
                }
            }
        );
    },
    
    // ===== MÓDULO METAS =====
    
    loadMetas: function() {
        this.loadMetasProprias();
        this.loadMetasTerceiras();
        this.loadLancamentos();
    },
    
    // Metas Próprias
    initFormMetaPropria: function() {
        const form = document.getElementById('form-meta-propria');
        
        form.addEventListener('submit', (e) => {
            e.preventDefault();
            this.saveMetaPropria();
        });
    },
    
    loadMetasProprias: function() {
        this.updateFrentesSelectors();
        this.loadMetasPropriasTable();
    },
    
    loadMetasPropriasTable: function() {
        const metas = DB.metas.getByTipo('propria');
        const tbody = document.getElementById('tabela-metas-proprias');
        
        if (metas.length === 0) {
            tbody.innerHTML = `
                <tr>
                    <td colspan="5" class="px-3 py-8 text-center text-gray-500 dark:text-gray-400">
                        <i class="fas fa-home mb-2 text-2xl"></i>
                        <div>Nenhuma meta própria cadastrada</div>
                    </td>
                </tr>
            `;
            return;
        }
        
        tbody.innerHTML = metas.map(meta => {
            const frente = DB.frentes.get(meta.frenteId);
            const frenteNome = frente ? frente.nome : 'Frente não encontrada';
            const statusClass = new Date(meta.dataFim) >= new Date() ? 'text-green-600 dark:text-green-400' : 'text-red-600 dark:text-red-400';
            const statusText = new Date(meta.dataFim) >= new Date() ? 'Ativa' : 'Expirada';
            
            return `
                <tr class="hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                    <td class="px-3 py-2 text-sm font-medium text-gray-900 dark:text-white">${frenteNome}</td>
                    <td class="px-3 py-2 text-sm text-gray-700 dark:text-gray-300">${meta.periodo}</td>
                    <td class="px-3 py-2 text-right text-sm font-medium text-gray-900 dark:text-white">${Utils.formatarToneladas(meta.valor)}</td>
                    <td class="px-3 py-2 text-center">
                        <span class="text-xs font-medium ${statusClass}">${statusText}</span>
                    </td>
                    <td class="px-3 py-2 text-center">
                        <div class="flex items-center justify-center space-x-2">
                            <button onclick="App.editMetaPropria('${meta.id}')" class="text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 transition-colors" title="Editar">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button onclick="App.deleteMetaPropria('${meta.id}')" class="text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300 transition-colors" title="Excluir">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                </tr>
            `;
        }).join('');
    },
    
    saveMetaPropria: function() {
        const form = document.getElementById('form-meta-propria');
        
        if (!Utils.validateForm(form)) {
            Toast.show('Por favor, preencha todos os campos obrigatórios', 'error');
            return;
        }
        
        const meta = {
            frenteId: document.getElementById('meta-propria-frente').value,
            tipo: 'propria',
            periodo: document.getElementById('meta-propria-periodo').value,
            valor: parseFloat(document.getElementById('meta-propria-valor').value),
            dataInicio: document.getElementById('meta-propria-data-inicio').value,
            dataFim: document.getElementById('meta-propria-data-fim').value,
            observacoes: document.getElementById('meta-propria-observacoes').value.trim()
        };
        
        try {
            const editId = form.getAttribute('data-edit-id');
            
            if (editId) {
                meta.id = editId;
                DB.metas.update(meta);
                Toast.show('Meta própria atualizada com sucesso', 'success');
            } else {
                DB.metas.add(meta);
                Toast.show('Meta própria cadastrada com sucesso', 'success');
            }
            
            this.clearMetaPropriaForm();
            this.loadMetasProprias();
            
        } catch (error) {
            console.error('Erro ao salvar meta própria:', error);
            Toast.show('Erro ao salvar meta própria: ' + error.message, 'error');
        }
    },
    
    clearMetaPropriaForm: function() {
        const form = document.getElementById('form-meta-propria');
        form.reset();
        form.removeAttribute('data-edit-id');
        
        const hoje = Utils.getLocalDateString();
        document.getElementById('meta-propria-data-inicio').value = hoje;
        document.getElementById('meta-propria-data-fim').value = hoje;
        
        document.getElementById('btn-submit-meta-propria-text').textContent = 'Salvar Meta Própria';
        Utils.clearFormValidation(form);
    },
    
    editMetaPropria: function(id) {
        const meta = DB.metas.get(id);
        if (!meta) {
            Toast.show('Meta não encontrada', 'error');
            return;
        }
        
        document.getElementById('meta-propria-frente').value = meta.frenteId;
        document.getElementById('meta-propria-periodo').value = meta.periodo;
        document.getElementById('meta-propria-valor').value = meta.valor;
        document.getElementById('meta-propria-data-inicio').value = meta.dataInicio;
        document.getElementById('meta-propria-data-fim').value = meta.dataFim;
        document.getElementById('meta-propria-observacoes').value = meta.observacoes || '';
        
        document.getElementById('form-meta-propria').setAttribute('data-edit-id', id);
        document.getElementById('btn-submit-meta-propria-text').textContent = 'Atualizar Meta Própria';
        
        Toast.show('Meta própria carregada para edição', 'info');
    },
    
    deleteMetaPropria: function(id) {
        const meta = DB.metas.get(id);
        if (!meta) {
            Toast.show('Meta não encontrada', 'error');
            return;
        }
        
        const frente = DB.frentes.get(meta.frenteId);
        const frenteNome = frente ? frente.nome : 'Frente não encontrada';
        
        this.showConfirmDialog(
            `Tem certeza que deseja excluir a meta da frente "${frenteNome}"?`,
            () => {
                try {
                    DB.metas.remove(id);
                    Toast.show('Meta própria excluída com sucesso', 'success');
                    this.loadMetasProprias();
                } catch (error) {
                    console.error('Erro ao excluir meta própria:', error);
                    Toast.show('Erro ao excluir meta própria: ' + error.message, 'error');
                }
            }
        );
    },
    
    // Metas Terceiras
    initFormMetaTerceira: function() {
        const form = document.getElementById('form-meta-terceira');
        
        form.addEventListener('submit', (e) => {
            e.preventDefault();
            this.saveMetaTerceira();
        });
    },
    
    loadMetasTerceiras: function() {
        this.updateFrentesSelectors();
        this.loadMetasTerceirasTable();
    },
    
    loadMetasTerceirasTable: function() {
        const metas = DB.metas.getByTipo('terceira');
        const tbody = document.getElementById('tabela-metas-terceiras');
        
        if (metas.length === 0) {
            tbody.innerHTML = `
                <tr>
                    <td colspan="5" class="px-3 py-8 text-center text-gray-500 dark:text-gray-400">
                        <i class="fas fa-handshake mb-2 text-2xl"></i>
                        <div>Nenhuma meta terceira cadastrada</div>
                    </td>
                </tr>
            `;
            return;
        }
        
        tbody.innerHTML = metas.map(meta => {
            const frente = DB.frentes.get(meta.frenteId);
            const frenteNome = frente ? frente.nome : 'Frente não encontrada';
            const statusClass = new Date(meta.dataFim) >= new Date() ? 'text-green-600 dark:text-green-400' : 'text-red-600 dark:text-red-400';
            const statusText = new Date(meta.dataFim) >= new Date() ? 'Ativa' : 'Expirada';
            
            return `
                <tr class="hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                    <td class="px-3 py-2 text-sm font-medium text-gray-900 dark:text-white">${frenteNome}</td>
                    <td class="px-3 py-2 text-sm text-gray-700 dark:text-gray-300">${meta.periodo}</td>
                    <td class="px-3 py-2 text-right text-sm font-medium text-gray-900 dark:text-white">${Utils.formatarToneladas(meta.valor)}</td>
                    <td class="px-3 py-2 text-center">
                        <span class="text-xs font-medium ${statusClass}">${statusText}</span>
                    </td>
                    <td class="px-3 py-2 text-center">
                        <div class="flex items-center justify-center space-x-2">
                            <button onclick="App.editMetaTerceira('${meta.id}')" class="text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 transition-colors" title="Editar">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button onclick="App.deleteMetaTerceira('${meta.id}')" class="text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300 transition-colors" title="Excluir">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                </tr>
            `;
        }).join('');
    },
    
    saveMetaTerceira: function() {
        const form = document.getElementById('form-meta-terceira');
        
        if (!Utils.validateForm(form)) {
            Toast.show('Por favor, preencha todos os campos obrigatórios', 'error');
            return;
        }
        
        const meta = {
            frenteId: document.getElementById('meta-terceira-frente').value,
            tipo: 'terceira',
            periodo: document.getElementById('meta-terceira-periodo').value,
            valor: parseFloat(document.getElementById('meta-terceira-valor').value),
            dataInicio: document.getElementById('meta-terceira-data-inicio').value,
            dataFim: document.getElementById('meta-terceira-data-fim').value,
            observacoes: document.getElementById('meta-terceira-observacoes').value.trim()
        };
        
        try {
            const editId = form.getAttribute('data-edit-id');
            
            if (editId) {
                meta.id = editId;
                DB.metas.update(meta);
                Toast.show('Meta terceira atualizada com sucesso', 'success');
            } else {
                DB.metas.add(meta);
                Toast.show('Meta terceira cadastrada com sucesso', 'success');
            }
            
            this.clearMetaTerceiraForm();
            this.loadMetasTerceiras();
            
        } catch (error) {
            console.error('Erro ao salvar meta terceira:', error);
            Toast.show('Erro ao salvar meta terceira: ' + error.message, 'error');
        }
    },
    
    clearMetaTerceiraForm: function() {
        const form = document.getElementById('form-meta-terceira');
        form.reset();
        form.removeAttribute('data-edit-id');
        
        const hoje = Utils.getLocalDateString();
        document.getElementById('meta-terceira-data-inicio').value = hoje;
        document.getElementById('meta-terceira-data-fim').value = hoje;
        
        document.getElementById('btn-submit-meta-terceira-text').textContent = 'Salvar Meta Terceira';
        Utils.clearFormValidation(form);
    },
    
    editMetaTerceira: function(id) {
        const meta = DB.metas.get(id);
        if (!meta) {
            Toast.show('Meta não encontrada', 'error');
            return;
        }
        
        document.getElementById('meta-terceira-frente').value = meta.frenteId;
        document.getElementById('meta-terceira-periodo').value = meta.periodo;
        document.getElementById('meta-terceira-valor').value = meta.valor;
        document.getElementById('meta-terceira-data-inicio').value = meta.dataInicio;
        document.getElementById('meta-terceira-data-fim').value = meta.dataFim;
        document.getElementById('meta-terceira-observacoes').value = meta.observacoes || '';
        
        document.getElementById('form-meta-terceira').setAttribute('data-edit-id', id);
        document.getElementById('btn-submit-meta-terceira-text').textContent = 'Atualizar Meta Terceira';
        
        Toast.show('Meta terceira carregada para edição', 'info');
    },
    
    deleteMetaTerceira: function(id) {
        const meta = DB.metas.get(id);
        if (!meta) {
            Toast.show('Meta não encontrada', 'error');
            return;
        }
        
        const frente = DB.frentes.get(meta.frenteId);
        const frenteNome = frente ? frente.nome : 'Frente não encontrada';
        
        this.showConfirmDialog(
            `Tem certeza que deseja excluir a meta da frente "${frenteNome}"?`,
            () => {
                try {
                    DB.metas.remove(id);
                    Toast.show('Meta terceira excluída com sucesso', 'success');
                    this.loadMetasTerceiras();
                } catch (error) {
                    console.error('Erro ao excluir meta terceira:', error);
                    Toast.show('Erro ao excluir meta terceira: ' + error.message, 'error');
                }
            }
        );
    },
    
    // Lançamento Diário
    initFormLancamento: function() {
        const form = document.getElementById('form-lancamento');
        
        form.addEventListener('submit', (e) => {
            e.preventDefault();
            this.saveLancamento();
        });
    },
    
    loadLancamentos: function() {
        this.updateFrentesSelectors();
        this.loadLancamentosTable();
    },
    
    loadLancamentosTable: function() {
        const lancamentos = DB.lancamentos.getAll()
            .sort((a, b) => new Date(b.dataRegistro) - new Date(a.dataRegistro))
            .slice(0, 20); // Últimos 20 lançamentos
        
        const tbody = document.getElementById('tabela-lancamentos');
        
        if (lancamentos.length === 0) {
            tbody.innerHTML = `
                <tr>
                    <td colspan="6" class="px-3 py-8 text-center text-gray-500 dark:text-gray-400">
                        <i class="fas fa-calendar-day mb-2 text-2xl"></i>
                        <div>Nenhum lançamento encontrado</div>
                    </td>
                </tr>
            `;
            return;
        }
        
        tbody.innerHTML = lancamentos.map(lancamento => {
            const frente = DB.frentes.get(lancamento.frenteId);
            const frenteNome = frente ? frente.nome : 'Frente não encontrada';
            const frenteTipo = frente ? frente.tipo : 'desconhecido';
            const tipoConfig = Utils.getTipoConfig(frenteTipo);
            
            return `
                <tr class="hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                    <td class="px-3 py-2 text-sm font-medium text-gray-900 dark:text-white">${Utils.formatarData(lancamento.data)}</td>
                    <td class="px-3 py-2 text-sm text-gray-700 dark:text-gray-300">${frenteNome}</td>
                    <td class="px-3 py-2 text-center">
                        <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${tipoConfig.bg} ${tipoConfig.text}">
                            <i class="fas ${tipoConfig.icon} mr-1"></i>
                            ${tipoConfig.texto}
                        </span>
                    </td>
                    <td class="px-3 py-2 text-right text-sm font-medium text-green-600 dark:text-green-400">${Utils.formatarToneladas(lancamento.colhido)}</td>
                    <td class="px-3 py-2 text-center text-sm text-gray-700 dark:text-gray-300">${lancamento.turno}</td>
                    <td class="px-3 py-2 text-center">
                        <div class="flex items-center justify-center space-x-2">
                            <button onclick="App.editLancamento('${lancamento.id}')" class="text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 transition-colors" title="Editar">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button onclick="App.deleteLancamento('${lancamento.id}')" class="text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300 transition-colors" title="Excluir">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                </tr>
            `;
        }).join('');
    },
    
    saveLancamento: function() {
        const form = document.getElementById('form-lancamento');
        
        if (!Utils.validateForm(form)) {
            Toast.show('Por favor, preencha todos os campos obrigatórios', 'error');
            return;
        }
        
        const lancamento = {
            frenteId: document.getElementById('lancamento-frente').value,
            data: document.getElementById('lancamento-data').value,
            colhido: parseFloat(document.getElementById('lancamento-colhido').value),
            turno: document.getElementById('lancamento-turno').value,
            operador: document.getElementById('lancamento-operador').value.trim(),
            observacoes: document.getElementById('lancamento-observacoes').value.trim()
        };
        
        try {
            const editId = form.getAttribute('data-edit-id');
            
            if (editId) {
                lancamento.id = editId;
                DB.lancamentos.update(lancamento);
                Toast.show('Lançamento atualizado com sucesso', 'success');
                NotificationManager.add(`Lançamento atualizado: ${Utils.formatarToneladas(lancamento.colhido)}`, 'info');
            } else {
                DB.lancamentos.add(lancamento);
                Toast.show('Lançamento registrado com sucesso', 'success');
                NotificationManager.add(`Novo lançamento: ${Utils.formatarToneladas(lancamento.colhido)}`, 'success');
            }
            
            this.clearLancamentoForm();
            this.loadLancamentos();
            
        } catch (error) {
            console.error('Erro ao salvar lançamento:', error);
            Toast.show('Erro ao salvar lançamento: ' + error.message, 'error');
        }
    },
    
    clearLancamentoForm: function() {
        const form = document.getElementById('form-lancamento');
        form.reset();
        form.removeAttribute('data-edit-id');
        
        // CORREÇÃO: Usar a data local atual
        const hoje = Utils.getLocalDateString();
        document.getElementById('lancamento-data').value = hoje;
        
        document.getElementById('btn-submit-lancamento-text').textContent = 'Salvar Lançamento';
        Utils.clearFormValidation(form);
    },
    
    editLancamento: function(id) {
        const lancamento = DB.lancamentos.get(id);
        if (!lancamento) {
            Toast.show('Lançamento não encontrado', 'error');
            return;
        }
        
        document.getElementById('lancamento-frente').value = lancamento.frenteId;
        document.getElementById('lancamento-data').value = lancamento.data;
        document.getElementById('lancamento-colhido').value = lancamento.colhido;
        document.getElementById('lancamento-turno').value = lancamento.turno;
        document.getElementById('lancamento-operador').value = lancamento.operador || '';
        document.getElementById('lancamento-observacoes').value = lancamento.observacoes || '';
        
        document.getElementById('form-lancamento').setAttribute('data-edit-id', id);
        document.getElementById('btn-submit-lancamento-text').textContent = 'Atualizar Lançamento';
        
        Toast.show('Lançamento carregado para edição', 'info');
    },
    
    deleteLancamento: function(id) {
        const lancamento = DB.lancamentos.get(id);
        if (!lancamento) {
            Toast.show('Lançamento não encontrado', 'error');
            return;
        }
        
        this.showConfirmDialog(
            `Tem certeza que deseja excluir o lançamento de ${Utils.formatarToneladas(lancamento.colhido)} do dia ${Utils.formatarData(lancamento.data)}?`,
            () => {
                try {
                    DB.lancamentos.remove(id);
                    Toast.show('Lançamento excluído com sucesso', 'success');
                    NotificationManager.add(`Lançamento de ${Utils.formatarToneladas(lancamento.colhido)} excluído`, 'warning');
                    this.loadLancamentos();
                } catch (error) {
                    console.error('Erro ao excluir lançamento:', error);
                    Toast.show('Erro ao excluir lançamento: ' + error.message, 'error');
                }
            }
        );
    },
    
    // Acompanhamento Avançado
    loadAcompanhamento: function() {
        this.updateFiltrosAcompanhamento();
        this.aplicarFiltrosAcompanhamento();
    },
    
    updateFiltrosAcompanhamento: function() {
        const frentes = DB.frentes.getAll();
        
        // Atualizar filtro de frentes
        const filtroFrente = document.getElementById('filtro-acompanhamento-frente');
        if (filtroFrente) {
            const currentValue = filtroFrente.value;
            filtroFrente.innerHTML = '<option value="">Todas as frentes</option>' +
                frentes.map(f => `<option value="${f.id}">${f.nome} - ${f.fazenda}</option>`).join('');
            filtroFrente.value = currentValue;
        }
        
        // Definir datas padrão se vazias
        const hoje = Utils.getLocalDateString();
        const dataInicial = new Date();
        dataInicial.setDate(dataInicial.getDate() - 30);
        const dataInicialStr = Utils.formatDateForInput(dataInicial);
        
        const filtroDataInicio = document.getElementById('filtro-acompanhamento-data-inicio');
        const filtroDataFim = document.getElementById('filtro-acompanhamento-data-fim');
        
        if (filtroDataInicio && !filtroDataInicio.value) {
            filtroDataInicio.value = dataInicialStr;
        }
        
        if (filtroDataFim && !filtroDataFim.value) {
            filtroDataFim.value = hoje;
        }
    },
    
    aplicarFiltrosAcompanhamento: function() {
        const filtros = {
            frenteId: document.getElementById('filtro-acompanhamento-frente').value,
            tipo: document.getElementById('filtro-acompanhamento-tipo').value,
            dataInicio: document.getElementById('filtro-acompanhamento-data-inicio').value,
            dataFim: document.getElementById('filtro-acompanhamento-data-fim').value,
            incluirInativos: document.getElementById('filtro-incluir-inativos').checked
        };
        
        // Verificar cache
        if (AcompanhamentoCache.isValid(filtros)) {
            const cachedData = AcompanhamentoCache.get();
            this.renderAcompanhamento(cachedData);
            this.updateUltimaAtualizacao();
            return;
        }
        
        Utils.showLoading(true);
        
        // Simular carregamento assíncrono
        setTimeout(() => {
            try {
                const dados = this.calcularAcompanhamento(filtros);
                AcompanhamentoCache.set(dados, filtros);
                this.renderAcompanhamento(dados);
                this.updateUltimaAtualizacao();
            } catch (error) {
                console.error('Erro ao carregar acompanhamento:', error);
                Toast.show('Erro ao carregar dados de acompanhamento', 'error');
            } finally {
                Utils.showLoading(false);
            }
        }, 500);
    },
    
    calcularAcompanhamento: function(filtros) {
        let frentes = DB.frentes.getAll();
        const metas = DB.metas.getAll();
        const lancamentos = DB.lancamentos.getAll();
        
        // Aplicar filtros
        if (filtros.frenteId) {
            frentes = frentes.filter(f => f.id === filtros.frenteId);
        }
        
        if (filtros.tipo) {
            frentes = frentes.filter(f => f.tipo === filtros.tipo);
        }
        
        if (!filtros.incluirInativos) {
            frentes = frentes.filter(f => f.status === 'ativa');
        }
        
        const dados = frentes.map(frente => {
            // Filtrar metas da frente no período
            const metasFrente = metas.filter(m => 
                m.frenteId === frente.id &&
                (!filtros.dataInicio || m.dataFim >= filtros.dataInicio) &&
                (!filtros.dataFim || m.dataInicio <= filtros.dataFim)
            );
            
            // Filtrar lançamentos da frente no período
            const lancamentosFrente = lancamentos.filter(l => 
                l.frenteId === frente.id &&
                (!filtros.dataInicio || l.data >= filtros.dataInicio) &&
                (!filtros.dataFim || l.data <= filtros.dataFim)
            );
            
            // Calcular totais
            const metaTotal = metasFrente.reduce((sum, m) => sum + Number(m.valor), 0);
            const colhidoTotal = lancamentosFrente.reduce((sum, l) => sum + Number(l.colhido), 0);
            const restante = Math.max(0, metaTotal - colhidoTotal);
            const percentualMeta = metaTotal > 0 ? (colhidoTotal / metaTotal) * 100 : 0;
            
            // Calcular tendência (últimos 7 dias vs 7 dias anteriores)
            const hoje = new Date();
            const data7Dias = new Date(hoje.getTime() - 7 * 24 * 60 * 60 * 1000);
            const data14Dias = new Date(hoje.getTime() - 14 * 24 * 60 * 60 * 1000);
            
            const lancamentosUltimos7 = lancamentos.filter(l => 
                l.frenteId === frente.id && 
                l.data >= Utils.formatDateForInput(data7Dias)
            );
            const lancamentos7Anteriores = lancamentos.filter(l => 
                l.frenteId === frente.id && 
                l.data >= Utils.formatDateForInput(data14Dias) && 
                l.data < Utils.formatDateForInput(data7Dias)
            );
            
            const mediaUltimos7 = lancamentosUltimos7.length > 0 ? 
                lancamentosUltimos7.reduce((sum, l) => sum + Number(l.colhido), 0) / lancamentosUltimos7.length : 0;
            const media7Anteriores = lancamentos7Anteriores.length > 0 ? 
                lancamentos7Anteriores.reduce((sum, l) => sum + Number(l.colhido), 0) / lancamentos7Anteriores.length : 0;
            
            let tendencia = 'estavel';
            if (mediaUltimos7 > media7Anteriores * 1.1) {
                tendencia = 'crescente';
            } else if (mediaUltimos7 < media7Anteriores * 0.9) {
                tendencia = 'decrescente';
            }
            
            // Determinar status
            let status = 'critico';
            if (percentualMeta >= 100) status = 'meta-atingida';
            else if (percentualMeta >= 90) status = 'proximo-meta';
            else if (percentualMeta >= 70) status = 'em-progresso';
            else if (percentualMeta >= 50) status = 'atencao';
            
            return {
                frente,
                metaTotal,
                colhidoTotal,
                restante,
                percentualMeta,
                status,
                tendencia,
                metasCount: metasFrente.length,
                lancamentosCount: lancamentosFrente.length
            };
        });
        
        // Ordenar por campo e direção atual
        return this.sortAcompanhamento(dados, currentAcompanhamentoSort.field, currentAcompanhamentoSort.direction);
    },
    
    sortAcompanhamento: function(dados, field, direction) {
        return dados.sort((a, b) => {
            let valueA, valueB;
            
            switch(field) {
                case 'nome':
                    valueA = a.frente.nome.toLowerCase();
                    valueB = b.frente.nome.toLowerCase();
                    break;
                case 'metaTotal':
                    valueA = a.metaTotal;
                    valueB = b.metaTotal;
                    break;
                case 'colhidoTotal':
                    valueA = a.colhidoTotal;
                    valueB = b.colhidoTotal;
                    break;
                case 'restante':
                    valueA = a.restante;
                    valueB = b.restante;
                    break;
                case 'percentualMeta':
                    valueA = a.percentualMeta;
                    valueB = b.percentualMeta;
                    break;
                default:
                    valueA = a.percentualMeta;
                    valueB = b.percentualMeta;
            }
            
            if (direction === 'asc') {
                return valueA < valueB ? -1 : valueA > valueB ? 1 : 0;
            } else {
                return valueA > valueB ? -1 : valueA < valueB ? 1 : 0;
            }
        });
    },
    
    renderAcompanhamento: function(dados) {
        this.updateResumoAcompanhamento(dados);
        this.renderTabelaAcompanhamento(dados);
        this.updateSortIndicators();
    },
    
    updateResumoAcompanhamento: function(dados) {
        const metasProprias = dados.filter(d => d.frente.tipo === 'propria').length;
        const metasTerceiras = dados.filter(d => d.frente.tipo === 'terceira').length;
        const totalColhido = dados.reduce((sum, d) => sum + d.colhidoTotal, 0);
        const totalMeta = dados.reduce((sum, d) => sum + d.metaTotal, 0);
        const percentualGeral = totalMeta > 0 ? (totalColhido / totalMeta) * 100 : 0;
        
        // Determinar tendência geral
        const crescentes = dados.filter(d => d.tendencia === 'crescente').length;
        const decrescentes = dados.filter(d => d.tendencia === 'decrescente').length;
        let tendenciaGeral = 'Estável';
        
        if (crescentes > decrescentes) {
            tendenciaGeral = 'Crescente';
        } else if (decrescentes > crescentes) {
            tendenciaGeral = 'Decrescente';
        }
        
        document.getElementById('resumo-metas-proprias-ativas').textContent = metasProprias;
        document.getElementById('resumo-metas-terceiras-ativas').textContent = metasTerceiras;
        document.getElementById('resumo-total-colhido').textContent = Utils.formatarToneladas(totalColhido);
        document.getElementById('resumo-total-meta').textContent = Utils.formatarToneladas(totalMeta);
        document.getElementById('resumo-percentual-meta').textContent = `${percentualGeral.toFixed(1)}%`;
        document.getElementById('resumo-tendencia-info').textContent = tendenciaGeral;
    },
    
    renderTabelaAcompanhamento: function(dados) {
        const tbody = document.getElementById('tabela-acompanhamento');
        
        if (dados.length === 0) {
            tbody.innerHTML = `
                <tr>
                    <td colspan="10" class="px-4 py-8 text-center text-gray-500 dark:text-gray-400">
                        <i class="fas fa-chart-line mb-2 text-2xl"></i>
                        <div>Nenhum dado encontrado para os filtros aplicados</div>
                    </td>
                </tr>
            `;
            return;
        }
        
        tbody.innerHTML = dados.map(item => {
            const tipoConfig = Utils.getTipoConfig(item.frente.tipo);
            const statusConfig = this.getStatusAcompanhamento(item.status);
            const tendenciaConfig = this.getTendenciaConfig(item.tendencia);
            
            return `
                <tr class="hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                    <td class="px-4 py-3 text-sm font-medium text-gray-900 dark:text-white">
                        <div>
                            <div class="font-medium">${item.frente.nome}</div>
                            <div class="text-xs text-gray-500 dark:text-gray-400">${item.frente.fazenda}</div>
                        </div>
                    </td>
                    <td class="px-4 py-3 text-center">
                        <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${tipoConfig.bg} ${tipoConfig.text}">
                            <i class="fas ${tipoConfig.icon} mr-1"></i>
                            ${tipoConfig.texto}
                        </span>
                    </td>
                    <td class="px-4 py-3 text-center text-sm font-medium text-purple-600 dark:text-purple-400">
                        ${Utils.formatarToneladas(item.metaTotal)}
                    </td>
                    <td class="px-4 py-3 text-center text-sm font-medium text-green-600 dark:text-green-400">
                        ${Utils.formatarToneladas(item.colhidoTotal)}
                    </td>
                    <td class="px-4 py-3 text-center text-sm font-medium text-red-600 dark:text-red-400">
                        ${Utils.formatarToneladas(item.restante)}
                    </td>
                    <td class="px-4 py-3 text-center text-sm font-bold">
                        <span class="${statusConfig.textColor}">${item.percentualMeta.toFixed(1)}%</span>
                    </td>
                    <td class="px-4 py-3 text-center">
                        <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${statusConfig.bg} ${statusConfig.text}">
                            <div class="w-2 h-2 rounded-full ${statusConfig.dotColor} mr-2"></div>
                            ${statusConfig.texto}
                        </span>
                    </td>
                    <td class="px-4 py-3 text-center">
                        <span class="inline-flex items-center text-xs font-medium ${tendenciaConfig.color}">
                            <i class="fas ${tendenciaConfig.icon} mr-1"></i>
                            ${tendenciaConfig.texto}
                        </span>
                    </td>
                    <td class="px-4 py-3 text-center">
                        <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3">
                            <div class="h-3 rounded-full ${statusConfig.barColor} transition-all-300" style="width: ${Math.min(item.percentualMeta, 100)}%"></div>
                        </div>
                        <div class="text-xs text-gray-500 dark:text-gray-400 mt-1">
                            ${item.metasCount} meta${item.metasCount !== 1 ? 's' : ''} | ${item.lancamentosCount} lançamento${item.lancamentosCount !== 1 ? 's' : ''}
                        </div>
                    </td>
                    <td class="px-4 py-3 text-center">
                        <div class="flex items-center justify-center space-x-2">
                            <button onclick="App.viewAcompanhamentoDetails('${item.frente.id}')" class="text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 transition-colors" title="Ver detalhes">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button onclick="App.editFrente('${item.frente.id}'); App.switchTab('frentes', 'tab-button', 'tab-content');" class="text-green-600 hover:text-green-800 dark:text-green-400 dark:hover:text-green-300 transition-colors" title="Editar frente">
                                <i class="fas fa-edit"></i>
                            </button>
                        </div>
                    </td>
                </tr>
            `;
        }).join('');
        
        // Adicionar event listeners para ordenação
        this.addSortEventListeners();
    },
    
    getStatusAcompanhamento: function(status) {
        const configs = {
            'meta-atingida': {
                texto: 'Meta Atingida',
                bg: 'bg-green-100 dark:bg-green-900',
                text: 'text-green-700 dark:text-green-300',
                textColor: 'text-green-600 dark:text-green-400',
                dotColor: 'bg-green-500',
                barColor: 'bg-green-500'
            },
            'proximo-meta': {
                texto: 'Próximo à Meta',
                bg: 'bg-blue-100 dark:bg-blue-900',
                text: 'text-blue-700 dark:text-blue-300',
                textColor: 'text-blue-600 dark:text-blue-400',
                dotColor: 'bg-blue-500',
                barColor: 'bg-blue-500'
            },
            'em-progresso': {
                texto: 'Em Progresso',
                bg: 'bg-yellow-100 dark:bg-yellow-900',
                text: 'text-yellow-700 dark:text-yellow-300',
                textColor: 'text-yellow-600 dark:text-yellow-400',
                dotColor: 'bg-yellow-500',
                barColor: 'bg-yellow-500'
            },
            'atencao': {
                texto: 'Atenção',
                bg: 'bg-orange-100 dark:bg-orange-900',
                text: 'text-orange-700 dark:text-orange-300',
                textColor: 'text-orange-600 dark:text-orange-400',
                dotColor: 'bg-orange-500',
                barColor: 'bg-orange-500'
            },
            'critico': {
                texto: 'Crítico',
                bg: 'bg-red-100 dark:bg-red-900',
                text: 'text-red-700 dark:text-red-300',
                textColor: 'text-red-600 dark:text-red-400',
                dotColor: 'bg-red-500',
                barColor: 'bg-red-500'
            }
        };
        
        return configs[status] || configs['critico'];
    },
    
    getTendenciaConfig: function(tendencia) {
        const configs = {
            'crescente': {
                texto: 'Crescente',
                icon: 'fa-arrow-up',
                color: 'text-green-600 dark:text-green-400'
            },
            'decrescente': {
                texto: 'Decrescente',
                icon: 'fa-arrow-down',
                color: 'text-red-600 dark:text-red-400'
            },
            'estavel': {
                texto: 'Estável',
                icon: 'fa-minus',
                color: 'text-gray-600 dark:text-gray-400'
            }
        };
        
        return configs[tendencia] || configs['estavel'];
    },
    
    addSortEventListeners: function() {
        document.querySelectorAll('[data-sort-acompanhamento]').forEach(th => {
            th.addEventListener('click', () => {
                const field = th.getAttribute('data-sort-acompanhamento');
                
                if (currentAcompanhamentoSort.field === field) {
                    currentAcompanhamentoSort.direction = currentAcompanhamentoSort.direction === 'asc' ? 'desc' : 'asc';
                } else {
                    currentAcompanhamentoSort.field = field;
                    currentAcompanhamentoSort.direction = 'desc';
                }
                
                this.aplicarFiltrosAcompanhamento();
            });
        });
    },
    
    updateSortIndicators: function() {
        document.querySelectorAll('[data-sort-acompanhamento] i').forEach(icon => {
            icon.className = 'fas fa-sort ml-1';
        });
        
        const activeHeader = document.querySelector(`[data-sort-acompanhamento="${currentAcompanhamentoSort.field}"] i`);
        if (activeHeader) {
            activeHeader.className = `fas fa-sort-${currentAcompanhamentoSort.direction === 'asc' ? 'up' : 'down'} ml-1`;
        }
    },
    
    updateUltimaAtualizacao: function() {
        const agora = new Date();
        const horaAtual = agora.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' });
        document.getElementById('ultima-atualizacao').textContent = horaAtual;
    },
    
    limparFiltrosAcompanhamento: function() {
        document.getElementById('filtro-acompanhamento-frente').value = '';
        document.getElementById('filtro-acompanhamento-tipo').value = '';
        document.getElementById('filtro-acompanhamento-data-inicio').value = '';
        document.getElementById('filtro-acompanhamento-data-fim').value = '';
        document.getElementById('filtro-incluir-inativos').checked = false;
        
        AcompanhamentoCache.clear();
        this.aplicarFiltrosAcompanhamento();
        Toast.show('Filtros de acompanhamento limpos', 'info');
    },
    
    viewAcompanhamentoDetails: function(frenteId) {
        const frente = DB.frentes.get(frenteId);
        if (!frente) {
            Toast.show('Frente não encontrada', 'error');
            return;
        }
        
        // Implementar modal de detalhes (simplificado para este exemplo)
        Toast.show(`Detalhes da frente ${frente.nome} - Funcionalidade em desenvolvimento`, 'info');
    },
    
    exportarAcompanhamento: function() {
        const filtros = {
            frenteId: document.getElementById('filtro-acompanhamento-frente').value,
            tipo: document.getElementById('filtro-acompanhamento-tipo').value,
            dataInicio: document.getElementById('filtro-acompanhamento-data-inicio').value,
            dataFim: document.getElementById('filtro-acompanhamento-data-fim').value,
            incluirInativos: document.getElementById('filtro-incluir-inativos').checked
        };
        
        const dados = this.calcularAcompanhamento(filtros);
        
        if (dados.length === 0) {
            Toast.show('Nenhum dado para exportar', 'warning');
            return;
        }
        
        const colunas = [
            { header: 'Frente', dataKey: (item) => item.frente.nome },
            { header: 'Fazenda', dataKey: (item) => item.frente.fazenda },
            { header: 'Tipo', dataKey: (item) => Utils.getTipoConfig(item.frente.tipo).texto },
            { header: 'Status', dataKey: (item) => Utils.getStatusConfig(item.frente.status).texto },
            { header: 'Meta Total (T)', dataKey: (item) => Utils.formatarToneladas(item.metaTotal) },
            { header: 'Colhido Total (T)', dataKey: (item) => Utils.formatarToneladas(item.colhidoTotal) },
            { header: 'Restante (T)', dataKey: (item) => Utils.formatarToneladas(item.restante) },
            { header: '% Meta', dataKey: (item) => `${item.percentualMeta.toFixed(1)}%` },
            { header: 'Status Performance', dataKey: (item) => this.getStatusAcompanhamento(item.status).texto },
            { header: 'Tendência', dataKey: (item) => this.getTendenciaConfig(item.tendencia).texto },
            { header: 'Nº Metas', dataKey: (item) => item.metasCount },
            { header: 'Nº Lançamentos', dataKey: (item) => item.lancamentosCount }
        ];
        
        const periodo = filtros.dataInicio && filtros.dataFim ? 
            ` (${Utils.formatarData(filtros.dataInicio)} a ${Utils.formatarData(filtros.dataFim)})` : '';
        
        Utils.exportarPDF(
            `Relatório de Acompanhamento de Metas${periodo}`,
            dados,
            colunas,
            `relatorio-acompanhamento-${new Date().toISOString().split('T')[0]}.pdf`
        );
    },
    
    // ===== MÓDULO CAMINHÕES =====
    
    initFormCaminhao: function() {
        const form = document.getElementById('form-caminhao');
        
        form.addEventListener('submit', (e) => {
            e.preventDefault();
            this.saveCaminhao();
        });
    },
    
    loadCaminhoes: function() {
        this.loadCaminhoesTable();
        this.updateCaminhoesSelectors();
    },
    
    loadCaminhoesTable: function() {
        const caminhoes = DB.caminhoes.getAll();
        const tbody = document.getElementById('tabela-caminhoes');
        
        if (caminhoes.length === 0) {
            tbody.innerHTML = `
                <tr>
                    <td colspan="6" class="px-3 py-8 text-center text-gray-500 dark:text-gray-400">
                        <i class="fas fa-truck mb-2 text-2xl"></i>
                        <div>Nenhum caminhão cadastrado</div>
                    </td>
                </tr>
            `;
            return;
        }
        
        tbody.innerHTML = caminhoes.map(caminhao => {
            const statusConfig = Utils.getStatusConfig(caminhao.status);
            const tipoConfig = Utils.getTipoConfig(caminhao.tipo);
            
            return `
                <tr class="hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                    <td class="px-3 py-2 text-sm font-medium text-gray-900 dark:text-white">${caminhao.placa}</td>
                    <td class="px-3 py-2 text-sm text-gray-700 dark:text-gray-300">${caminhao.modelo}</td>
                    <td class="px-3 py-2 text-center">
                        <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${tipoConfig.bg} ${tipoConfig.text}">
                            <i class="fas ${tipoConfig.icon} mr-1"></i>
                            ${tipoConfig.texto}
                        </span>
                    </td>
                    <td class="px-3 py-2 text-center text-sm text-gray-700 dark:text-gray-300">${caminhao.capacidade} T</td>
                    <td class="px-3 py-2 text-center">
                        <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${statusConfig.bg} ${statusConfig.text}">
                            <i class="fas ${statusConfig.icon} mr-1"></i>
                            ${statusConfig.texto}
                        </span>
                    </td>
                    <td class="px-3 py-2 text-center">
                        <div class="flex items-center justify-center space-x-2">
                            <button onclick="App.editCaminhao('${caminhao.id}')" class="text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 transition-colors" title="Editar">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button onclick="App.deleteCaminhao('${caminhao.id}')" class="text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300 transition-colors" title="Excluir">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                </tr>
            `;
        }).join('');
    },
    
    updateCaminhoesSelectors: function() {
        const caminhoes = DB.caminhoes.getAll();
        const caminhoesProprios = caminhoes.filter(c => c.tipo === 'proprio');
        const caminhoesTerceiros = caminhoes.filter(c => c.tipo === 'terceiro');
        
        // Atualizar seletores de metas próprios
        const selectorMetaProprio = document.getElementById('meta-caminhao-proprio-caminhao');
        if (selectorMetaProprio) {
            const currentValue = selectorMetaProprio.value;
            selectorMetaProprio.innerHTML = '<option value="">Selecione um caminhão próprio</option>' +
                caminhoesProprios.map(c => `<option value="${c.id}">${c.placa} - ${c.modelo}</option>`).join('');
            selectorMetaProprio.value = currentValue;
        }
        
        // Atualizar seletores de metas terceiros
        const selectorMetaTerceiro = document.getElementById('meta-caminhao-terceiro-caminhao');
        if (selectorMetaTerceiro) {
            const currentValue = selectorMetaTerceiro.value;
            selectorMetaTerceiro.innerHTML = '<option value="">Selecione um caminhão terceiro</option>' +
                caminhoesTerceiros.map(c => `<option value="${c.id}">${c.placa} - ${c.modelo}</option>`).join('');
            selectorMetaTerceiro.value = currentValue;
        }
    },
    
    saveCaminhao: function() {
        const form = document.getElementById('form-caminhao');
        
        if (!Utils.validateForm(form)) {
            Toast.show('Por favor, preencha todos os campos obrigatórios', 'error');
            return;
        }
        
        const caminhao = {
            placa: document.getElementById('caminhao-placa').value.trim().toUpperCase(),
            modelo: document.getElementById('caminhao-modelo').value.trim(),
            tipo: document.getElementById('caminhao-tipo').value,
            capacidade: parseFloat(document.getElementById('caminhao-capacidade').value),
            motorista: document.getElementById('caminhao-motorista').value.trim(),
            status: document.getElementById('caminhao-status').value,
            observacoes: document.getElementById('caminhao-observacoes').value.trim()
        };
        
        try {
            const editId = form.getAttribute('data-edit-id');
            
            if (editId) {
                caminhao.id = editId;
                DB.caminhoes.update(caminhao);
                Toast.show('Caminhão atualizado com sucesso', 'success');
                NotificationManager.add(`Caminhão ${caminhao.placa} atualizado`, 'info');
            } else {
                DB.caminhoes.add(caminhao);
                Toast.show('Caminhão cadastrado com sucesso', 'success');
                NotificationManager.add(`Novo caminhão ${caminhao.placa} cadastrado`, 'success');
            }
            
            this.clearCaminhaoForm();
            this.loadCaminhoes();
            
        } catch (error) {
            console.error('Erro ao salvar caminhão:', error);
            Toast.show('Erro ao salvar caminhão: ' + error.message, 'error');
        }
    },
    
    clearCaminhaoForm: function() {
        const form = document.getElementById('form-caminhao');
        form.reset();
        form.removeAttribute('data-edit-id');
        
        document.getElementById('btn-submit-caminhao-text').textContent = 'Salvar Caminhão';
        Utils.clearFormValidation(form);
    },
    
    editCaminhao: function(id) {
        const caminhao = DB.caminhoes.get(id);
        if (!caminhao) {
            Toast.show('Caminhão não encontrado', 'error');
            return;
        }
        
        document.getElementById('caminhao-placa').value = caminhao.placa;
        document.getElementById('caminhao-modelo').value = caminhao.modelo;
        document.getElementById('caminhao-tipo').value = caminhao.tipo;
        document.getElementById('caminhao-capacidade').value = caminhao.capacidade;
        document.getElementById('caminhao-motorista').value = caminhao.motorista || '';
        document.getElementById('caminhao-status').value = caminhao.status;
        document.getElementById('caminhao-observacoes').value = caminhao.observacoes || '';
        
        document.getElementById('form-caminhao').setAttribute('data-edit-id', id);
        document.getElementById('btn-submit-caminhao-text').textContent = 'Atualizar Caminhão';
        
        Toast.show('Caminhão carregado para edição', 'info');
    },
    
    deleteCaminhao: function(id) {
        const caminhao = DB.caminhoes.get(id);
        if (!caminhao) {
            Toast.show('Caminhão não encontrado', 'error');
            return;
        }
        
        this.showConfirmDialog(
            `Tem certeza que deseja excluir o caminhão "${caminhao.placa} - ${caminhao.modelo}"?`,
            () => {
                try {
                    DB.caminhoes.remove(id);
                    Toast.show('Caminhão excluído com sucesso', 'success');
                    NotificationManager.add(`Caminhão ${caminhao.placa} excluído`, 'warning');
                    this.loadCaminhoes();
                } catch (error) {
                    console.error('Erro ao excluir caminhão:', error);
                    Toast.show('Erro ao excluir caminhão: ' + error.message, 'error');
                }
            }
        );
    },
    
    // Metas de Caminhões Próprios
    initFormMetaCaminhaoProprio: function() {
        const form = document.getElementById('form-meta-caminhao-proprio');
        
        form.addEventListener('submit', (e) => {
            e.preventDefault();
            this.saveMetaCaminhaoProprio();
        });
    },
    
    loadMetasCaminhoesProprios: function() {
        this.updateCaminhoesSelectors();
        this.loadMetasCaminhoesPropriosTable();
    },
    
    loadMetasCaminhoesPropriosTable: function() {
        const metas = DB.metasCaminhoes.getByTipo('proprio');
        const tbody = document.getElementById('tabela-metas-caminhoes-proprios');
        
        if (metas.length === 0) {
            tbody.innerHTML = `
                <tr>
                    <td colspan="6" class="px-3 py-8 text-center text-gray-500 dark:text-gray-400">
                        <i class="fas fa-home mb-2 text-2xl"></i>
                        <div>Nenhuma meta de caminhão próprio cadastrada</div>
                    </td>
                </tr>
            `;
            return;
        }
        
        tbody.innerHTML = metas.map(meta => {
            const caminhao = DB.caminhoes.get(meta.caminhaoId);
            const caminhaoInfo = caminhao ? `${caminhao.placa} - ${caminhao.modelo}` : 'Caminhão não encontrado';
            const statusClass = new Date(meta.dataFim) >= new Date() ? 'text-green-600 dark:text-green-400' : 'text-red-600 dark:text-red-400';
            const statusText = new Date(meta.dataFim) >= new Date() ? 'Ativa' : 'Expirada';
            
            return `
                <tr class="hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                    <td class="px-3 py-2 text-sm font-medium text-gray-900 dark:text-white">${caminhaoInfo}</td>
                    <td class="px-3 py-2 text-sm text-gray-700 dark:text-gray-300">${meta.periodo}</td>
                    <td class="px-3 py-2 text-center text-sm text-gray-700 dark:text-gray-300">${meta.metaViagens}</td>
                    <td class="px-3 py-2 text-center text-sm font-medium text-gray-900 dark:text-white">${Utils.formatarToneladas(meta.metaToneladas)}</td>
                    <td class="px-3 py-2 text-center">
                        <span class="text-xs font-medium ${statusClass}">${statusText}</span>
                    </td>
                    <td class="px-3 py-2 text-center">
                        <div class="flex items-center justify-center space-x-2">
                            <button onclick="App.editMetaCaminhaoProprio('${meta.id}')" class="text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 transition-colors" title="Editar">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button onclick="App.deleteMetaCaminhaoProprio('${meta.id}')" class="text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300 transition-colors" title="Excluir">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                </tr>
            `;
        }).join('');
    },
    
    saveMetaCaminhaoProprio: function() {
        const form = document.getElementById('form-meta-caminhao-proprio');
        
        if (!Utils.validateForm(form)) {
            Toast.show('Por favor, preencha todos os campos obrigatórios', 'error');
            return;
        }
        
        const meta = {
            caminhaoId: document.getElementById('meta-caminhao-proprio-caminhao').value,
            tipo: 'proprio',
            periodo: document.getElementById('meta-caminhao-proprio-periodo').value,
            metaViagens: parseInt(document.getElementById('meta-caminhao-proprio-viagens').value),
            metaToneladas: parseFloat(document.getElementById('meta-caminhao-proprio-toneladas').value),
            dataInicio: document.getElementById('meta-caminhao-proprio-data-inicio').value,
            dataFim: document.getElementById('meta-caminhao-proprio-data-fim').value,
            observacoes: document.getElementById('meta-caminhao-proprio-observacoes').value.trim()
        };
        
        try {
            const editId = form.getAttribute('data-edit-id');
            
            if (editId) {
                meta.id = editId;
                DB.metasCaminhoes.update(meta);
                Toast.show('Meta de caminhão próprio atualizada com sucesso', 'success');
            } else {
                DB.metasCaminhoes.add(meta);
                Toast.show('Meta de caminhão próprio cadastrada com sucesso', 'success');
            }
            
            this.clearMetaCaminhaoProprioForm();
            this.loadMetasCaminhoesProprios();
            
        } catch (error) {
            console.error('Erro ao salvar meta de caminhão próprio:', error);
            Toast.show('Erro ao salvar meta: ' + error.message, 'error');
        }
    },
    
    clearMetaCaminhaoProprioForm: function() {
        const form = document.getElementById('form-meta-caminhao-proprio');
        form.reset();
        form.removeAttribute('data-edit-id');
        
        const hoje = Utils.getLocalDateString();
        document.getElementById('meta-caminhao-proprio-data-inicio').value = hoje;
        document.getElementById('meta-caminhao-proprio-data-fim').value = hoje;
        
        document.getElementById('btn-submit-meta-caminhao-proprio-text').textContent = 'Salvar Meta Próprio';
        Utils.clearFormValidation(form);
    },
    
    editMetaCaminhaoProprio: function(id) {
        const meta = DB.metasCaminhoes.get(id);
        if (!meta) {
            Toast.show('Meta não encontrada', 'error');
            return;
        }
        
        document.getElementById('meta-caminhao-proprio-caminhao').value = meta.caminhaoId;
        document.getElementById('meta-caminhao-proprio-periodo').value = meta.periodo;
        document.getElementById('meta-caminhao-proprio-viagens').value = meta.metaViagens;
        document.getElementById('meta-caminhao-proprio-toneladas').value = meta.metaToneladas;
        document.getElementById('meta-caminhao-proprio-data-inicio').value = meta.dataInicio;
        document.getElementById('meta-caminhao-proprio-data-fim').value = meta.dataFim;
        document.getElementById('meta-caminhao-proprio-observacoes').value = meta.observacoes || '';
        
        document.getElementById('form-meta-caminhao-proprio').setAttribute('data-edit-id', id);
        document.getElementById('btn-submit-meta-caminhao-proprio-text').textContent = 'Atualizar Meta Próprio';
        
        Toast.show('Meta de caminhão próprio carregada para edição', 'info');
    },
    
    deleteMetaCaminhaoProprio: function(id) {
        const meta = DB.metasCaminhoes.get(id);
        if (!meta) {
            Toast.show('Meta não encontrada', 'error');
            return;
        }
        
        const caminhao = DB.caminhoes.get(meta.caminhaoId);
        const caminhaoInfo = caminhao ? `${caminhao.placa} - ${caminhao.modelo}` : 'Caminhão não encontrado';
        
        this.showConfirmDialog(
            `Tem certeza que deseja excluir a meta do caminhão "${caminhaoInfo}"?`,
            () => {
                try {
                    DB.metasCaminhoes.remove(id);
                    Toast.show('Meta de caminhão próprio excluída com sucesso', 'success');
                    this.loadMetasCaminhoesProprios();
                } catch (error) {
                    console.error('Erro ao excluir meta:', error);
                    Toast.show('Erro ao excluir meta: ' + error.message, 'error');
                }
            }
        );
    },
    
    // Metas de Caminhões Terceiros
    initFormMetaCaminhaoTerceiro: function() {
        const form = document.getElementById('form-meta-caminhao-terceiro');
        
        form.addEventListener('submit', (e) => {
            e.preventDefault();
            this.saveMetaCaminhaoTerceiro();
        });
    },
    
    loadMetasCaminhoesTerceiros: function() {
        this.updateCaminhoesSelectors();
        this.loadMetasCaminhoesTerceirosTable();
    },
    
    loadMetasCaminhoesTerceirosTable: function() {
        const metas = DB.metasCaminhoes.getByTipo('terceiro');
        const tbody = document.getElementById('tabela-metas-caminhoes-terceiros');
        
        if (metas.length === 0) {
            tbody.innerHTML = `
                <tr>
                    <td colspan="6" class="px-3 py-8 text-center text-gray-500 dark:text-gray-400">
                        <i class="fas fa-handshake mb-2 text-2xl"></i>
                        <div>Nenhuma meta de caminhão terceiro cadastrada</div>
                    </td>
                </tr>
            `;
            return;
        }
        
        tbody.innerHTML = metas.map(meta => {
            const caminhao = DB.caminhoes.get(meta.caminhaoId);
            const caminhaoInfo = caminhao ? `${caminhao.placa} - ${caminhao.modelo}` : 'Caminhão não encontrado';
            const statusClass = new Date(meta.dataFim) >= new Date() ? 'text-green-600 dark:text-green-400' : 'text-red-600 dark:text-red-400';
            const statusText = new Date(meta.dataFim) >= new Date() ? 'Ativa' : 'Expirada';
            
            return `
                <tr class="hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                    <td class="px-3 py-2 text-sm font-medium text-gray-900 dark:text-white">${caminhaoInfo}</td>
                    <td class="px-3 py-2 text-sm text-gray-700 dark:text-gray-300">${meta.periodo}</td>
                    <td class="px-3 py-2 text-center text-sm text-gray-700 dark:text-gray-300">${meta.metaViagens}</td>
                    <td class="px-3 py-2 text-center text-sm font-medium text-gray-900 dark:text-white">${Utils.formatarToneladas(meta.metaToneladas)}</td>
                    <td class="px-3 py-2 text-center">
                        <span class="text-xs font-medium ${statusClass}">${statusText}</span>
                    </td>
                    <td class="px-3 py-2 text-center">
                        <div class="flex items-center justify-center space-x-2">
                            <button onclick="App.editMetaCaminhaoTerceiro('${meta.id}')" class="text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 transition-colors" title="Editar">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button onclick="App.deleteMetaCaminhaoTerceiro('${meta.id}')" class="text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300 transition-colors" title="Excluir">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                </tr>
            `;
        }).join('');
    },
    
    saveMetaCaminhaoTerceiro: function() {
        const form = document.getElementById('form-meta-caminhao-terceiro');
        
        if (!Utils.validateForm(form)) {
            Toast.show('Por favor, preencha todos os campos obrigatórios', 'error');
            return;
        }
        
        const meta = {
            caminhaoId: document.getElementById('meta-caminhao-terceiro-caminhao').value,
            tipo: 'terceiro',
            periodo: document.getElementById('meta-caminhao-terceiro-periodo').value,
            metaViagens: parseInt(document.getElementById('meta-caminhao-terceiro-viagens').value),
            metaToneladas: parseFloat(document.getElementById('meta-caminhao-terceiro-toneladas').value),
            dataInicio: document.getElementById('meta-caminhao-terceiro-data-inicio').value,
            dataFim: document.getElementById('meta-caminhao-terceiro-data-fim').value,
            observacoes: document.getElementById('meta-caminhao-terceiro-observacoes').value.trim()
        };
        
        try {
            const editId = form.getAttribute('data-edit-id');
            
            if (editId) {
                meta.id = editId;
                DB.metasCaminhoes.update(meta);
                Toast.show('Meta de caminhão terceiro atualizada com sucesso', 'success');
            } else {
                DB.metasCaminhoes.add(meta);
                Toast.show('Meta de caminhão terceiro cadastrada com sucesso', 'success');
            }
            
            this.clearMetaCaminhaoTerceiroForm();
            this.loadMetasCaminhoesTerceiros();
            
        } catch (error) {
            console.error('Erro ao salvar meta de caminhão terceiro:', error);
            Toast.show('Erro ao salvar meta: ' + error.message, 'error');
        }
    },
    
    clearMetaCaminhaoTerceiroForm: function() {
        const form = document.getElementById('form-meta-caminhao-terceiro');
        form.reset();
        form.removeAttribute('data-edit-id');
        
        const hoje = Utils.getLocalDateString();
        document.getElementById('meta-caminhao-terceiro-data-inicio').value = hoje;
        document.getElementById('meta-caminhao-terceiro-data-fim').value = hoje;
        
        document.getElementById('btn-submit-meta-caminhao-terceiro-text').textContent = 'Salvar Meta Terceiro';
        Utils.clearFormValidation(form);
    },
    
    editMetaCaminhaoTerceiro: function(id) {
        const meta = DB.metasCaminhoes.get(id);
        if (!meta) {
            Toast.show('Meta não encontrada', 'error');
            return;
        }
        
        document.getElementById('meta-caminhao-terceiro-caminhao').value = meta.caminhaoId;
        document.getElementById('meta-caminhao-terceiro-periodo').value = meta.periodo;
        document.getElementById('meta-caminhao-terceiro-viagens').value = meta.metaViagens;
        document.getElementById('meta-caminhao-terceiro-toneladas').value = meta.metaToneladas;
        document.getElementById('meta-caminhao-terceiro-data-inicio').value = meta.dataInicio;
        document.getElementById('meta-caminhao-terceiro-data-fim').value = meta.dataFim;
        document.getElementById('meta-caminhao-terceiro-observacoes').value = meta.observacoes || '';
        
        document.getElementById('form-meta-caminhao-terceiro').setAttribute('data-edit-id', id);
        document.getElementById('btn-submit-meta-caminhao-terceiro-text').textContent = 'Atualizar Meta Terceiro';
        
        Toast.show('Meta de caminhão terceiro carregada para edição', 'info');
    },
    
    deleteMetaCaminhaoTerceiro: function(id) {
        const meta = DB.metasCaminhoes.get(id);
        if (!meta) {
            Toast.show('Meta não encontrada', 'error');
            return;
        }
        
        const caminhao = DB.caminhoes.get(meta.caminhaoId);
        const caminhaoInfo = caminhao ? `${caminhao.placa} - ${caminhao.modelo}` : 'Caminhão não encontrado';
        
        this.showConfirmDialog(
            `Tem certeza que deseja excluir a meta do caminhão "${caminhaoInfo}"?`,
            () => {
                try {
                    DB.metasCaminhoes.remove(id);
                    Toast.show('Meta de caminhão terceiro excluída com sucesso', 'success');
                    this.loadMetasCaminhoesTerceiros();
                } catch (error) {
                    console.error('Erro ao excluir meta:', error);
                    Toast.show('Erro ao excluir meta: ' + error.message, 'error');
                }
            }
        );
    },
    
    // Acompanhamento de Caminhões
    loadAcompanhamentoCaminhoes: function() {
        this.loadAcompanhamentoCaminhoesTable();
        this.updateResumoCaminhoes();
    },
    
    updateResumoCaminhoes: function() {
        const caminhoes = DB.caminhoes.getAll();
        const caminhoesProprios = caminhoes.filter(c => c.status === 'ativo' && c.tipo === 'proprio').length;
        const caminhoesTerceiros = caminhoes.filter(c => c.status === 'ativo' && c.tipo === 'terceiro').length;
        
        // Simular dados de viagens e transporte (normalmente viria de outro sistema)
        const totalViagens = Math.floor(Math.random() * 200) + 100;
        const totalTransportado = Math.floor(Math.random() * 5000) + 3000;
        
        document.getElementById('resumo-caminhoes-proprios').textContent = caminhoesProprios;
        document.getElementById('resumo-caminhoes-terceiros').textContent = caminhoesTerceiros;
        document.getElementById('resumo-total-viagens').textContent = totalViagens;
        document.getElementById('resumo-total-transportado').textContent = Utils.formatarToneladas(totalTransportado);
    },
    
    loadAcompanhamentoCaminhoesTable: function() {
        const caminhoes = DB.caminhoes.getAtivos();
        const metas = DB.metasCaminhoes.getAtivas();
        const tbody = document.getElementById('tabela-acompanhamento-caminhoes');
        
        if (caminhoes.length === 0) {
            tbody.innerHTML = `
                <tr>
                    <td colspan="9" class="px-4 py-8 text-center text-gray-500 dark:text-gray-400">
                        <i class="fas fa-truck mb-2 text-2xl"></i>
                        <div>Nenhum caminhão ativo encontrado</div>
                    </td>
                </tr>
            `;
            return;
        }
        
        tbody.innerHTML = caminhoes.map(caminhao => {
            const metasCaminhao = metas.filter(m => m.caminhaoId === caminhao.id);
            const tipoConfig = Utils.getTipoConfig(caminhao.tipo);
            
            // Calcular performance (dados simulados)
            const metaViagens = metasCaminhao.reduce((sum, m) => sum + Number(m.metaViagens), 0);
            const metaToneladas = metasCaminhao.reduce((sum, m) => sum + Number(m.metaToneladas), 0);
            
            const viagensRealizadas = Math.floor(metaViagens * (0.8 + Math.random() * 0.4));
            const toneladasTransportadas = Math.floor(metaToneladas * (0.8 + Math.random() * 0.4));
            
            const performanceViagens = metaViagens > 0 ? (viagensRealizadas / metaViagens) * 100 : 0;
            const performanceToneladas = metaToneladas > 0 ? (toneladasTransportadas / metaToneladas) * 100 : 0;
            const performanceGeral = (performanceViagens + performanceToneladas) / 2;
            
            let statusPerformance = 'bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300';
            let statusText = 'Baixa';
            
            if (performanceGeral >= 90) {
                statusPerformance = 'bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300';
                statusText = 'Excelente';
            } else if (performanceGeral >= 70) {
                statusPerformance = 'bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300';
                statusText = 'Boa';
            } else if (performanceGeral >= 50) {
                statusPerformance = 'bg-yellow-100 dark:bg-yellow-900 text-yellow-700 dark:text-yellow-300';
                statusText = 'Regular';
            }
            
            return `
                <tr class="hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                    <td class="px-4 py-3 text-sm font-medium text-gray-900 dark:text-white">
                        <div>
                            <div class="font-medium">${caminhao.placa}</div>
                            <div class="text-xs text-gray-500 dark:text-gray-400">${caminhao.modelo}</div>
                        </div>
                    </td>
                    <td class="px-4 py-3 text-center">
                        <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${tipoConfig.bg} ${tipoConfig.text}">
                            <i class="fas ${tipoConfig.icon} mr-1"></i>
                            ${tipoConfig.texto}
                        </span>
                    </td>
                    <td class="px-4 py-3 text-center text-sm text-gray-700 dark:text-gray-300">
                        ${caminhao.motorista || '--'}
                    </td>
                    <td class="px-4 py-3 text-center text-sm font-medium text-purple-600 dark:text-purple-400">
                        ${metaViagens}
                    </td>
                    <td class="px-4 py-3 text-center text-sm font-medium text-blue-600 dark:text-blue-400">
                        ${viagensRealizadas}
                    </td>
                    <td class="px-4 py-3 text-center text-sm font-medium text-purple-600 dark:text-purple-400">
                        ${Utils.formatarToneladas(metaToneladas)}
                    </td>
                    <td class="px-4 py-3 text-center text-sm font-medium text-green-600 dark:text-green-400">
                        ${Utils.formatarToneladas(toneladasTransportadas)}
                    </td>
                    <td class="px-4 py-3 text-center text-sm font-bold text-indigo-600 dark:text-indigo-400">
                        ${performanceGeral.toFixed(1)}%
                    </td>
                    <td class="px-4 py-3 text-center">
                        <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${statusPerformance}">
                            ${statusText}
                        </span>
                    </td>
                </tr>
            `;
        }).join('');
    },
    
    exportarCaminhoes: function() {
        const caminhoes = DB.caminhoes.getAtivos();
        const metas = DB.metasCaminhoes.getAtivas();
        
        if (caminhoes.length === 0) {
            Toast.show('Nenhum caminhão para exportar', 'warning');
            return;
        }
        
        const dados = caminhoes.map(caminhao => {
            const metasCaminhao = metas.filter(m => m.caminhaoId === caminhao.id);
            const metaViagens = metasCaminhao.reduce((sum, m) => sum + Number(m.metaViagens), 0);
            const metaToneladas = metasCaminhao.reduce((sum, m) => sum + Number(m.metaToneladas), 0);
            
            return {
                ...caminhao,
                metaViagens,
                metaToneladas,
                capacidadeFormatada: `${caminhao.capacidade} T`
            };
        });
        
        const colunas = [
            { header: 'Placa', dataKey: 'placa' },
            { header: 'Modelo', dataKey: 'modelo' },
            { header: 'Tipo', dataKey: (item) => Utils.getTipoConfig(item.tipo).texto },
            { header: 'Capacidade', dataKey: 'capacidadeFormatada' },
            { header: 'Motorista', dataKey: 'motorista' },
            { header: 'Status', dataKey: (item) => Utils.getStatusConfig(item.status).texto },
            { header: 'Meta Viagens', dataKey: 'metaViagens' },
            { header: 'Meta Toneladas', dataKey: (item) => Utils.formatarToneladas(item.metaToneladas) },
            { header: 'Observações', dataKey: 'observacoes' }
        ];
        
        Utils.exportarPDF(
            'Relatório de Caminhões e Metas',
            dados,
            colunas,
            `relatorio-caminhoes-${new Date().toISOString().split('T')[0]}.pdf`
        );
    },
    
    // ===== FUNÇÕES UTILITÁRIAS =====
    
    showConfirmDialog: function(message, onConfirm) {
        // Criar modal de confirmação personalizado
        const modal = document.createElement('div');
        modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
        modal.innerHTML = `
            <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg max-w-sm w-full mx-4 animate-fade-in">
                <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Confirmação</h3>
                <p class="text-gray-700 dark:text-gray-300 mb-6">${message}</p>
                <div class="flex justify-end space-x-3">
                    <button id="confirm-cancel" class="px-4 py-2 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded transition-colors">
                        Cancelar
                    </button>
                    <button id="confirm-ok" class="px-4 py-2 bg-red-500 text-white hover:bg-red-600 rounded transition-colors">
                        Confirmar
                    </button>
                </div>
            </div>
        `;
        
        document.body.appendChild(modal);
        
        const cancelBtn = modal.querySelector('#confirm-cancel');
        const okBtn = modal.querySelector('#confirm-ok');
        
        const removeModal = () => {
            modal.classList.add('animate-fade-out');
            setTimeout(() => {
                if (modal.parentNode) {
                    modal.parentNode.removeChild(modal);
                }
            }, 300);
        };
        
        cancelBtn.addEventListener('click', removeModal);
        okBtn.addEventListener('click', () => {
            onConfirm();
            removeModal();
        });
        
        // Fechar ao clicar fora
        modal.addEventListener('click', (e) => {
            if (e.target === modal) {
                removeModal();
            }
        });
    },
    
    // Geração de Relatórios
    gerarRelatorioLiberacoes: function() {
        const liberacoes = DB.liberacoes.getAll();
        
        if (liberacoes.length === 0) {
            Toast.show('Nenhuma liberação para gerar relatório', 'warning');
            return;
        }
        
        const colunas = [
            { header: 'Data', dataKey: (item) => Utils.formatarData(item.data) },
            { header: 'Frente', dataKey: 'frente' },
            { header: 'Fazenda', dataKey: 'fazenda' },
            { header: 'Número', dataKey: 'numero' },
            { header: 'Status', dataKey: (item) => Utils.getStatusConfig(item.status).texto },
            { header: 'Previsto (T)', dataKey: (item) => Utils.formatarToneladas(item.previsto) },
            { header: 'Realizado (T)', dataKey: (item) => Utils.formatarToneladas(item.realizado) },
            { header: 'Restante (T)', dataKey: (item) => Utils.formatarToneladas(Number(item.previsto) - Number(item.realizado)) },
            { header: '% Execução', dataKey: (item) => `${((Number(item.realizado) / Number(item.previsto)) * 100).toFixed(1)}%` }
        ];
        
        Utils.exportarPDF(
            'Relatório Geral de Liberações',
            liberacoes,
            colunas,
            `relatorio-geral-liberacoes-${new Date().toISOString().split('T')[0]}.pdf`
        );
    },
    
    gerarRelatorioMetas: function() {
        const frentes = DB.frentes.getAll();
        const metas = DB.metas.getAll();
        const lancamentos = DB.lancamentos.getAll();
        
        const dados = frentes.map(frente => {
            const metasFrente = metas.filter(m => m.frenteId === frente.id);
            const lancamentosFrente = lancamentos.filter(l => l.frenteId === frente.id);
            
            const totalMeta = metasFrente.reduce((sum, m) => sum + Number(m.valor), 0);
            const totalColhido = lancamentosFrente.reduce((sum, l) => sum + Number(l.colhido), 0);
            const percentual = totalMeta > 0 ? (totalColhido / totalMeta) * 100 : 0;
            
            return {
                frente,
                totalMeta,
                totalColhido,
                percentual
            };
        });
        
        if (dados.length === 0) {
            Toast.show('Nenhum dado para gerar relatório de metas', 'warning');
            return;
        }
        
        const colunas = [
            { header: 'Frente', dataKey: (item) => item.frente.nome },
            { header: 'Fazenda', dataKey: (item) => item.frente.fazenda },
            { header: 'Tipo', dataKey: (item) => Utils.getTipoConfig(item.frente.tipo).texto },
            { header: 'Status', dataKey: (item) => Utils.getStatusConfig(item.frente.status).texto },
            { header: 'Meta Total (T)', dataKey: (item) => Utils.formatarToneladas(item.totalMeta) },
            { header: 'Colhido Total (T)', dataKey: (item) => Utils.formatarToneladas(item.totalColhido) },
            { header: '% Meta Atingida', dataKey: (item) => `${item.percentual.toFixed(1)}%` },
            { header: 'Responsável', dataKey: (item) => item.frente.responsavel || '--' }
        ];
        
        Utils.exportarPDF(
            'Relatório de Metas e Performance',
            dados,
            colunas,
            `relatorio-metas-performance-${new Date().toISOString().split('T')[0]}.pdf`
        );
    },
    
    gerarRelatorioColheita: function() {
        const lancamentos = DB.lancamentos.getAll()
            .sort((a, b) => new Date(b.data) - new Date(a.data));
        
        if (lancamentos.length === 0) {
            Toast.show('Nenhum lançamento para gerar relatório de colheita', 'warning');
            return;
        }
        
        const dados = lancamentos.map(lancamento => {
            const frente = DB.frentes.get(lancamento.frenteId);
            return {
                ...lancamento,
                frenteNome: frente ? frente.nome : 'Frente não encontrada',
                frenteFazenda: frente ? frente.fazenda : '--',
                frenteTipo: frente ? frente.tipo : 'desconhecido'
            };
        });
        
        const colunas = [
            { header: 'Data', dataKey: (item) => Utils.formatarData(item.data) },
            { header: 'Frente', dataKey: 'frenteNome' },
            { header: 'Fazenda', dataKey: 'frenteFazenda' },
            { header: 'Tipo Frente', dataKey: (item) => Utils.getTipoConfig(item.frenteTipo).texto },
            { header: 'Colhido (T)', dataKey: (item) => Utils.formatarToneladas(item.colhido) },
            { header: 'Turno', dataKey: 'turno' },
            { header: 'Operador', dataKey: 'operador' },
            { header: 'Observações', dataKey: 'observacoes' }
        ];
        
        Utils.exportarPDF(
            'Relatório de Colheita Diária',
            dados,
            colunas,
            `relatorio-colheita-diaria-${new Date().toISOString().split('T')[0]}.pdf`
        );
    },
    
    gerarRelatorioCaminhoes: function() {
        const caminhoes = DB.caminhoes.getAll();
        const metas = DB.metasCaminhoes.getAll();
        
        if (caminhoes.length === 0) {
            Toast.show('Nenhum caminhão para gerar relatório', 'warning');
            return;
        }
        
        const dados = caminhoes.map(caminhao => {
            const metasCaminhao = metas.filter(m => m.caminhaoId === caminhao.id);
            const totalMetaViagens = metasCaminhao.reduce((sum, m) => sum + Number(m.metaViagens), 0);
            const totalMetaToneladas = metasCaminhao.reduce((sum, m) => sum + Number(m.metaToneladas), 0);
            
            return {
                ...caminhao,
                totalMetaViagens,
                totalMetaToneladas
            };
        });
        
        const colunas = [
            { header: 'Placa', dataKey: 'placa' },
            { header: 'Modelo', dataKey: 'modelo' },
            { header: 'Tipo', dataKey: (item) => Utils.getTipoConfig(item.tipo).texto },
            { header: 'Capacidade (T)', dataKey: 'capacidade' },
            { header: 'Motorista', dataKey: 'motorista' },
            { header: 'Status', dataKey: (item) => Utils.getStatusConfig(item.status).texto },
            { header: 'Meta Viagens', dataKey: 'totalMetaViagens' },
            { header: 'Meta Toneladas', dataKey: (item) => Utils.formatarToneladas(item.totalMetaToneladas) },
            { header: 'Observações', dataKey: 'observacoes' }
        ];
        
        Utils.exportarPDF(
            'Relatório de Frota de Caminhões',
            dados,
            colunas,
            `relatorio-frota-caminhoes-${new Date().toISOString().split('T')[0]}.pdf`
        );
    }
};

// Inicialização da aplicação quando o DOM estiver carregado
document.addEventListener('DOMContentLoaded', function() {
    App.init();
});

// Expor App globalmente para chamadas de eventos
window.App = App;
</script>
</body>
</html>
