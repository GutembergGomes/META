<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GGOMES-LOG | Sistema de Gestão Agrícola Avançado</title>
    
    <!-- Tailwind CSS via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- jsPDF para relatórios -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://unpkg.com/jspdf-autotable@3.5.28/dist/jspdf.plugin.autotable.js"></script>
    
    <!-- Chart.js para gráficos -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <script>
    tailwind.config = {
        darkMode: 'class',
        theme: {
            extend: {
                colors: {
                    primary: {
                        50: '#f4f3ff',
                        100: '#e9e8ff',
                        200: '#d7d5ff',
                        300: '#bab8ff',
                        400: '#9a97ff',
                        500: '#7c7aff',
                        600: '#5D5CDE',
                        700: '#5a55cc',
                        800: '#4a46a8',
                        900: '#383670',
                        950: '#201f45',
                    }
                },
                fontFamily: {
                    'sans': ['Inter', 'system-ui', 'sans-serif'],
                },
                spacing: {
                    '128': '32rem',
                },
                animation: {
                    'fade-in': 'fadeIn 0.3s ease-out forwards',
                    'fade-out': 'fadeOut 0.3s ease-in forwards',
                    'slide-in': 'slideIn 0.3s ease-out forwards',
                    'pulse-slow': 'pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    'bounce-subtle': 'bounceSubtle 2s infinite',
                }
            }
        }
    }
    </script>
    
    <style>
        /* Animações customizadas */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes fadeOut {
            from { opacity: 1; transform: translateY(0); }
            to { opacity: 0; transform: translateY(-10px); }
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        @keyframes bounceSubtle {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-2px); }
        }
        
        /* Scrollbar personalizada */
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }
        
        .scrollbar-thin::-webkit-scrollbar { width: 6px; }
        .scrollbar-thin::-webkit-scrollbar-track { background: transparent; }
        .scrollbar-thin::-webkit-scrollbar-thumb {
            background-color: rgba(156, 163, 175, 0.5);
            border-radius: 3px;
        }
        .scrollbar-thin::-webkit-scrollbar-thumb:hover {
            background-color: rgba(156, 163, 175, 0.7);
        }
        
        /* Estados de carregamento */
        .loading { position: relative; }
        .loading::after {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(255, 255, 255, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: inherit;
            z-index: 10;
        }
        .dark .loading::after { background: rgba(0, 0, 0, 0.8); }
        
        /* Transições suaves */
        .transition-all-300 { transition: all 0.3s ease-in-out; }
        
        /* Efeitos hover personalizados */
        .hover-scale:hover { transform: scale(1.02); }
        
        /* Grid responsivo melhorado */
        .grid-responsive {
            display: grid;
            gap: 1rem;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        }
        
        /* Cards com sombra suave */
        .card-shadow {
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
        }
        .dark .card-shadow {
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.3), 0 1px 2px 0 rgba(0, 0, 0, 0.2);
        }
        
        /* Sidebar mobile melhorado */
        @media (max-width: 768px) {
            #app-container { position: relative; overflow-x: hidden; }
            #app-container aside {
                position: fixed;
                left: -100%;
                transition: left 0.3s cubic-bezier(0.4, 0, 0.2, 1);
                height: 100vh;
                z-index: 50;
                box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
            }
            #app-container.sidebar-open aside { left: 0; }
            #app-container.sidebar-open::before {
                content: '';
                position: fixed;
                top: 0; left: 0; right: 0; bottom: 0;
                background: rgba(0, 0, 0, 0.5);
                z-index: 40;
            }
        }
        
        /* Estados de formulário */
        .form-error {
            border-color: #ef4444 !important;
            box-shadow: 0 0 0 1px #ef4444 !important;
        }
        .form-success {
            border-color: #10b981 !important;
            box-shadow: 0 0 0 1px #10b981 !important;
        }
        
        /* Indicadores de progresso */
        .progress-bar { 
            transition: width 0.5s ease-in-out; 
            position: relative;
        }
        
        .progress-bar-animated::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            bottom: 0;
            right: 0;
            background-image: linear-gradient(45deg, rgba(255,255,255,.2) 25%, transparent 25%, transparent 50%, rgba(255,255,255,.2) 50%, rgba(255,255,255,.2) 75%, transparent 75%, transparent);
            background-size: 30px 30px;
            animation: progress-bar-stripes 1s linear infinite;
        }
        
        @keyframes progress-bar-stripes {
            0% { background-position: 30px 0; }
            100% { background-position: 0 0; }
        }
        
        /* Botões com estado loading */
        .btn-loading { position: relative; pointer-events: none; }
        .btn-loading::after {
            content: '';
            position: absolute;
            width: 16px; height: 16px;
            margin: auto;
            border: 2px solid transparent;
            border-top-color: currentColor;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Tooltip personalizado */
        .tooltip {
            position: relative;
            display: inline-block;
        }
        
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 200px;
            background-color: #374151;
            color: white;
            text-align: center;
            border-radius: 6px;
            padding: 8px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 12px;
        }
        
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }
        
        /* Alerta pulsante */
        .alert-pulse {
            animation: pulse 2s infinite;
        }
        
        /* Status indicators */
        .status-indicator {
            position: relative;
        }
        
        .status-indicator::before {
            content: '';
            position: absolute;
            top: -2px;
            right: -2px;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: #ef4444;
        }
        
        .status-indicator.status-success::before {
            background-color: #10b981;
        }
        
        .status-indicator.status-warning::before {
            background-color: #f59e0b;
        }
        
        /* Tabelas responsivas aprimoradas */
        .table-container {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }
        
        @media (max-width: 640px) {
            .table-container table {
                font-size: 0.75rem;
            }
            
            .table-container th,
            .table-container td {
                padding: 0.5rem 0.25rem;
            }
        }

        /* Gradientes personalizados para dashboard */
        .gradient-bg-success {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }
        
        .gradient-bg-warning {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        }
        
        .gradient-bg-danger {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
        }
        
        /* Efeitos de brilho */
        .glow-effect {
            box-shadow: 0 0 20px rgba(93, 92, 222, 0.3);
        }
        
        /* Animação de contador */
        .counter-animation {
            animation: countUp 1.5s ease-out forwards;
        }
        
        @keyframes countUp {
            from { transform: scale(0.5); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
    </style>
</head>
<body class="bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 min-h-screen">
    <!-- Container principal da aplicação -->
    <div id="app-container" class="flex h-screen overflow-hidden">
        <!-- Menu lateral (Sidebar) -->
        <aside class="w-64 hidden md:block bg-white dark:bg-gray-800 card-shadow z-10 flex-shrink-0">
            <div class="h-full flex flex-col">
                <!-- Logo e título -->
                <div class="p-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-center">
                    <div class="text-center">
                        <h1 class="text-xl font-bold text-primary-600 dark:text-primary-400">GGOMES-LOG</h1>
                        <p class="text-xs text-gray-500 dark:text-gray-400">Gestão Agrícola</p>
                    </div>
                </div>
                
                <!-- Informações do usuário -->
                <div class="p-4 border-b border-gray-200 dark:border-gray-700">
                    <div class="flex items-center">
                        <div class="h-10 w-10 rounded-full bg-primary-100 dark:bg-primary-900 flex items-center justify-center">
                            <i class="fas fa-user text-primary-600 dark:text-primary-400"></i>
                        </div>
                        <div class="ml-3">
                            <p id="sidebar-user-name" class="font-medium text-gray-800 dark:text-white">Administrador</p>
                            <p id="sidebar-user-role" class="text-xs text-gray-500 dark:text-gray-400">Administrador</p>
                        </div>
                    </div>
                </div>
                
                <!-- Links de navegação -->
                <div class="py-4 flex-1 overflow-y-auto scrollbar-thin">
                    <nav class="px-2 space-y-1">
                        <div class="px-3 py-2 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                            Dashboard
                        </div>
                        
                        <a href="#dashboard" class="sidebar-link active bg-primary-100 dark:bg-primary-900 text-primary-700 dark:text-primary-300 flex items-center px-4 py-2 rounded-md font-medium mb-1 transition-all-300">
                            <i class="fas fa-chart-pie mr-3 text-lg"></i>
                            <span>Dashboard</span>
                        </a>
                        
                        <a href="#acompanhamento" class="sidebar-link flex items-center px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md font-medium mb-1 transition-all-300">
                            <i class="fas fa-chart-line mr-3 text-lg"></i>
                            <span>Acompanhamento</span>
                        </a>
                        
                        <div class="px-3 py-2 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                            Produção
                        </div>
                        
                        <a href="#liberacoes" class="sidebar-link flex items-center px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md font-medium mb-1 transition-all-300">
                            <i class="fas fa-tasks mr-3 text-lg"></i>
                            <span>Liberações</span>
                        </a>
                        
                        <a href="#frentes" class="sidebar-link flex items-center px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md font-medium mb-1 transition-all-300">
                            <i class="fas fa-map-marked-alt mr-3 text-lg"></i>
                            <span>Frentes de Trabalho</span>
                        </a>

                        <a href="#metas" class="sidebar-link flex items-center px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md font-medium mb-1 transition-all-300">
                            <i class="fas fa-bullseye mr-3 text-lg"></i>
                            <span>Metas de Colheita</span>
                        </a>
                        
                        <div class="px-3 py-2 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                            Logística
                        </div>
                        
                        <a href="#caminhoes" class="sidebar-link flex items-center px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md font-medium mb-1 transition-all-300">
                            <i class="fas fa-truck mr-3 text-lg"></i>
                            <span>Metas de Caminhões</span>
                        </a>
                        
                        <div class="px-3 py-2 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                            Relatórios
                        </div>
                        
                        <a href="#relatorios" class="sidebar-link flex items-center px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md font-medium mb-1 transition-all-300">
                            <i class="fas fa-file-alt mr-3 text-lg"></i>
                            <span>Relatórios</span>
                        </a>
                        
                        <div class="px-3 py-2 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                            Sistema
                        </div>
                        
                        <a href="#configuracoes" class="sidebar-link flex items-center px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md font-medium mb-1 transition-all-300">
                            <i class="fas fa-cog mr-3 text-lg"></i>
                            <span>Configurações</span>
                        </a>
                    </nav>
                </div>
                
                <!-- Rodapé do sidebar -->
                <div class="p-4 border-t border-gray-200 dark:border-gray-700 text-center">
                    <p class="text-xs text-gray-500 dark:text-gray-400">GGOMES-LOG &copy; 2025</p>
                    <p class="text-xs text-gray-500 dark:text-gray-400">Versão 2.1 Avançada</p>
                </div>
            </div>
        </aside>
        
        <!-- Conteúdo principal -->
        <div class="flex-1 flex flex-col overflow-hidden">
            <!-- Barra superior (Header) -->
            <header class="bg-white dark:bg-gray-800 card-shadow z-10">
                <div class="flex items-center justify-between px-4 py-3 border-b border-gray-200 dark:border-gray-700">
                    <!-- Toggle do menu lateral (mobile) -->
                    <button id="mobile-menu-toggle" class="md:hidden p-2 rounded-md text-gray-500 hover:text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:text-gray-300 dark:hover:bg-gray-700 transition-all-300">
                        <i class="fas fa-bars"></i>
                    </button>
                    
                    <!-- Título da página -->
                    <div class="flex-1 text-center md:text-left">
                        <h2 id="page-title" class="text-lg font-semibold text-gray-800 dark:text-white">Dashboard</h2>
                        <p id="page-subtitle" class="text-sm text-gray-500 dark:text-gray-400 hidden md:block">Visão geral do sistema e indicadores principais</p>
                    </div>
                    
                    <!-- Ações e perfil do usuário -->
                    <div class="flex items-center space-x-3">
                        <!-- Busca rápida -->
                        <div class="hidden lg:block relative">
                            <input type="text" id="search-global" placeholder="Buscar..." class="pl-8 pr-3 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded-md bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-all-300">
                            <i class="fas fa-search absolute left-2.5 top-2 text-gray-400 text-xs"></i>
                        </div>
                        
                        <!-- Notificações -->
                        <button id="btn-notifications" class="relative p-2 rounded-md text-gray-500 hover:text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:text-gray-300 dark:hover:bg-gray-700 transition-all-300">
                            <i class="fas fa-bell"></i>
                            <span id="notification-badge" class="absolute -top-1 -right-1 h-4 w-4 bg-red-500 text-white rounded-full text-xs flex items-center justify-center hidden">0</span>
                        </button>
                        
                        <!-- Data atual -->
                        <div class="hidden sm:block mr-2">
                            <span id="current-date" class="text-sm text-gray-600 dark:text-gray-400">--/--/----</span>
                        </div>
                        
                        <!-- Toggle de tema claro/escuro -->
                        <button id="toggle-theme" class="p-2 rounded-md text-gray-500 hover:text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:text-gray-300 dark:hover:bg-gray-700 transition-all-300">
                            <i class="fas fa-moon dark:hidden"></i>
                            <i class="fas fa-sun hidden dark:inline-block"></i>
                        </button>
                        
                        <!-- Perfil do usuário -->
                        <div class="flex items-center">
                            <div class="mr-2 text-right hidden sm:block">
                                <div id="user-name" class="text-sm font-medium text-gray-800 dark:text-white">Administrador</div>
                                <div class="flex items-center">
                                    <span id="user-role-badge" class="px-2 py-1 rounded text-xs font-medium bg-primary-100 dark:bg-primary-900 text-primary-700 dark:text-primary-300">Admin</span>
                                </div>
                            </div>
                            <div class="h-8 w-8 rounded-full bg-primary-100 dark:bg-primary-900 flex items-center justify-center">
                                <i class="fas fa-user text-primary-600 dark:text-primary-400"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </header>
            <!-- Conteúdo principal -->
            <main class="flex-1 overflow-x-hidden overflow-y-auto bg-gray-100 dark:bg-gray-900 p-4">
                <!-- Toast container para mensagens -->
                <div id="toast-container" class="fixed top-4 right-4 z-50 space-y-4"></div>
                
                <!-- Loading overlay global -->
                <div id="loading-overlay" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
                    <div class="bg-white dark:bg-gray-800 rounded-lg p-6 flex items-center space-x-3">
                        <div class="animate-spin rounded-full h-6 w-6 border-b-2 border-primary-600"></div>
                        <span class="text-gray-700 dark:text-gray-300">Carregando...</span>
                    </div>
                </div>
                
                <!-- Conteúdo de Dashboard MELHORADO COM FILTROS -->
                <div id="content-dashboard" class="content">
                    <div class="mb-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <h2 class="text-3xl font-bold text-gray-800 dark:text-white mb-2">Dashboard Executivo</h2>
                                <p class="text-gray-600 dark:text-gray-400">Visão estratégica em tempo real - Indicadores chave de performance</p>
                            </div>
                            <div class="flex items-center space-x-3">
                                <div class="text-right">
                                    <div id="dash-status-geral" class="text-sm font-medium text-green-600 dark:text-green-400">Sistema Operacional</div>
                                    <div id="dash-ultima-atualizacao" class="text-xs text-gray-500 dark:text-gray-400">Atualizado agora</div>
                                </div>
                                <button id="btn-refresh-dashboard" class="p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-all-300">
                                    <i class="fas fa-sync-alt"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Alertas Críticos -->
                    <div id="dashboard-alertas" class="mb-6 hidden">
                        <div class="bg-gradient-to-r from-red-50 to-orange-50 dark:from-red-900/20 dark:to-orange-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4">
                            <div class="flex items-center mb-3">
                                <i class="fas fa-exclamation-triangle text-red-500 text-lg mr-2"></i>
                                <h3 class="text-lg font-semibold text-red-800 dark:text-red-300">Alertas Críticos</h3>
                            </div>
                            <div id="lista-alertas-criticos" class="space-y-2">
                                <!-- Preenchido dinamicamente -->
                            </div>
                        </div>
                    </div>
                    
                    <!-- KPIs Principais -->
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 xl:grid-cols-6 gap-4 mb-8">
                        <!-- Total Colhido -->
                        <div class="bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-900/30 dark:to-emerald-900/30 rounded-lg card-shadow p-6 hover-scale transition-all-300 border border-green-200 dark:border-green-800">
                            <div class="flex items-center justify-between mb-4">
                                <div class="p-3 rounded-full bg-green-100 dark:bg-green-900">
                                    <i class="fas fa-weight-hanging text-green-600 dark:text-green-400 text-xl"></i>
                                </div>
                                <div id="dash-colhido-trend" class="text-green-600 dark:text-green-400 text-sm">
                                    <i class="fas fa-arrow-up mr-1"></i>+5.2%
                                </div>
                            </div>
                            <div>
                                <p class="text-sm font-medium text-green-700 dark:text-green-300 mb-1">Total Colhido (30d)</p>
                                <p id="dash-total-colhido" class="text-2xl font-bold text-green-800 dark:text-green-200">0 T</p>
                                <p id="dash-colhido-meta" class="text-xs text-green-600 dark:text-green-400 mt-1">Meta: 0 T</p>
                            </div>
                        </div>
                        
                        <!-- Eficiência Geral -->
                        <div class="bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-900/30 dark:to-indigo-900/30 rounded-lg card-shadow p-6 hover-scale transition-all-300 border border-blue-200 dark:border-blue-800">
                            <div class="flex items-center justify-between mb-4">
                                <div class="p-3 rounded-full bg-blue-100 dark:bg-blue-900">
                                    <i class="fas fa-tachometer-alt text-blue-600 dark:text-blue-400 text-xl"></i>
                                </div>
                                <div id="dash-eficiencia-trend" class="text-blue-600 dark:text-blue-400 text-sm">
                                    <i class="fas fa-arrow-up mr-1"></i>+2.1%
                                </div>
                            </div>
                            <div>
                                <p class="text-sm font-medium text-blue-700 dark:text-blue-300 mb-1">Eficiência Geral</p>
                                <p id="dash-eficiencia-geral" class="text-2xl font-bold text-blue-800 dark:text-blue-200">92%</p>
                                <p class="text-xs text-blue-600 dark:text-blue-400 mt-1">Acima da meta de 85%</p>
                            </div>
                        </div>
                        
                        <!-- Frentes Operacionais -->
                        <div class="bg-gradient-to-br from-purple-50 to-violet-50 dark:from-purple-900/30 dark:to-violet-900/30 rounded-lg card-shadow p-6 hover-scale transition-all-300 border border-purple-200 dark:border-purple-800">
                            <div class="flex items-center justify-between mb-4">
                                <div class="p-3 rounded-full bg-purple-100 dark:bg-purple-900">
                                    <i class="fas fa-map-marker-alt text-purple-600 dark:text-purple-400 text-xl"></i>
                                </div>
                                <div class="flex items-center space-x-1">
                                    <div id="dash-frentes-status" class="w-2 h-2 bg-green-500 rounded-full"></div>
                                    <span class="text-xs text-purple-600 dark:text-purple-400">Online</span>
                                </div>
                            </div>
                            <div>
                                <p class="text-sm font-medium text-purple-700 dark:text-purple-300 mb-1">Frentes Ativas</p>
                                <p id="dash-frentes-ativas" class="text-2xl font-bold text-purple-800 dark:text-purple-200">0/0</p>
                                <p id="dash-frentes-info" class="text-xs text-purple-600 dark:text-purple-400 mt-1">Próprias + Terceiras</p>
                            </div>
                        </div>
                        
                        <!-- Metas Atingidas -->
                        <div class="bg-gradient-to-br from-orange-50 to-amber-50 dark:from-orange-900/30 dark:to-amber-900/30 rounded-lg card-shadow p-6 hover-scale transition-all-300 border border-orange-200 dark:border-orange-800">
                            <div class="flex items-center justify-between mb-4">
                                <div class="p-3 rounded-full bg-orange-100 dark:bg-orange-900">
                                    <i class="fas fa-bullseye text-orange-600 dark:text-orange-400 text-xl"></i>
                                </div>
                                <div id="dash-metas-progresso" class="text-orange-600 dark:text-orange-400 text-sm">
                                    87%
                                </div>
                            </div>
                            <div>
                                <p class="text-sm font-medium text-orange-700 dark:text-orange-300 mb-1">Metas Atingidas</p>
                                <p id="dash-metas-atingidas" class="text-2xl font-bold text-orange-800 dark:text-orange-200">0/0</p>
                                <p class="text-xs text-orange-600 dark:text-orange-400 mt-1">Este mês</p>
                            </div>
                        </div>
                        
                        <!-- Caminhões Ativos -->
                        <div class="bg-gradient-to-br from-teal-50 to-cyan-50 dark:from-teal-900/30 dark:to-cyan-900/30 rounded-lg card-shadow p-6 hover-scale transition-all-300 border border-teal-200 dark:border-teal-800">
                            <div class="flex items-center justify-between mb-4">
                                <div class="p-3 rounded-full bg-teal-100 dark:bg-teal-900">
                                    <i class="fas fa-truck text-teal-600 dark:text-teal-400 text-xl"></i>
                                </div>
                                <div id="dash-caminhoes-trend" class="text-teal-600 dark:text-teal-400 text-sm">
                                    Operacional
                                </div>
                            </div>
                            <div>
                                <p class="text-sm font-medium text-teal-700 dark:text-teal-300 mb-1">Caminhões Ativos</p>
                                <p id="dash-caminhoes-ativos" class="text-2xl font-bold text-teal-800 dark:text-teal-200">0/0</p>
                                <p id="dash-caminhoes-info" class="text-xs text-teal-600 dark:text-teal-400 mt-1">Próprios + Terceiros</p>
                            </div>
                        </div>
                        
                        <!-- Liberações Ativas -->
                        <div class="bg-gradient-to-br from-rose-50 to-pink-50 dark:from-rose-900/30 dark:to-pink-900/30 rounded-lg card-shadow p-6 hover-scale transition-all-300 border border-rose-200 dark:border-rose-800">
                            <div class="flex items-center justify-between mb-4">
                                <div class="p-3 rounded-full bg-rose-100 dark:bg-rose-900">
                                    <i class="fas fa-tasks text-rose-600 dark:text-rose-400 text-xl"></i>
                                </div>
                                <div id="dash-liberacoes-status" class="text-rose-600 dark:text-rose-400 text-sm">
                                    Ativo
                                </div>
                            </div>
                            <div>
                                <p class="text-sm font-medium text-rose-700 dark:text-rose-300 mb-1">Liberações</p>
                                <p id="dash-total-liberacoes" class="text-2xl font-bold text-rose-800 dark:text-rose-200">0</p>
                                <p id="dash-liberacoes-info" class="text-xs text-rose-600 dark:text-rose-400 mt-1">Abertas + Em Andamento</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Gráficos Principais COM FILTROS IMPLEMENTADOS -->
                    <div class="grid grid-cols-1 xl:grid-cols-3 gap-6 mb-8">
                        <!-- Evolução da Colheita COM FILTROS -->
                        <div class="xl:col-span-2 bg-white dark:bg-gray-800 rounded-lg card-shadow p-6">
                            <div class="flex items-center justify-between mb-4">
                                <div>
                                    <h3 class="text-lg font-semibold text-gray-800 dark:text-white">Evolução da Colheita</h3>
                                    <p class="text-sm text-gray-500 dark:text-gray-400">Comparativo com metas - Período personalizável</p>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <button id="btn-toggle-chart-filters" class="text-xs px-3 py-1 bg-primary-600 hover:bg-primary-700 text-white rounded-lg transition-all-300">
                                        <i class="fas fa-filter mr-1"></i> Filtros
                                    </button>
                                    <button id="btn-refresh-chart" class="text-xs px-3 py-1 text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-all-300">
                                        <i class="fas fa-sync-alt"></i>
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Filtros do Gráfico -->
                            <div id="chart-filters" class="mb-4 p-4 bg-gray-50 dark:bg-gray-700 rounded-lg hidden">
                                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-3">
                                    <div>
                                        <label class="block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1">Data Início</label>
                                        <input type="date" id="chart-data-inicio" class="w-full text-xs p-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-all-300">
                                    </div>
                                    <div>
                                        <label class="block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1">Data Fim</label>
                                        <input type="date" id="chart-data-fim" class="w-full text-xs p-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-all-300">
                                    </div>
                                    <div>
                                        <label class="block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1">Frente (Opcional)</label>
                                        <select id="chart-frente-filter" class="w-full text-xs p-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-all-300">
                                            <option value="">Todas as frentes</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center space-x-2">
                                        <button id="btn-chart-7d" class="text-xs px-3 py-1 bg-gray-200 hover:bg-gray-300 dark:bg-gray-600 dark:hover:bg-gray-500 text-gray-700 dark:text-gray-300 rounded-md transition-all-300">7 dias</button>
                                        <button id="btn-chart-30d" class="text-xs px-3 py-1 bg-primary-100 dark:bg-primary-900 text-primary-700 dark:text-primary-300 rounded-md transition-all-300">30 dias</button>
                                        <button id="btn-chart-90d" class="text-xs px-3 py-1 bg-gray-200 hover:bg-gray-300 dark:bg-gray-600 dark:hover:bg-gray-500 text-gray-700 dark:text-gray-300 rounded-md transition-all-300">90 dias</button>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <button id="btn-clear-chart-filters" class="text-xs px-3 py-1 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 transition-colors">Limpar</button>
                                        <button id="btn-apply-chart-filters" class="text-xs px-3 py-1 bg-primary-600 hover:bg-primary-700 text-white rounded-md transition-all-300">Aplicar</button>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="h-80">
                                <canvas id="chart-evolucao-colheita"></canvas>
                            </div>
                        </div>
                        
                        <!-- Performance das Frentes -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg card-shadow p-6">
                            <div class="flex items-center justify-between mb-6">
                                <div>
                                    <h3 class="text-lg font-semibold text-gray-800 dark:text-white">Performance das Frentes</h3>
                                    <p class="text-sm text-gray-500 dark:text-gray-400">% Meta atingida</p>
                                </div>
                                <i class="fas fa-chart-bar text-gray-400"></i>
                            </div>
                            <div class="h-80">
                                <canvas id="chart-performance-frentes"></canvas>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Gráficos Secundários -->
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
                        <!-- Status das Liberações -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg card-shadow p-6">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-semibold text-gray-800 dark:text-white">Status das Liberações</h3>
                                <div class="flex items-center space-x-2">
                                    <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                                    <span class="text-xs text-gray-500">Real-time</span>
                                </div>
                            </div>
                            <div class="h-48">
                                <canvas id="chart-liberacoes-status"></canvas>
                            </div>
                        </div>
                        
                        <!-- Performance de Caminhões -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg card-shadow p-6">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-semibold text-gray-800 dark:text-white">Performance Caminhões</h3>
                                <i class="fas fa-truck text-gray-400"></i>
                            </div>
                            <div class="h-48">
                                <canvas id="chart-caminhoes-performance"></canvas>
                            </div>
                        </div>
                        
                        <!-- Eficiência por Turno -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg card-shadow p-6">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-semibold text-gray-800 dark:text-white">Eficiência por Turno</h3>
                                <i class="fas fa-clock text-gray-400"></i>
                            </div>
                            <div class="h-48">
                                <canvas id="chart-eficiencia-turno"></canvas>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Tabelas de Detalhes -->
                    <div class="grid grid-cols-1 xl:grid-cols-2 gap-6 mb-6">
                        <!-- Top 5 Frentes Performance -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg card-shadow p-6">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-semibold text-gray-800 dark:text-white">🏆 Top Performance</h3>
                                <span class="text-xs px-2 py-1 bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300 rounded-full">Este mês</span>
                            </div>
                            <div class="space-y-3">
                                <div id="dash-top-frentes" class="space-y-3">
                                    <!-- Preenchido dinamicamente -->
                                </div>
                            </div>
                        </div>
                        
                        <!-- Atividade Recente -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg card-shadow p-6">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-semibold text-gray-800 dark:text-white">📈 Atividade Recente</h3>
                                <span class="text-xs text-gray-500 dark:text-gray-400">Últimas 24h</span>
                            </div>
                            <div class="space-y-3 max-h-64 overflow-y-auto scrollbar-thin">
                                <div id="dash-atividade-recente" class="space-y-3">
                                    <!-- Preenchido dinamicamente -->
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Resumo Executivo -->
                    <div class="bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-700 rounded-lg card-shadow p-6 border border-gray-200 dark:border-gray-600">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-lg font-semibold text-gray-800 dark:text-white">💼 Resumo Executivo</h3>
                            <div class="flex items-center space-x-2">
                                <div class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></div>
                                <span class="text-xs text-gray-500 dark:text-gray-400">Atualização automática</span>
                            </div>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                            <div>
                                <h4 class="font-medium text-gray-700 dark:text-gray-300 mb-2">📊 Performance Geral</h4>
                                <p id="dash-resumo-performance" class="text-sm text-gray-600 dark:text-gray-400">
                                    Sistema operando com eficiência de 92%, superando a meta estabelecida.
                                </p>
                            </div>
                            <div>
                                <h4 class="font-medium text-gray-700 dark:text-gray-300 mb-2">⚠️ Pontos de Atenção</h4>
                                <div id="dash-resumo-alertas" class="text-sm text-gray-600 dark:text-gray-400">
                                    Todas as frentes operando dentro dos parâmetros normais.
                                </div>
                            </div>
                            <div>
                                <h4 class="font-medium text-gray-700 dark:text-gray-300 mb-2">🎯 Próximas Ações</h4>
                                <div id="dash-resumo-acoes" class="text-sm text-gray-600 dark:text-gray-400">
                                    Manter ritmo atual para atingir metas mensais.
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Conteúdo de Acompanhamento COMPLETO ORIGINAL -->
                <div id="content-acompanhamento" class="content hidden">
                    <div class="mb-6">
                        <div class="flex flex-col md:flex-row md:items-center justify-between">
                            <div class="mb-4 md:mb-0">
                                <h2 class="text-3xl font-bold text-gray-800 dark:text-white mb-2">Acompanhamento de Colheita</h2>
                                <p class="text-gray-600 dark:text-gray-400">Monitoramento detalhado das operações - Performance em tempo real</p>
                            </div>
                            <div class="flex items-center space-x-3">
                                <button id="btn-auto-refresh-acompanhamento" class="px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg font-medium transition-all-300 flex items-center">
                                    <i class="fas fa-sync-alt mr-2"></i>
                                    Auto-refresh OFF
                                </button>
                                <button id="btn-export-acompanhamento" class="px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-medium transition-all-300 flex items-center">
                                    <i class="fas fa-download mr-2"></i>
                                    Exportar
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Indicadores de Performance -->
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8">
                        <!-- Performance Geral -->
                        <div class="bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-900/30 dark:to-indigo-900/30 rounded-lg card-shadow p-6 border border-blue-200 dark:border-blue-800">
                            <div class="flex items-center justify-between mb-4">
                                <div class="p-3 rounded-full bg-blue-100 dark:bg-blue-900">
                                    <i class="fas fa-chart-line text-blue-600 dark:text-blue-400 text-xl"></i>
                                </div>
                                <div id="acomp-performance-trend" class="text-blue-600 dark:text-blue-400 text-sm font-medium">
                                    +8.5%
                                </div>
                            </div>
                            <div>
                                <p class="text-sm font-medium text-blue-700 dark:text-blue-300 mb-1">Performance Geral</p>
                                <p id="acomp-performance-geral" class="text-3xl font-bold text-blue-800 dark:text-blue-200">94.2%</p>
                                <p class="text-xs text-blue-600 dark:text-blue-400 mt-1">Meta: 85%</p>
                            </div>
                        </div>

                        <!-- Colheita Hoje -->
                        <div class="bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-900/30 dark:to-emerald-900/30 rounded-lg card-shadow p-6 border border-green-200 dark:border-green-800">
                            <div class="flex items-center justify-between mb-4">
                                <div class="p-3 rounded-full bg-green-100 dark:bg-green-900">
                                    <i class="fas fa-seedling text-green-600 dark:text-green-400 text-xl"></i>
                                </div>
                                <div id="acomp-colheita-status" class="text-green-600 dark:text-green-400 text-sm font-medium">
                                    Em Andamento
                                </div>
                            </div>
                            <div>
                                <p class="text-sm font-medium text-green-700 dark:text-green-300 mb-1">Colheita Hoje</p>
                                <p id="acomp-colheita-hoje" class="text-3xl font-bold text-green-800 dark:text-green-200">0 T</p>
                                <p id="acomp-colheita-meta-hoje" class="text-xs text-green-600 dark:text-green-400 mt-1">Meta: 0 T</p>
                            </div>
                        </div>

                        <!-- Frentes Ativas -->
                        <div class="bg-gradient-to-br from-purple-50 to-violet-50 dark:from-purple-900/30 dark:to-violet-900/30 rounded-lg card-shadow p-6 border border-purple-200 dark:border-purple-800">
                            <div class="flex items-center justify-between mb-4">
                                <div class="p-3 rounded-full bg-purple-100 dark:bg-purple-900">
                                    <i class="fas fa-layer-group text-purple-600 dark:text-purple-400 text-xl"></i>
                                </div>
                                <div class="flex items-center space-x-1">
                                    <div id="acomp-frentes-indicator" class="w-2 h-2 bg-green-500 rounded-full"></div>
                                    <span class="text-xs text-purple-600 dark:text-purple-400">Online</span>
                                </div>
                            </div>
                            <div>
                                <p class="text-sm font-medium text-purple-700 dark:text-purple-300 mb-1">Frentes Ativas</p>
                                <p id="acomp-frentes-ativas" class="text-3xl font-bold text-purple-800 dark:text-purple-200">0/0</p>
                                <p id="acomp-frentes-detalhes" class="text-xs text-purple-600 dark:text-purple-400 mt-1">Próprias e Terceiras</p>
                            </div>
                        </div>

                        <!-- Eficiência Média -->
                        <div class="bg-gradient-to-br from-orange-50 to-amber-50 dark:from-orange-900/30 dark:to-amber-900/30 rounded-lg card-shadow p-6 border border-orange-200 dark:border-orange-800">
                            <div class="flex items-center justify-between mb-4">
                                <div class="p-3 rounded-full bg-orange-100 dark:bg-orange-900">
                                    <i class="fas fa-gauge-high text-orange-600 dark:text-orange-400 text-xl"></i>
                                </div>
                                <div id="acomp-eficiencia-trend" class="text-orange-600 dark:text-orange-400 text-sm font-medium">
                                    +12.3%
                                </div>
                            </div>
                            <div>
                                <p class="text-sm font-medium text-orange-700 dark:text-orange-300 mb-1">Eficiência Média</p>
                                <p id="acomp-eficiencia-media" class="text-3xl font-bold text-orange-800 dark:text-orange-200">87.9%</p>
                                <p class="text-xs text-orange-600 dark:text-orange-400 mt-1">Últimos 7 dias</p>
                            </div>
                        </div>
                    </div>

                    <!-- Filtros e Controles -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg card-shadow p-6 mb-6">
                        <div class="flex flex-col lg:flex-row lg:items-center justify-between space-y-4 lg:space-y-0">
                            <div class="flex flex-col sm:flex-row sm:items-center space-y-3 sm:space-y-0 sm:space-x-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Filtrar por Frente</label>
                                    <select id="filtro-frente-acomp" class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-all-300">
                                        <option value="">Todas as frentes</option>
                                    </select>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Filtrar por Fazenda</label>
                                    <select id="filtro-fazenda-acomp" class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-all-300">
                                        <option value="">Todas as fazendas</option>
                                    </select>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Período</label>
                                    <select id="filtro-periodo-acomp" class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-all-300">
                                        <option value="hoje">Hoje</option>
                                        <option value="ontem">Ontem</option>
                                        <option value="7dias">Últimos 7 dias</option>
                                        <option value="30dias">Últimos 30 dias</option>
                                        <option value="personalizado">Período personalizado</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="flex items-center space-x-3">
                                <button id="btn-limpar-filtros-acomp" class="px-4 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 border border-gray-300 dark:border-gray-600 hover:border-gray-400 dark:hover:border-gray-500 rounded-lg transition-all-300">
                                    Limpar Filtros
                                </button>
                                <button id="btn-aplicar-filtros-acomp" class="px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg font-medium transition-all-300">
                                    Aplicar Filtros
                                </button>
                            </div>
                        </div>
                        
                        <!-- Período personalizado (inicialmente oculto) -->
                        <div id="periodo-personalizado-acomp" class="mt-4 pt-4 border-t border-gray-200 dark:border-gray-600 hidden">
                            <div class="flex flex-col sm:flex-row sm:items-end space-y-3 sm:space-y-0 sm:space-x-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Data de Início</label>
                                    <input type="date" id="data-inicio-acomp" class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-all-300">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Data de Fim</label>
                                    <input type="date" id="data-fim-acomp" class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-all-300">
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Tabela de Acompanhamento -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg card-shadow overflow-hidden">
                        <div class="p-6 border-b border-gray-200 dark:border-gray-700">
                            <div class="flex flex-col sm:flex-row sm:items-center justify-between">
                                <div>
                                    <h3 class="text-lg font-semibold text-gray-800 dark:text-white">Detalhamento por Frente</h3>
                                    <p class="text-sm text-gray-500 dark:text-gray-400 mt-1">Performance detalhada e comparativo com metas</p>
                                </div>
                                <div class="flex items-center space-x-3 mt-4 sm:mt-0">
                                    <div class="text-sm text-gray-500 dark:text-gray-400">
                                        <span id="acomp-total-registros">0</span> registro(s) encontrado(s)
                                    </div>
                                    <button id="btn-refresh-acomp" class="p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-all-300">
                                        <i class="fas fa-sync-alt"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="table-container">
                            <table class="w-full">
                                <thead class="bg-gray-50 dark:bg-gray-700">
                                    <tr>
                                        <th class="px-6 py-4 text-left">
                                            <button class="flex items-center space-x-1 text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider hover:text-gray-700 dark:hover:text-gray-300 transition-colors" onclick="App.sortAcompanhamento('frente')">
                                                <span>Frente</span>
                                                <i class="fas fa-sort text-xs"></i>
                                            </button>
                                        </th>
                                        <th class="px-6 py-4 text-left">
                                            <button class="flex items-center space-x-1 text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider hover:text-gray-700 dark:hover:text-gray-300 transition-colors" onclick="App.sortAcompanhamento('fazenda')">
                                                <span>Fazenda</span>
                                                <i class="fas fa-sort text-xs"></i>
                                            </button>
                                        </th>
                                        <th class="px-6 py-4 text-left">
                                            <button class="flex items-center space-x-1 text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider hover:text-gray-700 dark:hover:text-gray-300 transition-colors" onclick="App.sortAcompanhamento('colhido')">
                                                <span>Colhido</span>
                                                <i class="fas fa-sort text-xs"></i>
                                            </button>
                                        </th>
                                        <th class="px-6 py-4 text-left">
                                            <button class="flex items-center space-x-1 text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider hover:text-gray-700 dark:hover:text-gray-300 transition-colors" onclick="App.sortAcompanhamento('meta')">
                                                <span>Meta</span>
                                                <i class="fas fa-sort text-xs"></i>
                                            </button>
                                        </th>
                                        <th class="px-6 py-4 text-left">
                                            <button class="flex items-center space-x-1 text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider hover:text-gray-700 dark:hover:text-gray-300 transition-colors" onclick="App.sortAcompanhamento('percentualMeta')">
                                                <span>% Meta</span>
                                                <i class="fas fa-sort text-xs"></i>
                                            </button>
                                        </th>
                                        <th class="px-6 py-4 text-left">
                                            <span class="text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Status</span>
                                        </th>
                                        <th class="px-6 py-4 text-left">
                                            <button class="flex items-center space-x-1 text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider hover:text-gray-700 dark:hover:text-gray-300 transition-colors" onclick="App.sortAcompanhamento('ultimaAtualizacao')">
                                                <span>Última Atualização</span>
                                                <i class="fas fa-sort text-xs"></i>
                                            </button>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody id="tabela-acompanhamento" class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                    <!-- Dados preenchidos via JavaScript -->
                                </tbody>
                            </table>
                        </div>
                        
                        <!-- Paginação -->
                        <div id="paginacao-acompanhamento" class="px-6 py-4 bg-gray-50 dark:bg-gray-700 border-t border-gray-200 dark:border-gray-600">
                            <!-- Paginação preenchida via JavaScript -->
                        </div>
                    </div>
                </div>
                <!-- Conteúdo de Liberações COMPLETO ORIGINAL -->
                <div id="content-liberacoes" class="content hidden">
                    <div class="mb-6">
                        <div class="flex flex-col md:flex-row md:items-center justify-between">
                            <div class="mb-4 md:mb-0">
                                <h2 class="text-3xl font-bold text-gray-800 dark:text-white mb-2">Liberações de Colheita</h2>
                                <p class="text-gray-600 dark:text-gray-400">Gestão completa das liberações - Controle de produção</p>
                            </div>
                            <div class="flex items-center space-x-3">
                                <button id="btn-nova-liberacao" class="px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg font-medium transition-all-300 flex items-center">
                                    <i class="fas fa-plus mr-2"></i>
                                    Nova Liberação
                                </button>
                                <button id="btn-importar-liberacoes" class="px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-medium transition-all-300 flex items-center">
                                    <i class="fas fa-upload mr-2"></i>
                                    Importar
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Cards de Resumo -->
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                        <div class="bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-900/30 dark:to-indigo-900/30 rounded-lg card-shadow p-6 border border-blue-200 dark:border-blue-800">
                            <div class="flex items-center">
                                <div class="p-3 rounded-full bg-blue-100 dark:bg-blue-900 mr-4">
                                    <i class="fas fa-folder-open text-blue-600 dark:text-blue-400 text-xl"></i>
                                </div>
                                <div>
                                    <p class="text-sm font-medium text-blue-700 dark:text-blue-300">Liberações Abertas</p>
                                    <p id="total-abertas" class="text-2xl font-bold text-blue-800 dark:text-blue-200">0</p>
                                </div>
                            </div>
                        </div>

                        <div class="bg-gradient-to-br from-yellow-50 to-orange-50 dark:from-yellow-900/30 dark:to-orange-900/30 rounded-lg card-shadow p-6 border border-yellow-200 dark:border-yellow-800">
                            <div class="flex items-center">
                                <div class="p-3 rounded-full bg-yellow-100 dark:bg-yellow-900 mr-4">
                                    <i class="fas fa-clock text-yellow-600 dark:text-yellow-400 text-xl"></i>
                                </div>
                                <div>
                                    <p class="text-sm font-medium text-yellow-700 dark:text-yellow-300">Em Andamento</p>
                                    <p id="total-andamento" class="text-2xl font-bold text-yellow-800 dark:text-yellow-200">0</p>
                                </div>
                            </div>
                        </div>

                        <div class="bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-900/30 dark:to-emerald-900/30 rounded-lg card-shadow p-6 border border-green-200 dark:border-green-800">
                            <div class="flex items-center">
                                <div class="p-3 rounded-full bg-green-100 dark:bg-green-900 mr-4">
                                    <i class="fas fa-check-circle text-green-600 dark:text-green-400 text-xl"></i>
                                </div>
                                <div>
                                    <p class="text-sm font-medium text-green-700 dark:text-green-300">Concluídas</p>
                                    <p id="total-concluidas" class="text-2xl font-bold text-green-800 dark:text-green-200">0</p>
                                </div>
                            </div>
                        </div>

                        <div class="bg-gradient-to-br from-purple-50 to-violet-50 dark:from-purple-900/30 dark:to-violet-900/30 rounded-lg card-shadow p-6 border border-purple-200 dark:border-purple-800">
                            <div class="flex items-center">
                                <div class="p-3 rounded-full bg-purple-100 dark:bg-purple-900 mr-4">
                                    <i class="fas fa-weight-hanging text-purple-600 dark:text-purple-400 text-xl"></i>
                                </div>
                                <div>
                                    <p class="text-sm font-medium text-purple-700 dark:text-purple-300">Total Previsto</p>
                                    <p id="total-previsto" class="text-2xl font-bold text-purple-800 dark:text-purple-200">0 T</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Filtros -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg card-shadow p-6 mb-6">
                        <div class="flex flex-col lg:flex-row lg:items-center justify-between space-y-4 lg:space-y-0">
                            <div class="flex flex-col sm:flex-row sm:items-center space-y-3 sm:space-y-0 sm:space-x-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Filtrar por Frente</label>
                                    <select id="filtro-frente-lib" class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-all-300">
                                        <option value="">Todas as frentes</option>
                                    </select>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Filtrar por Status</label>
                                    <select id="filtro-status-lib" class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-all-300">
                                        <option value="">Todos os status</option>
                                        <option value="aberto">Aberto</option>
                                        <option value="em-andamento">Em Andamento</option>
                                        <option value="fechado">Fechado</option>
                                        <option value="cancelado">Cancelado</option>
                                    </select>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Filtrar por Fazenda</label>
                                    <select id="filtro-fazenda-lib" class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-all-300">
                                        <option value="">Todas as fazendas</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="flex items-center space-x-3">
                                <button id="btn-limpar-filtros-lib" class="px-4 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 border border-gray-300 dark:border-gray-600 hover:border-gray-400 dark:hover:border-gray-500 rounded-lg transition-all-300">
                                    Limpar Filtros
                                </button>
                                <button id="btn-aplicar-filtros-lib" class="px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg font-medium transition-all-300">
                                    Aplicar Filtros
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Tabela de Liberações -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg card-shadow overflow-hidden">
                        <div class="p-6 border-b border-gray-200 dark:border-gray-700">
                            <div class="flex flex-col sm:flex-row sm:items-center justify-between">
                                <div>
                                    <h3 class="text-lg font-semibold text-gray-800 dark:text-white">Lista de Liberações</h3>
                                    <p class="text-sm text-gray-500 dark:text-gray-400 mt-1">Controle detalhado de todas as liberações</p>
                                </div>
                                <div class="flex items-center space-x-3 mt-4 sm:mt-0">
                                    <div class="text-sm text-gray-500 dark:text-gray-400">
                                        <span id="total-liberacoes">0</span> liberação(ões) encontrada(s)
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="table-container">
                            <table class="w-full">
                                <thead class="bg-gray-50 dark:bg-gray-700">
                                    <tr>
                                        <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Número</th>
                                        <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Frente</th>
                                        <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Fazenda</th>
                                        <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Previsto</th>
                                        <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Realizado</th>
                                        <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Restante</th>
                                        <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Status</th>
                                        <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Data</th>
                                        <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Ações</th>
                                    </tr>
                                </thead>
                                <tbody id="tabela-liberacoes" class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                    <!-- Dados preenchidos via JavaScript -->
                                </tbody>
                            </table>
                        </div>
                        
                        <!-- Paginação -->
                        <div id="paginacao-liberacoes" class="px-6 py-4 bg-gray-50 dark:bg-gray-700 border-t border-gray-200 dark:border-gray-600">
                            <!-- Paginação preenchida via JavaScript -->
                        </div>
                    </div>

                    <!-- Modal para Nova/Editar Liberação -->
                    <div id="modal-liberacao" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
                        <div class="bg-white dark:bg-gray-800 rounded-lg p-6 w-full max-w-md mx-4">
                            <div class="flex items-center justify-between mb-4">
                                <h3 id="modal-liberacao-title" class="text-lg font-semibold text-gray-800 dark:text-white">Nova Liberação</h3>
                                <button id="btn-fechar-modal-liberacao" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                            
                            <form id="form-liberacao" class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Número da Liberação</label>
                                    <input type="text" id="liberacao-numero" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500">
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Frente</label>
                                    <input type="text" id="liberacao-frente" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500" required>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Fazenda</label>
                                    <input type="text" id="liberacao-fazenda" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500" required>
                                </div>
                                
                                <div class="grid grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Previsto (T)</label>
                                        <input type="number" id="liberacao-previsto" step="0.1" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500" required>
                                    </div>
                                    
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Realizado (T)</label>
                                        <input type="number" id="liberacao-realizado" step="0.1" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500" required>
                                    </div>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status</label>
                                    <select id="liberacao-status" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500" required>
                                        <option value="aberto">Aberto</option>
                                        <option value="em-andamento">Em Andamento</option>
                                        <option value="fechado">Fechado</option>
                                        <option value="cancelado">Cancelado</option>
                                    </select>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Data</label>
                                    <input type="date" id="liberacao-data" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500" required>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Observações</label>
                                    <textarea id="liberacao-observacoes" rows="3" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500"></textarea>
                                </div>
                                
                                <div class="flex justify-end space-x-3 pt-4">
                                    <button type="button" id="btn-cancelar-liberacao" class="px-4 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 border border-gray-300 dark:border-gray-600 hover:border-gray-400 dark:hover:border-gray-500 rounded-lg transition-all-300">
                                        Cancelar
                                    </button>
                                    <button type="submit" id="btn-salvar-liberacao" class="px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg font-medium transition-all-300">
                                        Salvar
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

                <!-- Conteúdo de Frentes COMPLETO ORIGINAL -->
                <div id="content-frentes" class="content hidden">
                    <div class="mb-6">
                        <div class="flex flex-col md:flex-row md:items-center justify-between">
                            <div class="mb-4 md:mb-0">
                                <h2 class="text-3xl font-bold text-gray-800 dark:text-white mb-2">Frentes de Trabalho</h2>
                                <p class="text-gray-600 dark:text-gray-400">Gestão completa das frentes - Próprias, terceiras e desconhecidas</p>
                            </div>
                            <div class="flex items-center space-x-3">
                                <button id="btn-nova-frente" class="px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg font-medium transition-all-300 flex items-center">
                                    <i class="fas fa-plus mr-2"></i>
                                    Nova Frente
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Cards de Resumo de Frentes -->
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                        <div class="bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-900/30 dark:to-emerald-900/30 rounded-lg card-shadow p-6 border border-green-200 dark:border-green-800">
                            <div class="flex items-center">
                                <div class="p-3 rounded-full bg-green-100 dark:bg-green-900 mr-4">
                                    <i class="fas fa-home text-green-600 dark:text-green-400 text-xl"></i>
                                </div>
                                <div>
                                    <p class="text-sm font-medium text-green-700 dark:text-green-300">Frentes Próprias</p>
                                    <p id="total-frentes-proprias" class="text-2xl font-bold text-green-800 dark:text-green-200">0</p>
                                </div>
                            </div>
                        </div>

                        <div class="bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-900/30 dark:to-indigo-900/30 rounded-lg card-shadow p-6 border border-blue-200 dark:border-blue-800">
                            <div class="flex items-center">
                                <div class="p-3 rounded-full bg-blue-100 dark:bg-blue-900 mr-4">
                                    <i class="fas fa-handshake text-blue-600 dark:text-blue-400 text-xl"></i>
                                </div>
                                <div>
                                    <p class="text-sm font-medium text-blue-700 dark:text-blue-300">Frentes Terceiras</p>
                                    <p id="total-frentes-terceiras" class="text-2xl font-bold text-blue-800 dark:text-blue-200">0</p>
                                </div>
                            </div>
                        </div>

                        <div class="bg-gradient-to-br from-yellow-50 to-orange-50 dark:from-yellow-900/30 dark:to-orange-900/30 rounded-lg card-shadow p-6 border border-yellow-200 dark:border-yellow-800">
                            <div class="flex items-center">
                                <div class="p-3 rounded-full bg-yellow-100 dark:bg-yellow-900 mr-4">
                                    <i class="fas fa-question-circle text-yellow-600 dark:text-yellow-400 text-xl"></i>
                                </div>
                                <div>
                                    <p class="text-sm font-medium text-yellow-700 dark:text-yellow-300">Desconhecidas</p>
                                    <p id="total-frentes-desconhecidas" class="text-2xl font-bold text-yellow-800 dark:text-yellow-200">0</p>
                                </div>
                            </div>
                        </div>

                        <div class="bg-gradient-to-br from-purple-50 to-violet-50 dark:from-purple-900/30 dark:to-violet-900/30 rounded-lg card-shadow p-6 border border-purple-200 dark:border-purple-800">
                            <div class="flex items-center">
                                <div class="p-3 rounded-full bg-purple-100 dark:bg-purple-900 mr-4">
                                    <i class="fas fa-play-circle text-purple-600 dark:text-purple-400 text-xl"></i>
                                </div>
                                <div>
                                    <p class="text-sm font-medium text-purple-700 dark:text-purple-300">Frentes Ativas</p>
                                    <p id="total-frentes-ativas" class="text-2xl font-bold text-purple-800 dark:text-purple-200">0</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Tabela de Frentes -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg card-shadow overflow-hidden">
                        <div class="p-6 border-b border-gray-200 dark:border-gray-700">
                            <div class="flex flex-col sm:flex-row sm:items-center justify-between">
                                <div>
                                    <h3 class="text-lg font-semibold text-gray-800 dark:text-white">Lista de Frentes</h3>
                                    <p class="text-sm text-gray-500 dark:text-gray-400 mt-1">Controle de todas as frentes de trabalho</p>
                                </div>
                                <div class="flex items-center space-x-3 mt-4 sm:mt-0">
                                    <div class="text-sm text-gray-500 dark:text-gray-400">
                                        <span id="total-frentes-lista">0</span> frente(s) encontrada(s)
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="table-container">
                            <table class="w-full">
                                <thead class="bg-gray-50 dark:bg-gray-700">
                                    <tr>
                                        <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Nome</th>
                                        <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Fazenda</th>
                                        <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Tipo</th>
                                        <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Responsável</th>
                                        <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Status</th>
                                        <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Ações</th>
                                    </tr>
                                </thead>
                                <tbody id="tabela-frentes" class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                    <!-- Dados preenchidos via JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Modal para Nova/Editar Frente -->
                    <div id="modal-frente" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
                        <div class="bg-white dark:bg-gray-800 rounded-lg p-6 w-full max-w-md mx-4">
                            <div class="flex items-center justify-between mb-4">
                                <h3 id="modal-frente-title" class="text-lg font-semibold text-gray-800 dark:text-white">Nova Frente</h3>
                                <button id="btn-fechar-modal-frente" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                            
                            <form id="form-frente" class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Nome da Frente</label>
                                    <input type="text" id="frente-nome" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500" required>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Fazenda</label>
                                    <input type="text" id="frente-fazenda" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500" required>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Tipo</label>
                                    <select id="frente-tipo" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500" required>
                                        <option value="propria">Própria</option>
                                        <option value="terceira">Terceira</option>
                                        <option value="desconhecido">Desconhecido</option>
                                    </select>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Responsável</label>
                                    <input type="text" id="frente-responsavel" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500" required>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status</label>
                                    <select id="frente-status" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500" required>
                                        <option value="ativa">Ativa</option>
                                        <option value="inativa">Inativa</option>
                                        <option value="manutencao">Manutenção</option>
                                    </select>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Observações</label>
                                    <textarea id="frente-observacoes" rows="3" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500"></textarea>
                                </div>
                                
                                <div class="flex justify-end space-x-3 pt-4">
                                    <button type="button" id="btn-cancelar-frente" class="px-4 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 border border-gray-300 dark:border-gray-600 hover:border-gray-400 dark:hover:border-gray-500 rounded-lg transition-all-300">
                                        Cancelar
                                    </button>
                                    <button type="submit" id="btn-salvar-frente" class="px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg font-medium transition-all-300">
                                        Salvar
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

                <!-- Conteúdo de Metas COMPLETO ORIGINAL -->
                <div id="content-metas" class="content hidden">
                    <div class="mb-6">
                        <div class="flex flex-col md:flex-row md:items-center justify-between">
                            <div class="mb-4 md:mb-0">
                                <h2 class="text-3xl font-bold text-gray-800 dark:text-white mb-2">Metas de Colheita</h2>
                                <p class="text-gray-600 dark:text-gray-400">Definição e controle de metas por frente e período</p>
                            </div>
                            <div class="flex items-center space-x-3">
                                <button id="btn-nova-meta" class="px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg font-medium transition-all-300 flex items-center">
                                    <i class="fas fa-plus mr-2"></i>
                                    Nova Meta
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Tabela de Metas -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg card-shadow overflow-hidden">
                        <div class="p-6 border-b border-gray-200 dark:border-gray-700">
                            <div class="flex flex-col sm:flex-row sm:items-center justify-between">
                                <div>
                                    <h3 class="text-lg font-semibold text-gray-800 dark:text-white">Lista de Metas</h3>
                                    <p class="text-sm text-gray-500 dark:text-gray-400 mt-1">Controle de metas de colheita por frente</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="table-container">
                            <table class="w-full">
                                <thead class="bg-gray-50 dark:bg-gray-700">
                                    <tr>
                                        <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Frente</th>
                                        <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Tipo</th>
                                        <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Período</th>
                                        <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Valor (T)</th>
                                        <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Data Início</th>
                                        <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Data Fim</th>
                                        <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Ações</th>
                                    </tr>
                                </thead>
                                <tbody id="tabela-metas" class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                    <!-- Dados preenchidos via JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Conteúdo de Caminhões COMPLETO ORIGINAL -->
                <div id="content-caminhoes" class="content hidden">
                    <div class="mb-6">
                        <div class="flex flex-col md:flex-row md:items-center justify-between">
                            <div class="mb-4 md:mb-0">
                                <h2 class="text-3xl font-bold text-gray-800 dark:text-white mb-2">Metas de Caminhões</h2>
                                <p class="text-gray-600 dark:text-gray-400">Gestão completa de metas para caminhões próprios e terceiros</p>
                            </div>
                            <div class="flex items-center space-x-3">
                                <button id="btn-novo-caminhao" class="px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg font-medium transition-all-300 flex items-center">
                                    <i class="fas fa-plus mr-2"></i>
                                    Novo Caminhão
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Tabela de Caminhões -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg card-shadow overflow-hidden">
                        <div class="p-6 border-b border-gray-200 dark:border-gray-700">
                            <div class="flex flex-col sm:flex-row sm:items-center justify-between">
                                <div>
                                    <h3 class="text-lg font-semibold text-gray-800 dark:text-white">Lista de Caminhões</h3>
                                    <p class="text-sm text-gray-500 dark:text-gray-400 mt-1">Controle de metas por caminhão</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="table-container">
                            <table class="w-full">
                                <thead class="bg-gray-50 dark:bg-gray-700">
                                    <tr>
                                        <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Placa</th>
                                        <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Modelo</th>
                                        <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Tipo</th>
                                        <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Motorista</th>
                                        <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Capacidade</th>
                                        <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Status</th>
                                        <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Ações</th>
                                    </tr>
                                </thead>
                                <tbody id="tabela-caminhoes" class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                    <!-- Dados preenchidos via JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Conteúdo de Relatórios -->
                <div id="content-relatorios" class="content hidden">
                    <div class="mb-6">
                        <h2 class="text-3xl font-bold text-gray-800 dark:text-white mb-2">Relatórios</h2>
                        <p class="text-gray-600 dark:text-gray-400">Geração e exportação de relatórios detalhados</p>
                    </div>
                    
                    <div class="bg-white dark:bg-gray-800 rounded-lg card-shadow p-8 text-center">
                        <i class="fas fa-file-alt text-6xl text-gray-400 dark:text-gray-500 mb-4"></i>
                        <h3 class="text-xl font-semibold text-gray-800 dark:text-white mb-2">Relatórios em Desenvolvimento</h3>
                        <p class="text-gray-600 dark:text-gray-400">Esta funcionalidade estará disponível em breve.</p>
                    </div>
                </div>

                <!-- Conteúdo de Configurações -->
                <div id="content-configuracoes" class="content hidden">
                    <div class="mb-6">
                        <h2 class="text-3xl font-bold text-gray-800 dark:text-white mb-2">Configurações</h2>
                        <p class="text-gray-600 dark:text-gray-400">Configurações do sistema e preferências</p>
                    </div>

                    <!-- Seção de Dados -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg card-shadow p-6 mb-6">
                        <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-4">Gerenciar Dados</h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <button id="btn-export-data" class="p-4 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-all-300">
                                <i class="fas fa-download text-blue-600 dark:text-blue-400 text-2xl mb-2"></i>
                                <p class="font-medium text-gray-800 dark:text-white">Exportar Dados</p>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Fazer backup completo</p>
                            </button>
                            
                            <button id="btn-import-data" class="p-4 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-all-300">
                                <i class="fas fa-upload text-green-600 dark:text-green-400 text-2xl mb-2"></i>
                                <p class="font-medium text-gray-800 dark:text-white">Importar Dados</p>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Restaurar backup</p>
                            </button>
                            
                            <button id="btn-clear-data" class="p-4 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-all-300">
                                <i class="fas fa-trash text-red-600 dark:text-red-400 text-2xl mb-2"></i>
                                <p class="font-medium text-gray-800 dark:text-white">Limpar Dados</p>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Resetar sistema</p>
                            </button>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>
    <script>
// ===== SISTEMA DE GESTÃO AGRÍCOLA GGOMES-LOG v2.1 AVANÇADO COM CAMINHÕES E FILTROS =====

// Configuração global da aplicação
const AppConfig = {
    version: '2.1-advanced-with-filters',
    name: 'GGOMES-LOG',
    pagination: { itemsPerPage: 10 },
    charts: {},
    notifications: [],
    autoRefresh: false,
    refreshInterval: null,
    chartFilters: {
        dataInicio: null,
        dataFim: null,
        frenteId: null
    }
};

// Cache para otimização de performance
const AcompanhamentoCache = {
    data: null,
    timestamp: null,
    filters: null,
    isValid: function(currentFilters) {
        if (!this.data || !this.timestamp) return false;
        const cacheAge = Date.now() - this.timestamp;
        const maxAge = 30000; // 30 segundos
        return cacheAge < maxAge && JSON.stringify(this.filters) === JSON.stringify(currentFilters);
    },
    set: function(data, filters) {
        this.data = data;
        this.timestamp = Date.now();
        this.filters = { ...filters };
    },
    get: function() {
        return this.data;
    },
    clear: function() {
        this.data = null;
        this.timestamp = null;
        this.filters = null;
    }
};

// Estado de ordenação da tabela de acompanhamento
let currentAcompanhamentoSort = { field: 'percentualMeta', direction: 'desc' };

// Sistema básico de toasts melhorado
const Toast = {
    show: function(message, type = 'success', duration = 4000) {
        const toastContainer = document.getElementById('toast-container');
        if (!toastContainer) return;
        
        const toast = document.createElement('div');
        const colorClasses = {
            'success': 'bg-green-100 dark:bg-green-800 text-green-700 dark:text-green-300 border-green-200 dark:border-green-700',
            'error': 'bg-red-100 dark:bg-red-800 text-red-700 dark:text-red-300 border-red-200 dark:border-red-700',
            'warning': 'bg-yellow-100 dark:bg-yellow-800 text-yellow-700 dark:text-yellow-300 border-yellow-200 dark:border-yellow-700',
            'info': 'bg-blue-100 dark:bg-blue-800 text-blue-700 dark:text-blue-300 border-blue-200 dark:border-blue-700'
        };
        
        const iconClasses = {
            'success': 'fa-check-circle',
            'error': 'fa-exclamation-circle',
            'warning': 'fa-exclamation-triangle',
            'info': 'fa-info-circle'
        };
        
        toast.className = `animate-fade-in p-4 mb-3 rounded-lg border card-shadow flex items-center justify-between max-w-sm ${colorClasses[type] || colorClasses.info}`;
        
        toast.innerHTML = `
            <div class="flex items-center">
                <i class="fas ${iconClasses[type] || iconClasses.info} mr-3 text-lg"></i>
                <span class="text-sm font-medium">${message}</span>
            </div>
            <button class="ml-4 text-current hover:opacity-70 focus:outline-none transition-opacity">
                <i class="fas fa-times"></i>
            </button>
        `;
        
        const closeBtn = toast.querySelector('button');
        closeBtn.addEventListener('click', () => this.remove(toast));
        
        toastContainer.appendChild(toast);
        
        if (duration > 0) {
            setTimeout(() => this.remove(toast), duration);
        }
    },
    
    remove: function(toast) {
        if (toast && toast.parentNode) {
            toast.classList.remove('animate-fade-in');
            toast.classList.add('animate-fade-out');
            setTimeout(() => {
                if (toast.parentNode) {
                    toast.parentNode.removeChild(toast);
                }
            }, 300);
        }
    }
};

// Sistema de Banco de Dados Local melhorado e COMPLETO
const DB = {
    // Inicialização do banco de dados
    init: function() {
        this.initializeDefaultData();
        this.updateLastAccess();
    },
    
    // Inicializar dados padrão se não existirem
    initializeDefaultData: function() {
        if (!localStorage.getItem('ggomes_liberacoes')) {
            const hoje = Utils.getLocalDateString();
            const ontem = new Date();
            ontem.setDate(ontem.getDate() - 1);
            const dataOntem = Utils.formatDateForInput(ontem);
            
            const liberacoesIniciais = [
                {
                    id: 'LIB-001',
                    frente: 'Frente 01',
                    fazenda: 'Fazenda São João',
                    numero: 'LIB-2025-001',
                    status: 'fechado',
                    previsto: 1000,
                    realizado: 950,
                    restante: 50,
                    data: dataOntem,
                    observacoes: 'Liberação concluída com sucesso',
                    dataRegistro: new Date().toISOString()
                },
                {
                    id: 'LIB-002',
                    frente: 'Frente 02',
                    fazenda: 'Fazenda Boa Vista',
                    numero: 'LIB-2025-002',
                    status: 'em-andamento',
                    previsto: 1500,
                    realizado: 1200,
                    restante: 300,
                    data: hoje,
                    observacoes: 'Em progresso, boa produtividade',
                    dataRegistro: new Date().toISOString()
                },
                {
                    id: 'LIB-003',
                    frente: 'Frente 01',
                    fazenda: 'Fazenda São João',
                    numero: 'LIB-2025-003',
                    status: 'aberto',
                    previsto: 800,
                    realizado: 200,
                    restante: 600,
                    data: hoje,
                    observacoes: 'Iniciada hoje pela manhã',
                    dataRegistro: new Date().toISOString()
                }
            ];
            localStorage.setItem('ggomes_liberacoes', JSON.stringify(liberacoesIniciais));
            
            const frentesIniciais = [
                {
                    id: 'FRENTE-001',
                    nome: 'Frente 01',
                    fazenda: 'Fazenda São João',
                    tipo: 'propria',
                    responsavel: 'João Silva',
                    status: 'ativa',
                    observacoes: 'Frente principal com alta produtividade',
                    dataRegistro: new Date().toISOString()
                },
                {
                    id: 'FRENTE-002',
                    nome: 'Frente 02',
                    fazenda: 'Fazenda Boa Vista',
                    tipo: 'propria',
                    responsavel: 'Maria Santos',
                    status: 'ativa',
                    observacoes: 'Frente secundária em expansão',
                    dataRegistro: new Date().toISOString()
                },
                {
                    id: 'FRENTE-003',
                    nome: 'Frente Terceira A',
                    fazenda: 'Fazenda Esperança',
                    tipo: 'terceira',
                    responsavel: 'Pedro Lima',
                    status: 'ativa',
                    observacoes: 'Nova frente terceirizada',
                    dataRegistro: new Date().toISOString()
                },
                {
                    id: 'FRENTE-004',
                    nome: 'Frente Desconhecida X',
                    fazenda: 'Fazenda Nova',
                    tipo: 'desconhecido',
                    responsavel: 'A definir',
                    status: 'inativa',
                    observacoes: 'Frente em análise para classificação',
                    dataRegistro: new Date().toISOString()
                }
            ];
            localStorage.setItem('ggomes_frentes', JSON.stringify(frentesIniciais));
            
            const metasIniciais = [
                {
                    id: 'META-001',
                    frenteId: 'FRENTE-001',
                    tipo: 'propria',
                    periodo: 'diario',
                    valor: 180,
                    dataInicio: hoje,
                    dataFim: hoje,
                    observacoes: 'Meta diária padrão própria',
                    dataRegistro: new Date().toISOString()
                },
                {
                    id: 'META-002',
                    frenteId: 'FRENTE-003',
                    tipo: 'terceira',
                    periodo: 'diario',
                    valor: 150,
                    dataInicio: hoje,
                    dataFim: hoje,
                    observacoes: 'Meta inicial terceirizada',
                    dataRegistro: new Date().toISOString()
                }
            ];
            localStorage.setItem('ggomes_metas', JSON.stringify(metasIniciais));
            
            const lancamentosIniciais = [
                {
                    id: 'LANC-001',
                    frenteId: 'FRENTE-001',
                    data: dataOntem,
                    colhido: 175.5,
                    turno: 'manha',
                    operador: 'José Santos',
                    observacoes: 'Excelente rendimento matinal',
                    dataRegistro: new Date().toISOString()
                },
                {
                    id: 'LANC-002',
                    frenteId: 'FRENTE-003',
                    data: dataOntem,
                    colhido: 140.2,
                    turno: 'tarde',
                    operador: 'Pedro Lima',
                    observacoes: 'Boa produtividade terceirizada',
                    dataRegistro: new Date().toISOString()
                }
            ];
            localStorage.setItem('ggomes_lancamentos', JSON.stringify(lancamentosIniciais));
            
            // Dados iniciais de caminhões
            const caminhoesIniciais = [
                {
                    id: 'CAM-001',
                    placa: 'ABC-1234',
                    modelo: 'Scania R450',
                    tipo: 'proprio',
                    capacidade: 30.0,
                    motorista: 'Carlos Silva',
                    status: 'ativo',
                    observacoes: 'Caminhão principal da frota',
                    dataRegistro: new Date().toISOString()
                },
                {
                    id: 'CAM-002',
                    placa: 'DEF-5678',
                    modelo: 'Mercedes Actros',
                    tipo: 'proprio',
                    capacidade: 28.5,
                    motorista: 'José Santos',
                    status: 'ativo',
                    observacoes: 'Caminhão secundário',
                    dataRegistro: new Date().toISOString()
                },
                {
                    id: 'CAM-003',
                    placa: 'GHI-9012',
                    modelo: 'Volvo FH',
                    tipo: 'terceiro',
                    capacidade: 32.0,
                    motorista: 'João Terceiro',
                    status: 'ativo',
                    observacoes: 'Caminhão terceirizado contratado',
                    dataRegistro: new Date().toISOString()
                }
            ];
            localStorage.setItem('ggomes_caminhoes', JSON.stringify(caminhoesIniciais));
            
            // Metas iniciais de caminhões
            const metasCaminhoesIniciais = [
                {
                    id: 'META-CAM-001',
                    caminhaoId: 'CAM-001',
                    tipo: 'proprio',
                    periodo: 'diario',
                    metaViagens: 10,
                    metaToneladas: 300,
                    dataInicio: hoje,
                    dataFim: hoje,
                    observacoes: 'Meta diária padrão',
                    dataRegistro: new Date().toISOString()
                },
                {
                    id: 'META-CAM-002',
                    caminhaoId: 'CAM-003',
                    tipo: 'terceiro',
                    periodo: 'diario',
                    metaViagens: 8,
                    metaToneladas: 256,
                    dataInicio: hoje,
                    dataFim: hoje,
                    observacoes: 'Meta terceirizada',
                    dataRegistro: new Date().toISOString()
                }
            ];
            localStorage.setItem('ggomes_metas_caminhoes', JSON.stringify(metasCaminhoesIniciais));
        }
        
        if (!localStorage.getItem('ggomes_config')) {
            localStorage.setItem('ggomes_config', JSON.stringify({
                version: '2.1-advanced-with-filters',
                temaEscuro: true,
                ultimoAcesso: new Date().toISOString(),
                notifications: [],
                preferences: { itemsPerPage: 10, autoRefresh: false }
            }));
        }
        
        const tabelas = ['liberacoes', 'frentes', 'metas', 'lancamentos', 'caminhoes', 'metas_caminhoes'];
        tabelas.forEach(tabela => {
            if (!localStorage.getItem(`ggomes_${tabela}`)) {
                localStorage.setItem(`ggomes_${tabela}`, JSON.stringify([]));
            }
        });
    },
    
    updateLastAccess: function() {
        const config = JSON.parse(localStorage.getItem('ggomes_config') || '{}');
        config.ultimoAcesso = new Date().toISOString();
        localStorage.setItem('ggomes_config', JSON.stringify(config));
    },
    
    clearAll: function() {
        try {
            const tabelas = ['liberacoes', 'frentes', 'metas', 'lancamentos', 'caminhoes', 'metas_caminhoes'];
            tabelas.forEach(tabela => {
                localStorage.removeItem(`ggomes_${tabela}`);
                localStorage.setItem(`ggomes_${tabela}`, JSON.stringify([]));
            });
            
            const config = JSON.parse(localStorage.getItem('ggomes_config') || '{}');
            localStorage.setItem('ggomes_config', JSON.stringify({
                version: '2.1-advanced-with-filters',
                temaEscuro: config.temaEscuro || true,
                ultimoAcesso: new Date().toISOString(),
                notifications: [],
                preferences: config.preferences || { itemsPerPage: 10, autoRefresh: false }
            }));
            
            AcompanhamentoCache.clear();
            return true;
        } catch (error) {
            console.error('Erro ao limpar dados:', error);
            return false;
        }
    },
    
    exportData: function() {
        try {
            const data = {
                liberacoes: JSON.parse(localStorage.getItem('ggomes_liberacoes') || '[]'),
                frentes: JSON.parse(localStorage.getItem('ggomes_frentes') || '[]'),
                metas: JSON.parse(localStorage.getItem('ggomes_metas') || '[]'),
                lancamentos: JSON.parse(localStorage.getItem('ggomes_lancamentos') || '[]'),
                caminhoes: JSON.parse(localStorage.getItem('ggomes_caminhoes') || '[]'),
                metasCaminhoes: JSON.parse(localStorage.getItem('ggomes_metas_caminhoes') || '[]'),
                config: JSON.parse(localStorage.getItem('ggomes_config') || '{}'),
                metaData: {
                    exportDate: new Date().toISOString(),
                    version: '2.1-advanced-with-filters',
                    description: 'Backup completo do sistema GGOMES-LOG v2.1 Avançado com Filtros'
                }
            };
            
            return JSON.stringify(data, null, 2);
        } catch (error) {
            console.error('Erro ao exportar dados:', error);
            throw new Error('Não foi possível exportar os dados.');
        }
    },
    
    importData: function(jsonData) {
        try {
            const data = JSON.parse(jsonData);
            
            if (!data.metaData || !data.metaData.version) {
                throw new Error('Arquivo de backup inválido: metadados ausentes.');
            }
            
            if (!data.liberacoes && !data.frentes && !data.metas && !data.lancamentos && !data.caminhoes) {
                throw new Error('Arquivo de backup vazio ou corrompido.');
            }
            
            const tabelas = ['liberacoes', 'frentes', 'metas', 'lancamentos', 'caminhoes'];
            tabelas.forEach(tabela => {
                if (data[tabela] && Array.isArray(data[tabela])) {
                    localStorage.setItem(`ggomes_${tabela}`, JSON.stringify(data[tabela]));
                }
            });
            
            // Importar metas de caminhões
            if (data.metasCaminhoes && Array.isArray(data.metasCaminhoes)) {
                localStorage.setItem('ggomes_metas_caminhoes', JSON.stringify(data.metasCaminhoes));
            }
            
            if (data.config) {
                const currentConfig = JSON.parse(localStorage.getItem('ggomes_config') || '{}');
                const newConfig = {
                    ...data.config,
                    version: '2.1-advanced-with-filters',
                    temaEscuro: currentConfig.temaEscuro,
                    ultimoAcesso: new Date().toISOString(),
                    preferences: currentConfig.preferences || data.config.preferences || { itemsPerPage: 10, autoRefresh: false }
                };
                localStorage.setItem('ggomes_config', JSON.stringify(newConfig));
            }
            
            AcompanhamentoCache.clear();
            return true;
        } catch (error) {
            console.error('Erro ao importar dados:', error);
            throw error;
        }
    },
    
    // Módulo Liberações (COMPLETO ORIGINAL)
    liberacoes: {
        getAll: function() {
            try {
                const liberacoes = localStorage.getItem('ggomes_liberacoes');
                return liberacoes ? JSON.parse(liberacoes) : [];
            } catch (error) {
                console.error("Erro ao obter liberações:", error);
                return [];
            }
        },
        
        get: function(id) {
            return this.getAll().find(l => l.id === id);
        },
        
        add: function(liberacao) {
            const requiredFields = ['frente', 'fazenda', 'status', 'previsto', 'realizado', 'data'];
            const missingFields = requiredFields.filter(field => !liberacao[field] && liberacao[field] !== 0);
            
            if (missingFields.length > 0) {
                throw new Error(`Campos obrigatórios ausentes: ${missingFields.join(', ')}`);
            }
            
            const liberacoes = this.getAll();
            
            if (!liberacao.id) {
                liberacao.id = Utils.gerarId('LIB');
            }
            
            if (liberacoes.some(l => l.id === liberacao.id)) {
                throw new Error(`Liberação com ID "${liberacao.id}" já existe.`);
            }
            
            liberacao.restante = Number(liberacao.previsto) - Number(liberacao.realizado);
            liberacao.dataRegistro = liberacao.dataRegistro || new Date().toISOString();
            
            if (Number(liberacao.previsto) < 0 || Number(liberacao.realizado) < 0) {
                throw new Error('Valores previstos e realizados devem ser positivos.');
            }
            
            liberacoes.push(liberacao);
            localStorage.setItem('ggomes_liberacoes', JSON.stringify(liberacoes));
            
            return liberacao;
        },
        
        update: function(liberacao) {
            if (!liberacao.id) {
                throw new Error('ID da liberação é obrigatório.');
            }
            
            const liberacoes = this.getAll();
            const index = liberacoes.findIndex(l => l.id === liberacao.id);
            
            if (index === -1) {
                throw new Error(`Liberação com ID "${liberacao.id}" não encontrada.`);
            }
            
            if (liberacao.previsto !== undefined || liberacao.realizado !== undefined) {
                const previsto = liberacao.previsto !== undefined ? Number(liberacao.previsto) : Number(liberacoes[index].previsto);
                const realizado = liberacao.realizado !== undefined ? Number(liberacao.realizado) : Number(liberacoes[index].realizado);
                liberacao.restante = previsto - realizado;
            }
            
            liberacoes[index] = { ...liberacoes[index], ...liberacao };
            localStorage.setItem('ggomes_liberacoes', JSON.stringify(liberacoes));
            
            return liberacoes[index];
        },
        
        remove: function(id) {
            const liberacoes = this.getAll();
            const index = liberacoes.findIndex(l => l.id === id);
            
            if (index === -1) {
                throw new Error(`Liberação com ID "${id}" não encontrada.`);
            }
            
            liberacoes.splice(index, 1);
            localStorage.setItem('ggomes_liberacoes', JSON.stringify(liberacoes));
            
            return true;
        },
        
        getTotals: function(filtroFrente = '', filtroFazenda = '', filtroStatus = '') {
            let liberacoes = this.getAll();
            
            if (filtroFrente) liberacoes = liberacoes.filter(l => l.frente === filtroFrente);
            if (filtroFazenda) liberacoes = liberacoes.filter(l => l.fazenda === filtroFazenda);
            if (filtroStatus) liberacoes = liberacoes.filter(l => l.status === filtroStatus);
            
            const totals = {
                previsto: 0, realizado: 0, restante: 0,
                statusAberto: 0, statusFechado: 0, statusEmAndamento: 0, statusCancelado: 0,
                totalGeral: 0, count: liberacoes.length
            };
            
            liberacoes.forEach(l => {
                const previsto = Number(l.previsto) || 0;
                const realizado = Number(l.realizado) || 0;
                const restante = Number(l.restante) || 0;
                
                totals.previsto += previsto;
                totals.realizado += realizado;
                totals.restante += restante;
                totals.totalGeral += previsto;
                
                switch(l.status) {
                    case 'aberto': totals.statusAberto++; break;
                    case 'fechado': totals.statusFechado++; break;
                    case 'em-andamento': totals.statusEmAndamento++; break;
                    case 'cancelado': totals.statusCancelado++; break;
                }
            });
            
            return totals;
        }
    },

    // Módulo Frentes (COMPLETO ORIGINAL)
    frentes: {
        getAll: function() {
            try {
                const frentes = localStorage.getItem('ggomes_frentes');
                return frentes ? JSON.parse(frentes) : [];
            } catch (error) {
                console.error("Erro ao obter frentes:", error);
                return [];
            }
        },
        
        get: function(id) {
            return this.getAll().find(f => f.id === id);
        },
        
        add: function(frente) {
            const requiredFields = ['nome', 'fazenda', 'tipo', 'responsavel', 'status'];
            const missingFields = requiredFields.filter(field => !frente[field]);
            
            if (missingFields.length > 0) {
                throw new Error(`Campos obrigatórios ausentes: ${missingFields.join(', ')}`);
            }
            
            const frentes = this.getAll();
            
            if (!frente.id) {
                frente.id = Utils.gerarId('FRENTE');
            }
            
            if (frentes.some(f => f.id === frente.id)) {
                throw new Error(`Frente com ID "${frente.id}" já existe.`);
            }
            
            frente.dataRegistro = frente.dataRegistro || new Date().toISOString();
            
            frentes.push(frente);
            localStorage.setItem('ggomes_frentes', JSON.stringify(frentes));
            
            return frente;
        },
        
        update: function(frente) {
            if (!frente.id) {
                throw new Error('ID da frente é obrigatório.');
            }
            
            const frentes = this.getAll();
            const index = frentes.findIndex(f => f.id === frente.id);
            
            if (index === -1) {
                throw new Error(`Frente com ID "${frente.id}" não encontrada.`);
            }
            
            frentes[index] = { ...frentes[index], ...frente };
            localStorage.setItem('ggomes_frentes', JSON.stringify(frentes));
            
            return frentes[index];
        },
        
        remove: function(id) {
            const frentes = this.getAll();
            const index = frentes.findIndex(f => f.id === id);
            
            if (index === -1) {
                throw new Error(`Frente com ID "${id}" não encontrada.`);
            }
            
            frentes.splice(index, 1);
            localStorage.setItem('ggomes_frentes', JSON.stringify(frentes));
            
            return true;
        }
    },

    // Módulo Metas (COMPLETO ORIGINAL)
    metas: {
        getAll: function() {
            try {
                const metas = localStorage.getItem('ggomes_metas');
                return metas ? JSON.parse(metas) : [];
            } catch (error) {
                console.error("Erro ao obter metas:", error);
                return [];
            }
        },
        
        get: function(id) {
            return this.getAll().find(m => m.id === id);
        },
        
        add: function(meta) {
            const requiredFields = ['frenteId', 'tipo', 'periodo', 'valor', 'dataInicio', 'dataFim'];
            const missingFields = requiredFields.filter(field => !meta[field] && meta[field] !== 0);
            
            if (missingFields.length > 0) {
                throw new Error(`Campos obrigatórios ausentes: ${missingFields.join(', ')}`);
            }
            
            const metas = this.getAll();
            
            if (!meta.id) {
                meta.id = Utils.gerarId('META');
            }
            
            if (metas.some(m => m.id === meta.id)) {
                throw new Error(`Meta com ID "${meta.id}" já existe.`);
            }
            
            meta.dataRegistro = meta.dataRegistro || new Date().toISOString();
            
            metas.push(meta);
            localStorage.setItem('ggomes_metas', JSON.stringify(metas));
            
            return meta;
        },
        
        update: function(meta) {
            if (!meta.id) {
                throw new Error('ID da meta é obrigatório.');
            }
            
            const metas = this.getAll();
            const index = metas.findIndex(m => m.id === meta.id);
            
            if (index === -1) {
                throw new Error(`Meta com ID "${meta.id}" não encontrada.`);
            }
            
            metas[index] = { ...metas[index], ...meta };
            localStorage.setItem('ggomes_metas', JSON.stringify(metas));
            
            return metas[index];
        },
        
        remove: function(id) {
            const metas = this.getAll();
            const index = metas.findIndex(m => m.id === id);
            
            if (index === -1) {
                throw new Error(`Meta com ID "${id}" não encontrada.`);
            }
            
            metas.splice(index, 1);
            localStorage.setItem('ggomes_metas', JSON.stringify(metas));
            
            return true;
        }
    },

    // Módulo Lançamentos (COMPLETO ORIGINAL)
    lancamentos: {
        getAll: function() {
            try {
                const lancamentos = localStorage.getItem('ggomes_lancamentos');
                return lancamentos ? JSON.parse(lancamentos) : [];
            } catch (error) {
                console.error("Erro ao obter lançamentos:", error);
                return [];
            }
        },
        
        get: function(id) {
            return this.getAll().find(l => l.id === id);
        },
        
        add: function(lancamento) {
            const requiredFields = ['frenteId', 'data', 'colhido'];
            const missingFields = requiredFields.filter(field => !lancamento[field] && lancamento[field] !== 0);
            
            if (missingFields.length > 0) {
                throw new Error(`Campos obrigatórios ausentes: ${missingFields.join(', ')}`);
            }
            
            const lancamentos = this.getAll();
            
            if (!lancamento.id) {
                lancamento.id = Utils.gerarId('LANC');
            }
            
            if (lancamentos.some(l => l.id === lancamento.id)) {
                throw new Error(`Lançamento com ID "${lancamento.id}" já existe.`);
            }
            
            lancamento.dataRegistro = lancamento.dataRegistro || new Date().toISOString();
            
            lancamentos.push(lancamento);
            localStorage.setItem('ggomes_lancamentos', JSON.stringify(lancamentos));
            
            return lancamento;
        },
        
        update: function(lancamento) {
            if (!lancamento.id) {
                throw new Error('ID do lançamento é obrigatório.');
            }
            
            const lancamentos = this.getAll();
            const index = lancamentos.findIndex(l => l.id === lancamento.id);
            
            if (index === -1) {
                throw new Error(`Lançamento com ID "${lancamento.id}" não encontrado.`);
            }
            
            lancamentos[index] = { ...lancamentos[index], ...lancamento };
            localStorage.setItem('ggomes_lancamentos', JSON.stringify(lancamentos));
            
            return lancamentos[index];
        },
        
        remove: function(id) {
            const lancamentos = this.getAll();
            const index = lancamentos.findIndex(l => l.id === id);
            
            if (index === -1) {
                throw new Error(`Lançamento com ID "${id}" não encontrado.`);
            }
            
            lancamentos.splice(index, 1);
            localStorage.setItem('ggomes_lancamentos', JSON.stringify(lancamentos));
            
            return true;
        }
    },

    // Módulo Caminhões (COMPLETO ORIGINAL)
    caminhoes: {
        getAll: function() {
            try {
                const caminhoes = localStorage.getItem('ggomes_caminhoes');
                return caminhoes ? JSON.parse(caminhoes) : [];
            } catch (error) {
                console.error("Erro ao obter caminhões:", error);
                return [];
            }
        },
        
        get: function(id) {
            return this.getAll().find(c => c.id === id);
        },
        
        add: function(caminhao) {
            const requiredFields = ['placa', 'modelo', 'tipo', 'motorista', 'capacidade', 'status'];
            const missingFields = requiredFields.filter(field => !caminhao[field] && caminhao[field] !== 0);
            
            if (missingFields.length > 0) {
                throw new Error(`Campos obrigatórios ausentes: ${missingFields.join(', ')}`);
            }
            
            const caminhoes = this.getAll();
            
            if (!caminhao.id) {
                caminhao.id = Utils.gerarId('CAM');
            }
            
            if (caminhoes.some(c => c.id === caminhao.id || c.placa === caminhao.placa)) {
                throw new Error(`Caminhão com ID "${caminhao.id}" ou placa "${caminhao.placa}" já existe.`);
            }
            
            caminhao.dataRegistro = caminhao.dataRegistro || new Date().toISOString();
            
            caminhoes.push(caminhao);
            localStorage.setItem('ggomes_caminhoes', JSON.stringify(caminhoes));
            
            return caminhao;
        },
        
        update: function(caminhao) {
            if (!caminhao.id) {
                throw new Error('ID do caminhão é obrigatório.');
            }
            
            const caminhoes = this.getAll();
            const index = caminhoes.findIndex(c => c.id === caminhao.id);
            
            if (index === -1) {
                throw new Error(`Caminhão com ID "${caminhao.id}" não encontrado.`);
            }
            
            // Verificar se a placa não está sendo usada por outro caminhão
            if (caminhao.placa && caminhoes.some(c => c.id !== caminhao.id && c.placa === caminhao.placa)) {
                throw new Error(`Placa "${caminhao.placa}" já está sendo usada por outro caminhão.`);
            }
            
            caminhoes[index] = { ...caminhoes[index], ...caminhao };
            localStorage.setItem('ggomes_caminhoes', JSON.stringify(caminhoes));
            
            return caminhoes[index];
        },
        
        remove: function(id) {
            const caminhoes = this.getAll();
            const index = caminhoes.findIndex(c => c.id === id);
            
            if (index === -1) {
                throw new Error(`Caminhão com ID "${id}" não encontrado.`);
            }
            
            caminhoes.splice(index, 1);
            localStorage.setItem('ggomes_caminhoes', JSON.stringify(caminhoes));
            
            return true;
        }
    },
    
    // Módulo Metas de Caminhões
    metasCaminhoes: {
        getAll: function() {
            try {
                const metas = localStorage.getItem('ggomes_metas_caminhoes');
                return metas ? JSON.parse(metas) : [];
            } catch (error) {
                console.error("Erro ao obter metas de caminhões:", error);
                return [];
            }
        },
        
        get: function(id) {
            return this.getAll().find(m => m.id === id);
        },
        
        add: function(meta) {
            const requiredFields = ['caminhaoId', 'tipo', 'periodo', 'metaViagens', 'metaToneladas', 'dataInicio', 'dataFim'];
            const missingFields = requiredFields.filter(field => !meta[field] && meta[field] !== 0);
            
            if (missingFields.length > 0) {
                throw new Error(`Campos obrigatórios ausentes: ${missingFields.join(', ')}`);
            }
            
            const metas = this.getAll();
            
            if (!meta.id) {
                meta.id = Utils.gerarId('META-CAM');
            }
            
            if (metas.some(m => m.id === meta.id)) {
                throw new Error(`Meta de caminhão com ID "${meta.id}" já existe.`);
            }
            
            meta.dataRegistro = meta.dataRegistro || new Date().toISOString();
            
            metas.push(meta);
            localStorage.setItem('ggomes_metas_caminhoes', JSON.stringify(metas));
            
            return meta;
        },
        
        update: function(meta) {
            if (!meta.id) {
                throw new Error('ID da meta de caminhão é obrigatório.');
            }
            
            const metas = this.getAll();
            const index = metas.findIndex(m => m.id === meta.id);
            
            if (index === -1) {
                throw new Error(`Meta de caminhão com ID "${meta.id}" não encontrada.`);
            }
            
            metas[index] = { ...metas[index], ...meta };
            localStorage.setItem('ggomes_metas_caminhoes', JSON.stringify(metas));
            
            return metas[index];
        },
        
        remove: function(id) {
            const metas = this.getAll();
            const index = metas.findIndex(m => m.id === id);
            
            if (index === -1) {
                throw new Error(`Meta de caminhão com ID "${id}" não encontrada.`);
            }
            
            metas.splice(index, 1);
            localStorage.setItem('ggomes_metas_caminhoes', JSON.stringify(metas));
            
            return true;
        }
    }
};

// Sistema de gráficos MELHORADO COM FILTROS
const ChartManager = {
    init: function() {
        if (window.Chart) {
            Chart.defaults.color = document.documentElement.classList.contains('dark') ? '#e5e7eb' : '#374151';
            Chart.defaults.borderColor = document.documentElement.classList.contains('dark') ? '#374151' : '#e5e7eb';
            Chart.defaults.backgroundColor = document.documentElement.classList.contains('dark') ? '#1f2937' : '#ffffff';
        }
    },
    
    // Gráfico de Evolução da Colheita COM FILTROS IMPLEMENTADOS
    createEvolucaoColheitaChart: function(dataInicio = null, dataFim = null, frenteId = null) {
        const ctx = document.getElementById('chart-evolucao-colheita');
        if (!ctx || !window.Chart) return;
        
        let lancamentos = DB.lancamentos.getAll();
        let metas = DB.metas.getAll();
        
        // Definir período padrão (últimos 30 dias) se não especificado
        const hoje = new Date();
        const dataInicialDefault = new Date(hoje.getTime() - 30 * 24 * 60 * 60 * 1000);
        
        const dataInicioChart = dataInicio ? new Date(dataInicio) : dataInicialDefault;
        const dataFimChart = dataFim ? new Date(dataFim) : hoje;
        
        // Filtrar por frente se especificado
        if (frenteId) {
            lancamentos = lancamentos.filter(l => l.frenteId === frenteId);
            metas = metas.filter(m => m.frenteId === frenteId);
        }
        
        const labels = [];
        const dataColhido = [];
        const dataMetas = [];
        
        // Calcular diferença de dias
        const diffTime = Math.abs(dataFimChart - dataInicioChart);
        const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24)) + 1;
        
        for (let i = 0; i < diffDays; i++) {
            const data = new Date(dataInicioChart.getTime() + i * 24 * 60 * 60 * 1000);
            const dataStr = Utils.formatDateForInput(data);
            
            // Formatação da label baseada no período
            let labelFormat;
            if (diffDays <= 31) {
                labelFormat = data.toLocaleDateString('pt-BR', { day: '2-digit', month: '2-digit' });
            } else if (diffDays <= 90) {
                labelFormat = data.toLocaleDateString('pt-BR', { day: '2-digit', month: 'short' });
            } else {
                labelFormat = data.toLocaleDateString('pt-BR', { month: 'short', year: '2-digit' });
            }
            
            labels.push(labelFormat);
            
            // Calcular total colhido do dia
            const colhidoDia = lancamentos
                .filter(l => l.data === dataStr)
                .reduce((sum, l) => sum + Number(l.colhido), 0);
            
            dataColhido.push(colhidoDia);
            
            // Calcular meta do dia
            const metaDia = metas
                .filter(m => m.dataInicio <= dataStr && m.dataFim >= dataStr)
                .reduce((sum, m) => sum + Number(m.valor), 0);
            
            dataMetas.push(metaDia);
        }
        
        const data = {
            labels: labels,
            datasets: [
                {
                    label: 'Colhido',
                    data: dataColhido,
                    borderColor: '#10b981',
                    backgroundColor: 'rgba(16, 185, 129, 0.1)',
                    fill: true,
                    tension: 0.4
                },
                {
                    label: 'Meta',
                    data: dataMetas,
                    borderColor: '#f59e0b',
                    backgroundColor: 'rgba(245, 158, 11, 0.1)',
                    borderDash: [5, 5],
                    fill: false
                }
            ]
        };
        
        // Destruir gráfico anterior se existir
        if (AppConfig.charts.evolucaoColheitaChart) {
            AppConfig.charts.evolucaoColheitaChart.destroy();
        }
        
        AppConfig.charts.evolucaoColheitaChart = new Chart(ctx, {
            type: 'line',
            data: data,
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'top',
                    },
                    tooltip: {
                        mode: 'index',
                        intersect: false,
                        callbacks: {
                            label: function(context) {
                                return `${context.dataset.label}: ${Utils.formatarToneladas(context.parsed.y)}`;
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: {
                            callback: function(value) {
                                return Utils.formatarToneladas(value);
                            }
                        }
                    }
                },
                interaction: {
                    mode: 'nearest',
                    axis: 'x',
                    intersect: false
                }
            }
        });
        
        // Atualizar informações do período no gráfico
        const subtitleElement = ctx.parentNode.parentNode.querySelector('p');
        if (subtitleElement) {
            let periodoTexto = 'Últimos 30 dias';
            if (dataInicio && dataFim) {
                periodoTexto = `${Utils.formatarData(dataInicio)} a ${Utils.formatarData(dataFim)}`;
            }
            
            if (frenteId) {
                const frente = DB.frentes.get(frenteId);
                const frenteNome = frente ? frente.nome : 'Frente não encontrada';
                periodoTexto += ` - ${frenteNome}`;
            }
            
            subtitleElement.textContent = `${periodoTexto} - Comparativo com metas`;
        }
    },

    // Performance das Frentes (ORIGINAL COMPLETO)
    createPerformanceFrentesChart: function() {
        const ctx = document.getElementById('chart-performance-frentes');
        if (!ctx || !window.Chart) return;
        
        const frentes = DB.frentes.getAll();
        const lancamentos = DB.lancamentos.getAll();
        const metas = DB.metas.getAll();
        
        const hoje = Utils.getLocalDateString();
        
        const labels = [];
        const dataPerformance = [];
        const cores = [];
        
        frentes.forEach(frente => {
            const colhido = lancamentos
                .filter(l => l.frenteId === frente.id && l.data === hoje)
                .reduce((sum, l) => sum + Number(l.colhido), 0);
            
            const meta = metas
                .filter(m => m.frenteId === frente.id && m.dataInicio <= hoje && m.dataFim >= hoje)
                .reduce((sum, m) => sum + Number(m.valor), 0);
            
            const performance = meta > 0 ? (colhido / meta) * 100 : 0;
            
            labels.push(frente.nome);
            dataPerformance.push(Math.round(performance));
            
            // Cores baseadas na performance
            if (performance >= 100) cores.push('#10b981');
            else if (performance >= 80) cores.push('#f59e0b');
            else cores.push('#ef4444');
        });
        
        if (AppConfig.charts.performanceFrentesChart) {
            AppConfig.charts.performanceFrentesChart.destroy();
        }
        
        AppConfig.charts.performanceFrentesChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: labels,
                datasets: [{
                    label: '% Meta',
                    data: dataPerformance,
                    backgroundColor: cores,
                    borderWidth: 0,
                    borderRadius: 4
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return `${context.parsed.y}% da meta`;
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 120,
                        ticks: {
                            callback: function(value) {
                                return value + '%';
                            }
                        }
                    },
                    x: {
                        ticks: {
                            maxRotation: 45,
                            font: { size: 10 }
                        }
                    }
                }
            }
        });
    },

    // Status das Liberações (ORIGINAL COMPLETO)
    createLiberacoesStatusChart: function() {
        const ctx = document.getElementById('chart-liberacoes-status');
        if (!ctx || !window.Chart) return;
        
        const liberacoes = DB.liberacoes.getAll();
        const statusCounts = {
            'aberto': 0,
            'em-andamento': 0,
            'fechado': 0,
            'cancelado': 0
        };
        
        liberacoes.forEach(l => {
            if (statusCounts[l.status] !== undefined) {
                statusCounts[l.status]++;
            }
        });
        
        if (AppConfig.charts.liberacoesStatusChart) {
            AppConfig.charts.liberacoesStatusChart.destroy();
        }
        
        AppConfig.charts.liberacoesStatusChart = new Chart(ctx, {
            type: 'doughnut',
            data: {
                labels: ['Aberto', 'Em Andamento', 'Fechado', 'Cancelado'],
                datasets: [{
                    data: [statusCounts.aberto, statusCounts['em-andamento'], statusCounts.fechado, statusCounts.cancelado],
                    backgroundColor: ['#f59e0b', '#3b82f6', '#10b981', '#ef4444'],
                    borderWidth: 0
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'bottom',
                        labels: { font: { size: 11 } }
                    }
                }
            }
        });
    },

    // Performance de Caminhões
    createCaminhoesPerformanceChart: function() {
        const ctx = document.getElementById('chart-caminhoes-performance');
        if (!ctx || !window.Chart) return;
        
        const caminhoes = DB.caminhoes.getAll();
        const metasCaminhoes = DB.metasCaminhoes.getAll();
        
        const labels = [];
        const dataPerformance = [];
        const cores = [];
        
        caminhoes.slice(0, 5).forEach(caminhao => {
            const meta = metasCaminhoes.find(m => m.caminhaoId === caminhao.id);
            const performance = meta ? Math.floor(Math.random() * 40) + 80 : 0; // Simulado
            
            labels.push(caminhao.placa);
            dataPerformance.push(performance);
            
            if (performance >= 95) cores.push('#10b981');
            else if (performance >= 85) cores.push('#f59e0b');
            else cores.push('#ef4444');
        });
        
        if (AppConfig.charts.caminhoesPerformanceChart) {
            AppConfig.charts.caminhoesPerformanceChart.destroy();
        }
        
        AppConfig.charts.caminhoesPerformanceChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: labels,
                datasets: [{
                    label: '% Eficiência',
                    data: dataPerformance,
                    backgroundColor: cores,
                    borderWidth: 0,
                    borderRadius: 4
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return `${context.parsed.y}% de eficiência`;
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 100,
                        ticks: {
                            callback: function(value) {
                                return value + '%';
                            }
                        }
                    }
                }
            }
        });
    },

    // Eficiência por Turno
    createEficienciaTurnoChart: function() {
        const ctx = document.getElementById('chart-eficiencia-turno');
        if (!ctx || !window.Chart) return;
        
        const data = {
            labels: ['Manhã', 'Tarde', 'Noite'],
            datasets: [{
                label: 'Eficiência %',
                data: [92, 88, 75], // Dados simulados
                backgroundColor: ['#10b981', '#f59e0b', '#ef4444'],
                borderWidth: 0,
                borderRadius: 4
            }]
        };
        
        if (AppConfig.charts.eficienciaTurnoChart) {
            AppConfig.charts.eficienciaTurnoChart.destroy();
        }
        
        AppConfig.charts.eficienciaTurnoChart = new Chart(ctx, {
            type: 'bar',
            data: data,
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return `${context.parsed.y}% de eficiência`;
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 100,
                        ticks: {
                            callback: function(value) {
                                return value + '%';
                            }
                        }
                    }
                }
            }
        });
    },

    // Atualizar tema dos gráficos (ORIGINAL COMPLETO)
    updateTheme: function() {
        if (!window.Chart) return;
        
        const isDark = document.documentElement.classList.contains('dark');
        Chart.defaults.color = isDark ? '#e5e7eb' : '#374151';
        Chart.defaults.borderColor = isDark ? '#374151' : '#e5e7eb';
        
        // Recriar gráficos com novo tema
        setTimeout(() => {
            this.createEvolucaoColheitaChart();
            this.createPerformanceFrentesChart();
            this.createLiberacoesStatusChart();
            this.createCaminhoesPerformanceChart();
            this.createEficienciaTurnoChart();
        }, 100);
    }
};

// Utilitários melhorados (COMPLETOS ORIGINAIS)
const Utils = {
    gerarId: function(prefixo = 'ID') {
        const timestamp = Date.now();
        const random = Math.random().toString(36).substr(2, 9);
        return `${prefixo}-${timestamp}-${random}`.toUpperCase();
    },
    
    formatarData: function(data) {
        if (!data) return '--';
        try {
            const d = typeof data === 'string' ? new Date(data) : data;
            return d.toLocaleDateString('pt-BR');
        } catch {
            return '--';
        }
    },
    
    formatarToneladas: function(valor, casasDecimais = 1) {
        if (valor === null || valor === undefined || isNaN(valor)) return '0 T';
        return `${Number(valor).toFixed(casasDecimais)} T`;
    },
    
    formatarPorcentagem: function(valor, casasDecimais = 1) {
        if (valor === null || valor === undefined || isNaN(valor)) return '0%';
        return `${Number(valor).toFixed(casasDecimais)}%`;
    },
    
    formatDateForInput: function(date) {
        if (!date) return '';
        const d = new Date(date);
        return d.toISOString().split('T')[0];
    },
    
    getLocalDateString: function() {
        const agora = new Date();
        agora.setMinutes(agora.getMinutes() - agora.getTimezoneOffset());
        return agora.toISOString().split('T')[0];
    },
    
    calcularPercentual: function(valor, total) {
        if (!total || total === 0) return 0;
        return (valor / total) * 100;
    },
    
    validarFormulario: function(dados, camposObrigatorios) {
        const erros = [];
        camposObrigatorios.forEach(campo => {
            if (!dados[campo] && dados[campo] !== 0) {
                erros.push(`Campo "${campo}" é obrigatório`);
            }
        });
        return erros;
    },
    
    debounce: function(func, wait) {
        let timeout;
        return function executedFunction(...args) {
            const later = () => {
                clearTimeout(timeout);
                func(...args);
            };
            clearTimeout(timeout);
            timeout = setTimeout(later, wait);
        };
    },
    
    formatarStatus: function(status) {
        const statusMap = {
            'aberto': 'Aberto',
            'em-andamento': 'Em Andamento',
            'fechado': 'Fechado',
            'cancelado': 'Cancelado',
            'ativa': 'Ativa',
            'inativa': 'Inativa',
            'manutencao': 'Manutenção',
            'ativo': 'Ativo',
            'inativo': 'Inativo',
            'propria': 'Própria',
            'terceira': 'Terceira',
            'desconhecido': 'Desconhecido',
            'proprio': 'Próprio',
            'terceiro': 'Terceiro'
        };
        return statusMap[status] || status;
    },
    
    getStatusColor: function(status) {
        const colorMap = {
            'aberto': 'text-blue-600 bg-blue-100 dark:text-blue-400 dark:bg-blue-900',
            'em-andamento': 'text-yellow-600 bg-yellow-100 dark:text-yellow-400 dark:bg-yellow-900',
            'fechado': 'text-green-600 bg-green-100 dark:text-green-400 dark:bg-green-900',
            'cancelado': 'text-red-600 bg-red-100 dark:text-red-400 dark:bg-red-900',
            'ativa': 'text-green-600 bg-green-100 dark:text-green-400 dark:bg-green-900',
            'inativa': 'text-gray-600 bg-gray-100 dark:text-gray-400 dark:bg-gray-900',
            'manutencao': 'text-orange-600 bg-orange-100 dark:text-orange-400 dark:bg-orange-900',
            'ativo': 'text-green-600 bg-green-100 dark:text-green-400 dark:bg-green-900',
            'inativo': 'text-gray-600 bg-gray-100 dark:text-gray-400 dark:bg-gray-900'
        };
        return colorMap[status] || 'text-gray-600 bg-gray-100 dark:text-gray-400 dark:bg-gray-900';
    }
};

// Sistema principal da aplicação MELHORADO COM FILTROS COMPLETOS
const App = {
    currentPage: 'dashboard',
    editingLiberacao: null,
    editingFrente: null,
    editingMeta: null,
    editingCaminhao: null,
    
    init: function() {
        try {
            DB.init();
            this.setupTheme();
            this.initEventListeners();
            this.updateCurrentDate();
            this.loadInitialData();
            ChartManager.init();
            
            setInterval(() => {
                this.updateCurrentDate();
            }, 60000);
            
            console.log('GGOMES-LOG v2.1 Avançado com Filtros inicializado com sucesso!');
        } catch (error) {
            console.error('Erro na inicialização:', error);
            Toast.show('Erro na inicialização da aplicação', 'error');
        }
    },
    
    setupTheme: function() {
        const config = JSON.parse(localStorage.getItem('ggomes_config') || '{}');
        if (config.temaEscuro) {
            document.documentElement.classList.add('dark');
        }
        
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
        
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (event.matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        });
    },
    
    initEventListeners: function() {
        // Toggle de tema
        document.getElementById('toggle-theme').addEventListener('click', () => {
            document.documentElement.classList.toggle('dark');
            const isDark = document.documentElement.classList.contains('dark');
            
            const config = JSON.parse(localStorage.getItem('ggomes_config') || '{}');
            config.temaEscuro = isDark;
            localStorage.setItem('ggomes_config', JSON.stringify(config));
            
            ChartManager.updateTheme();
        });
        
        // Notificações
        document.getElementById('btn-notifications').addEventListener('click', () => {
            this.showNotifications();
        });
        
        // Refresh dashboard
        document.getElementById('btn-refresh-dashboard').addEventListener('click', () => {
            this.loadDashboard();
            Toast.show('Dashboard atualizado', 'success');
        });
        
        // Auto-refresh toggle
        const autoRefreshBtn = document.getElementById('btn-auto-refresh-acompanhamento');
        if (autoRefreshBtn) {
            autoRefreshBtn.addEventListener('click', () => {
                this.toggleAutoRefresh();
            });
        }
        
        // Filtros do gráfico de evolução (NOVOS FILTROS IMPLEMENTADOS)
        this.initChartFilters();
        
        // Configurações
        this.initConfigEventListeners();
        
        // Abas
        this.initTabEventListeners();
        
        // Formulários
        this.initFormEventListeners();
        
        // Mobile menu toggle
        document.getElementById('mobile-menu-toggle').addEventListener('click', () => {
            document.getElementById('app-container').classList.toggle('sidebar-open');
        });
        
        // Busca global
        const searchGlobal = document.getElementById('search-global');
        if (searchGlobal) {
            searchGlobal.addEventListener('input', Utils.debounce((e) => {
                this.performGlobalSearch(e.target.value);
            }, 300));
        }
    },

    loadInitialData: function() {
        this.navigateTo('dashboard');
    },
    
    // ===== FILTROS DO GRÁFICO DE EVOLUÇÃO (NOVOS IMPLEMENTADOS) =====
    
    initChartFilters: function() {
        // Inicializar datas padrão
        this.setChartDefaultDates();
        
        // Carregar frentes no filtro
        this.updateChartFrentesFilter();
        
        // Event Listeners
        const toggleBtn = document.getElementById('btn-toggle-chart-filters');
        if (toggleBtn) {
            toggleBtn.addEventListener('click', () => {
                const filters = document.getElementById('chart-filters');
                if (filters) {
                    filters.classList.toggle('hidden');
                    const isVisible = !filters.classList.contains('hidden');
                    toggleBtn.innerHTML = isVisible ? 
                        '<i class="fas fa-filter mr-1"></i> Ocultar' : 
                        '<i class="fas fa-filter mr-1"></i> Filtros';
                }
            });
        }
        
        // Botões de período rápido
        const btn7d = document.getElementById('btn-chart-7d');
        if (btn7d) {
            btn7d.addEventListener('click', () => {
                this.setChartPeriod(7);
                this.updatePeriodButtons('btn-chart-7d');
            });
        }
        
        const btn30d = document.getElementById('btn-chart-30d');
        if (btn30d) {
            btn30d.addEventListener('click', () => {
                this.setChartPeriod(30);
                this.updatePeriodButtons('btn-chart-30d');
            });
        }
        
        const btn90d = document.getElementById('btn-chart-90d');
        if (btn90d) {
            btn90d.addEventListener('click', () => {
                this.setChartPeriod(90);
                this.updatePeriodButtons('btn-chart-90d');
            });
        }
        
        // Botões de ação
        const applyBtn = document.getElementById('btn-apply-chart-filters');
        if (applyBtn) {
            applyBtn.addEventListener('click', () => {
                this.applyChartFilters();
            });
        }
        
        const clearBtn = document.getElementById('btn-clear-chart-filters');
        if (clearBtn) {
            clearBtn.addEventListener('click', () => {
                this.clearChartFilters();
            });
        }
        
        const refreshBtn = document.getElementById('btn-refresh-chart');
        if (refreshBtn) {
            refreshBtn.addEventListener('click', () => {
                this.applyChartFilters();
                Toast.show('Gráfico atualizado', 'success');
            });
        }
    },
    
    setChartDefaultDates: function() {
        const hoje = Utils.getLocalDateString();
        const dataInicial = new Date();
        dataInicial.setDate(dataInicial.getDate() - 30);
        const dataInicialStr = Utils.formatDateForInput(dataInicial);
        
        const inicioInput = document.getElementById('chart-data-inicio');
        const fimInput = document.getElementById('chart-data-fim');
        
        if (inicioInput && !inicioInput.value) {
            inicioInput.value = dataInicialStr;
        }
        
        if (fimInput && !fimInput.value) {
            fimInput.value = hoje;
        }
    },
    
    updateChartFrentesFilter: function() {
        const select = document.getElementById('chart-frente-filter');
        if (!select) return;
        
        const frentes = DB.frentes.getAll();
        const currentValue = select.value;
        
        select.innerHTML = '<option value="">Todas as frentes</option>' +
            frentes.map(f => `<option value="${f.id}">${f.nome} - ${f.fazenda}</option>`).join('');
        
        select.value = currentValue;
    },
    
    setChartPeriod: function(days) {
        const hoje = new Date();
        const dataInicial = new Date();
        dataInicial.setDate(dataInicial.getDate() - days);
        
        const inicioInput = document.getElementById('chart-data-inicio');
        const fimInput = document.getElementById('chart-data-fim');
        
        if (inicioInput) inicioInput.value = Utils.formatDateForInput(dataInicial);
        if (fimInput) fimInput.value = Utils.formatDateForInput(hoje);
        
        // Aplicar automaticamente
        this.applyChartFilters();
    },
    
    updatePeriodButtons: function(activeId) {
        // Resetar todos os botões
        ['btn-chart-7d', 'btn-chart-30d', 'btn-chart-90d'].forEach(id => {
            const btn = document.getElementById(id);
            if (btn) {
                btn.className = 'text-xs px-3 py-1 bg-gray-200 hover:bg-gray-300 dark:bg-gray-600 dark:hover:bg-gray-500 text-gray-700 dark:text-gray-300 rounded-md transition-all-300';
            }
        });
        
        // Destacar o ativo
        const activeBtn = document.getElementById(activeId);
        if (activeBtn) {
            activeBtn.className = 'text-xs px-3 py-1 bg-primary-100 dark:bg-primary-900 text-primary-700 dark:text-primary-300 rounded-md transition-all-300';
        }
    },
    
    applyChartFilters: function() {
        const dataInicio = document.getElementById('chart-data-inicio')?.value;
        const dataFim = document.getElementById('chart-data-fim')?.value;
        const frenteId = document.getElementById('chart-frente-filter')?.value;
        
        // Validar datas
        if (dataInicio && dataFim && new Date(dataInicio) > new Date(dataFim)) {
            Toast.show('Data de início deve ser anterior à data de fim', 'error');
            return;
        }
        
        // Destruir gráfico existente se houver
        if (AppConfig.charts.evolucaoColheitaChart) {
            AppConfig.charts.evolucaoColheitaChart.destroy();
        }
        
        // Criar novo gráfico com filtros
        ChartManager.createEvolucaoColheitaChart(dataInicio, dataFim, frenteId);
        
        Toast.show('Filtros aplicados ao gráfico', 'success');
    },
    
    clearChartFilters: function() {
        // Limpar campos
        const dataInicioInput = document.getElementById('chart-data-inicio');
        const dataFimInput = document.getElementById('chart-data-fim');
        const frenteSelect = document.getElementById('chart-frente-filter');
        
        if (dataInicioInput) dataInicioInput.value = '';
        if (dataFimInput) dataFimInput.value = '';
        if (frenteSelect) frenteSelect.value = '';
        
        // Definir valores padrão
        this.setChartDefaultDates();
        
        // Resetar botões de período
        this.updatePeriodButtons('btn-chart-30d');
        
        // Aplicar filtros limpos
        this.applyChartFilters();
        
        Toast.show('Filtros do gráfico limpos', 'info');
    },
    
    // ===== OUTRAS FUNÇÕES ORIGINAIS COMPLETAS =====
    
    updateCurrentDate: function() {
        const agora = new Date();
        const data = agora.toLocaleDateString('pt-BR');
        const elemento = document.getElementById('current-date');
        if (elemento) {
            elemento.textContent = data;
        }
    },
    
    navigateTo: function(page) {
        try {
            // Remover classe active de todos os links
            document.querySelectorAll('.sidebar-link').forEach(link => {
                link.classList.remove('active', 'bg-primary-100', 'dark:bg-primary-900', 'text-primary-700', 'dark:text-primary-300');
                link.classList.add('text-gray-700', 'dark:text-gray-300');
            });
            
            // Ocultar todos os conteúdos
            document.querySelectorAll('.content').forEach(content => {
                content.classList.add('hidden');
            });
            
            // Ativar link correspondente
            const activeLink = document.querySelector(`a[href="#${page}"]`);
            if (activeLink) {
                activeLink.classList.add('active', 'bg-primary-100', 'dark:bg-primary-900', 'text-primary-700', 'dark:text-primary-300');
                activeLink.classList.remove('text-gray-700', 'dark:text-gray-300');
            }
            
            // Mostrar conteúdo correspondente
            const contentElement = document.getElementById(`content-${page}`);
            if (contentElement) {
                contentElement.classList.remove('hidden');
            }
            
            // Atualizar título da página
            const pageTitles = {
                'dashboard': 'Dashboard',
                'acompanhamento': 'Acompanhamento',
                'liberacoes': 'Liberações',
                'frentes': 'Frentes de Trabalho',
                'metas': 'Metas de Colheita',
                'caminhoes': 'Metas de Caminhões',
                'relatorios': 'Relatórios',
                'configuracoes': 'Configurações'
            };
            
            const pageSubtitles = {
                'dashboard': 'Visão geral do sistema e indicadores principais',
                'acompanhamento': 'Monitoramento detalhado das operações',
                'liberacoes': 'Gestão completa das liberações de colheita',
                'frentes': 'Controle de frentes próprias, terceiras e desconhecidas',
                'metas': 'Definição e controle de metas por frente',
                'caminhoes': 'Gestão de metas para caminhões próprios e terceiros',
                'relatorios': 'Geração e exportação de relatórios',
                'configuracoes': 'Configurações do sistema e preferências'
            };
            
            const pageTitle = document.getElementById('page-title');
            const pageSubtitle = document.getElementById('page-subtitle');
            
            if (pageTitle && pageTitles[page]) {
                pageTitle.textContent = pageTitles[page];
            }
            
            if (pageSubtitle && pageSubtitles[page]) {
                pageSubtitle.textContent = pageSubtitles[page];
            }
            
            this.currentPage = page;
            
            // Carregar dados específicos da página
            switch(page) {
                case 'dashboard':
                    this.loadDashboard();
                    break;
                case 'acompanhamento':
                    this.loadAcompanhamento();
                    break;
                case 'liberacoes':
                    this.loadLiberacoes();
                    break;
                case 'frentes':
                    this.loadFrentes();
                    break;
                case 'metas':
                    this.loadMetas();
                    break;
                case 'caminhoes':
                    this.loadCaminhoes();
                    break;
                case 'relatorios':
                    this.loadRelatorios();
                    break;
                case 'configuracoes':
                    this.loadConfiguracoes();
                    break;
            }
            
            // Fechar sidebar mobile após navegação
            document.getElementById('app-container').classList.remove('sidebar-open');
            
        } catch (error) {
            console.error('Erro na navegação:', error);
            Toast.show('Erro ao carregar a página', 'error');
        }
    },
    
    loadDashboard: function() {
        try {
            // Atualizar KPIs
            this.updateDashboardKPIs();
            
            // Atualizar atividades e rankings
            this.updateDashboardActivities();
            
            // Criar gráficos
            setTimeout(() => {
                ChartManager.createEvolucaoColheitaChart();
                ChartManager.createPerformanceFrentesChart();
                ChartManager.createLiberacoesStatusChart();
                ChartManager.createCaminhoesPerformanceChart();
                ChartManager.createEficienciaTurnoChart();
                
                // Atualizar filtros de frentes
                this.updateChartFrentesFilter();
            }, 100);
            
            // Atualizar status geral
            document.getElementById('dash-ultima-atualizacao').textContent = 
                `Atualizado às ${new Date().toLocaleTimeString('pt-BR')}`;
                
        } catch (error) {
            console.error('Erro ao carregar dashboard:', error);
            Toast.show('Erro ao carregar dashboard', 'error');
        }
    },
    
    updateDashboardKPIs: function() {
        try {
            const lancamentos = DB.lancamentos.getAll();
            const metas = DB.metas.getAll();
            const frentes = DB.frentes.getAll();
            const liberacoes = DB.liberacoes.getAll();
            const caminhoes = DB.caminhoes.getAll();
            
            // Total colhido últimos 30 dias
            const hoje = new Date();
            const dataInicial = new Date(hoje.getTime() - 30 * 24 * 60 * 60 * 1000);
            
            const colhidoTotal = lancamentos
                .filter(l => {
                    const dataLanc = new Date(l.data);
                    return dataLanc >= dataInicial && dataLanc <= hoje;
                })
                .reduce((sum, l) => sum + Number(l.colhido), 0);
            
            const metaTotal = metas
                .reduce((sum, m) => sum + Number(m.valor), 0);
            
            // Atualizar elementos
            document.getElementById('dash-total-colhido').textContent = Utils.formatarToneladas(colhidoTotal);
            document.getElementById('dash-colhido-meta').textContent = `Meta: ${Utils.formatarToneladas(metaTotal)}`;
            
            // Frentes ativas
            const frentesAtivas = frentes.filter(f => f.status === 'ativa').length;
            document.getElementById('dash-frentes-ativas').textContent = `${frentesAtivas}/${frentes.length}`;
            
            // Liberações
            const liberacoesAbertas = liberacoes.filter(l => l.status === 'aberto' || l.status === 'em-andamento').length;
            document.getElementById('dash-total-liberacoes').textContent = liberacoesAbertas;
            
            // Caminhões ativos
            const caminhoesAtivos = caminhoes.filter(c => c.status === 'ativo').length;
            document.getElementById('dash-caminhoes-ativos').textContent = `${caminhoesAtivos}/${caminhoes.length}`;
            
            // Eficiência geral
            const eficiencia = metaTotal > 0 ? (colhidoTotal / metaTotal) * 100 : 0;
            document.getElementById('dash-eficiencia-geral').textContent = Utils.formatarPorcentagem(eficiencia, 0);
            
            // Metas atingidas
            const metasAtingidas = metas.filter(m => {
                const colhidoMeta = lancamentos
                    .filter(l => l.frenteId === m.frenteId && l.data >= m.dataInicio && l.data <= m.dataFim)
                    .reduce((sum, l) => sum + Number(l.colhido), 0);
                return colhidoMeta >= Number(m.valor);
            }).length;
            
            document.getElementById('dash-metas-atingidas').textContent = `${metasAtingidas}/${metas.length}`;
            
        } catch (error) {
            console.error('Erro ao atualizar KPIs:', error);
        }
    },

    updateDashboardActivities: function() {
        try {
            // Top frentes
            const frentes = DB.frentes.getAll();
            const lancamentos = DB.lancamentos.getAll();
            const metas = DB.metas.getAll();
            const hoje = Utils.getLocalDateString();
            
            const frentesPerformance = frentes.map(frente => {
                const colhido = lancamentos
                    .filter(l => l.frenteId === frente.id && l.data === hoje)
                    .reduce((sum, l) => sum + Number(l.colhido), 0);
                
                const meta = metas
                    .filter(m => m.frenteId === frente.id && m.dataInicio <= hoje && m.dataFim >= hoje)
                    .reduce((sum, m) => sum + Number(m.valor), 0);
                
                const performance = meta > 0 ? (colhido / meta) * 100 : 0;
                
                return { ...frente, colhido, meta, performance };
            })
            .sort((a, b) => b.performance - a.performance)
            .slice(0, 5);
            
            const topFrentesElement = document.getElementById('dash-top-frentes');
            if (topFrentesElement) {
                topFrentesElement.innerHTML = frentesPerformance.map((frente, index) => {
                    const medal = index === 0 ? '🥇' : index === 1 ? '🥈' : index === 2 ? '🥉' : `${index + 1}º`;
                    const performanceColor = frente.performance >= 100 ? 'text-green-600' : 
                                           frente.performance >= 80 ? 'text-yellow-600' : 'text-red-600';
                    
                    return `
                        <div class="flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg">
                            <div class="flex items-center">
                                <span class="text-lg mr-3">${medal}</span>
                                <div>
                                    <p class="font-medium text-gray-800 dark:text-white">${frente.nome}</p>
                                    <p class="text-xs text-gray-500 dark:text-gray-400">${frente.fazenda}</p>
                                </div>
                            </div>
                            <div class="text-right">
                                <p class="font-bold ${performanceColor}">${Utils.formatarPorcentagem(frente.performance, 0)}</p>
                                <p class="text-xs text-gray-500 dark:text-gray-400">${Utils.formatarToneladas(frente.colhido)}</p>
                            </div>
                        </div>
                    `;
                }).join('');
            }
            
            // Atividade recente
            const liberacoes = DB.liberacoes.getAll()
                .sort((a, b) => new Date(b.dataRegistro) - new Date(a.dataRegistro))
                .slice(0, 5);
            
            const atividadeRecenteElement = document.getElementById('dash-atividade-recente');
            if (atividadeRecenteElement) {
                atividadeRecenteElement.innerHTML = liberacoes.map(liberacao => {
                    const statusColor = Utils.getStatusColor(liberacao.status);
                    const timeAgo = this.getTimeAgo(new Date(liberacao.dataRegistro));
                    
                    return `
                        <div class="flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg">
                            <div class="flex items-center">
                                <div class="w-2 h-2 rounded-full bg-primary-500 mr-3"></div>
                                <div>
                                    <p class="font-medium text-gray-800 dark:text-white text-sm">${liberacao.numero || liberacao.id}</p>
                                    <p class="text-xs text-gray-500 dark:text-gray-400">${liberacao.frente} - ${liberacao.fazenda}</p>
                                </div>
                            </div>
                            <div class="text-right">
                                <span class="text-xs px-2 py-1 rounded-full ${statusColor}">${Utils.formatarStatus(liberacao.status)}</span>
                                <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">${timeAgo}</p>
                            </div>
                        </div>
                    `;
                }).join('') || '<p class="text-gray-500 dark:text-gray-400 text-sm text-center py-4">Nenhuma atividade recente</p>';
            }
            
        } catch (error) {
            console.error('Erro ao atualizar atividades:', error);
        }
    },

    getTimeAgo: function(date) {
        const now = new Date();
        const diffMs = now - date;
        const diffMins = Math.floor(diffMs / (1000 * 60));
        const diffHours = Math.floor(diffMs / (1000 * 60 * 60));
        const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));
        
        if (diffMins < 1) return 'Agora';
        if (diffMins < 60) return `${diffMins}m atrás`;
        if (diffHours < 24) return `${diffHours}h atrás`;
        return `${diffDays}d atrás`;
    },

    // Funções de carregamento das outras páginas (IMPLEMENTADAS COMPLETAS)
    loadAcompanhamento: function() {
        try {
            this.updateAcompanhamentoKPIs();
            this.loadAcompanhamentoData();
            this.updateAcompanhamentoFilters();
        } catch (error) {
            console.error('Erro ao carregar acompanhamento:', error);
            Toast.show('Erro ao carregar dados de acompanhamento', 'error');
        }
    },

    updateAcompanhamentoKPIs: function() {
        // Implementar KPIs do acompanhamento
        const hoje = Utils.getLocalDateString();
        const lancamentos = DB.lancamentos.getAll();
        const metas = DB.metas.getAll();
        const frentes = DB.frentes.getAll();
        
        // Colheita hoje
        const colheitaHoje = lancamentos
            .filter(l => l.data === hoje)
            .reduce((sum, l) => sum + Number(l.colhido), 0);
            
        const metaHoje = metas
            .filter(m => m.dataInicio <= hoje && m.dataFim >= hoje)
            .reduce((sum, m) => sum + Number(m.valor), 0);
        
        document.getElementById('acomp-colheita-hoje').textContent = Utils.formatarToneladas(colheitaHoje);
        document.getElementById('acomp-colheita-meta-hoje').textContent = `Meta: ${Utils.formatarToneladas(metaHoje)}`;
        
        // Frentes ativas
        const frentesAtivas = frentes.filter(f => f.status === 'ativa').length;
        document.getElementById('acomp-frentes-ativas').textContent = `${frentesAtivas}/${frentes.length}`;
        
        // Performance geral
        const performance = metaHoje > 0 ? (colheitaHoje / metaHoje) * 100 : 0;
        document.getElementById('acomp-performance-geral').textContent = Utils.formatarPorcentagem(performance, 1);
        
        // Eficiência média últimos 7 dias
        const dataInicial7d = new Date();
        dataInicial7d.setDate(dataInicial7d.getDate() - 7);
        
        const colheita7d = lancamentos
            .filter(l => {
                const dataLanc = new Date(l.data);
                return dataLanc >= dataInicial7d && dataLanc <= new Date();
            })
            .reduce((sum, l) => sum + Number(l.colhido), 0);
            
        const meta7d = metas
            .reduce((sum, m) => sum + Number(m.valor) * 7, 0); // Aproximação
        
        const eficiencia7d = meta7d > 0 ? (colheita7d / meta7d) * 100 : 0;
        document.getElementById('acomp-eficiencia-media').textContent = Utils.formatarPorcentagem(eficiencia7d, 1);
    },

    loadAcompanhamentoData: function() {
        // Implementar carregamento da tabela de acompanhamento
        const frentes = DB.frentes.getAll();
        const lancamentos = DB.lancamentos.getAll();
        const metas = DB.metas.getAll();
        const hoje = Utils.getLocalDateString();
        
        const dados = frentes.map(frente => {
            const colhido = lancamentos
                .filter(l => l.frenteId === frente.id && l.data === hoje)
                .reduce((sum, l) => sum + Number(l.colhido), 0);
            
            const meta = metas
                .filter(m => m.frenteId === frente.id && m.dataInicio <= hoje && m.dataFim >= hoje)
                .reduce((sum, m) => sum + Number(m.valor), 0);
            
            const percentualMeta = meta > 0 ? (colhido / meta) * 100 : 0;
            
            return {
                frente: frente.nome,
                fazenda: frente.fazenda,
                tipo: frente.tipo,
                colhido,
                meta,
                percentualMeta,
                status: frente.status,
                ultimaAtualizacao: new Date().toLocaleTimeString('pt-BR')
            };
        });
        
        this.renderAcompanhamentoTable(dados);
        document.getElementById('acomp-total-registros').textContent = dados.length;
    },

    renderAcompanhamentoTable: function(dados) {
        const tbody = document.getElementById('tabela-acompanhamento');
        if (!tbody) return;
        
        tbody.innerHTML = dados.map(item => {
            const statusColor = Utils.getStatusColor(item.status);
            const percentualColor = item.percentualMeta >= 100 ? 'text-green-600' : 
                                  item.percentualMeta >= 80 ? 'text-yellow-600' : 'text-red-600';
            
            return `
                <tr class="hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                    <td class="px-6 py-4">
                        <div class="font-medium text-gray-800 dark:text-white">${item.frente}</div>
                        <div class="text-sm text-gray-500 dark:text-gray-400">${Utils.formatarStatus(item.tipo)}</div>
                    </td>
                    <td class="px-6 py-4 text-gray-800 dark:text-gray-300">${item.fazenda}</td>
                    <td class="px-6 py-4">
                        <div class="font-medium text-gray-800 dark:text-white">${Utils.formatarToneladas(item.colhido)}</div>
                        <div class="text-sm text-gray-500 dark:text-gray-400">Realizado</div>
                    </td>
                    <td class="px-6 py-4">
                        <div class="font-medium text-gray-800 dark:text-white">${Utils.formatarToneladas(item.meta)}</div>
                        <div class="text-sm text-gray-500 dark:text-gray-400">Objetivo</div>
                    </td>
                    <td class="px-6 py-4">
                        <div class="font-bold ${percentualColor}">${Utils.formatarPorcentagem(item.percentualMeta, 1)}</div>
                        <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1.5 mt-1">
                            <div class="bg-primary-600 h-1.5 rounded-full transition-all-300" style="width: ${Math.min(item.percentualMeta, 100)}%"></div>
                        </div>
                    </td>
                    <td class="px-6 py-4">
                        <span class="px-2 py-1 text-xs rounded-full ${statusColor}">${Utils.formatarStatus(item.status)}</span>
                    </td>
                    <td class="px-6 py-4 text-sm text-gray-500 dark:text-gray-400">${item.ultimaAtualizacao}</td>
                </tr>
            `;
        }).join('');
    },

    updateAcompanhamentoFilters: function() {
        // Implementar filtros do acompanhamento
        const frentes = DB.frentes.getAll();
        const fazendas = [...new Set(frentes.map(f => f.fazenda))];
        
        // Filtro de frentes
        const frenteSelect = document.getElementById('filtro-frente-acomp');
        if (frenteSelect) {
            frenteSelect.innerHTML = '<option value="">Todas as frentes</option>' +
                frentes.map(f => `<option value="${f.nome}">${f.nome}</option>`).join('');
        }
        
        // Filtro de fazendas
        const fazendaSelect = document.getElementById('filtro-fazenda-acomp');
        if (fazendaSelect) {
            fazendaSelect.innerHTML = '<option value="">Todas as fazendas</option>' +
                fazendas.map(f => `<option value="${f}">${f}</option>`).join('');
        }
    },

    loadLiberacoes: function() {
        try {
            this.updateLiberacoesKPIs();
            this.loadLiberacoesData();
            this.updateLiberacoesFilters();
            this.initLiberacoesEventListeners();
        } catch (error) {
            console.error('Erro ao carregar liberações:', error);
            Toast.show('Erro ao carregar liberações', 'error');
        }
    },

    updateLiberacoesKPIs: function() {
        const liberacoes = DB.liberacoes.getAll();
        const totals = DB.liberacoes.getTotals();
        
        document.getElementById('total-abertas').textContent = totals.statusAberto;
        document.getElementById('total-andamento').textContent = totals.statusEmAndamento;
        document.getElementById('total-concluidas').textContent = totals.statusFechado;
        document.getElementById('total-previsto').textContent = Utils.formatarToneladas(totals.previsto);
    },

    loadLiberacoesData: function() {
        const liberacoes = DB.liberacoes.getAll();
        this.renderLiberacoesTable(liberacoes);
        document.getElementById('total-liberacoes').textContent = liberacoes.length;
    },

    renderLiberacoesTable: function(liberacoes) {
        const tbody = document.getElementById('tabela-liberacoes');
        if (!tbody) return;
        
        tbody.innerHTML = liberacoes.map(liberacao => {
            const statusColor = Utils.getStatusColor(liberacao.status);
            
            return `
                <tr class="hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                    <td class="px-6 py-4 font-medium text-gray-800 dark:text-white">${liberacao.numero || liberacao.id}</td>
                    <td class="px-6 py-4 text-gray-800 dark:text-gray-300">${liberacao.frente}</td>
                    <td class="px-6 py-4 text-gray-800 dark:text-gray-300">${liberacao.fazenda}</td>
                    <td class="px-6 py-4 text-gray-800 dark:text-gray-300">${Utils.formatarToneladas(liberacao.previsto)}</td>
                    <td class="px-6 py-4 text-gray-800 dark:text-gray-300">${Utils.formatarToneladas(liberacao.realizado)}</td>
                    <td class="px-6 py-4 text-gray-800 dark:text-gray-300">${Utils.formatarToneladas(liberacao.restante)}</td>
                    <td class="px-6 py-4">
                        <span class="px-2 py-1 text-xs rounded-full ${statusColor}">${Utils.formatarStatus(liberacao.status)}</span>
                    </td>
                    <td class="px-6 py-4 text-gray-800 dark:text-gray-300">${Utils.formatarData(liberacao.data)}</td>
                    <td class="px-6 py-4">
                        <div class="flex items-center space-x-2">
                            <button onclick="App.editLiberacao('${liberacao.id}')" class="text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button onclick="App.deleteLiberacao('${liberacao.id}')" class="text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                </tr>
            `;
        }).join('');
    },

    updateLiberacoesFilters: function() {
        const liberacoes = DB.liberacoes.getAll();
        const frentes = [...new Set(liberacoes.map(l => l.frente))];
        const fazendas = [...new Set(liberacoes.map(l => l.fazenda))];
        
        // Filtro de frentes
        const frenteSelect = document.getElementById('filtro-frente-lib');
        if (frenteSelect) {
            frenteSelect.innerHTML = '<option value="">Todas as frentes</option>' +
                frentes.map(f => `<option value="${f}">${f}</option>`).join('');
        }
        
        // Filtro de fazendas
        const fazendaSelect = document.getElementById('filtro-fazenda-lib');
        if (fazendaSelect) {
            fazendaSelect.innerHTML = '<option value="">Todas as fazendas</option>' +
                fazendas.map(f => `<option value="${f}">${f}</option>`).join('');
        }
    },

    initLiberacoesEventListeners: function() {
        // Nova liberação
        const btnNova = document.getElementById('btn-nova-liberacao');
        if (btnNova) {
            btnNova.addEventListener('click', () => {
                this.openLiberacaoModal();
            });
        }
        
        // Modal de liberação
        const modal = document.getElementById('modal-liberacao');
        const btnFechar = document.getElementById('btn-fechar-modal-liberacao');
        const btnCancelar = document.getElementById('btn-cancelar-liberacao');
        const form = document.getElementById('form-liberacao');
        
        if (btnFechar) {
            btnFechar.addEventListener('click', () => {
                this.closeLiberacaoModal();
            });
        }
        
        if (btnCancelar) {
            btnCancelar.addEventListener('click', () => {
                this.closeLiberacaoModal();
            });
        }
        
        if (form) {
            form.addEventListener('submit', (e) => {
                e.preventDefault();
                this.saveLiberacao();
            });
        }
    },

    openLiberacaoModal: function(liberacao = null) {
        const modal = document.getElementById('modal-liberacao');
        const title = document.getElementById('modal-liberacao-title');
        
        this.editingLiberacao = liberacao;
        
        if (liberacao) {
            title.textContent = 'Editar Liberação';
            this.fillLiberacaoForm(liberacao);
        } else {
            title.textContent = 'Nova Liberação';
            this.clearLiberacaoForm();
        }
        
        modal.classList.remove('hidden');
    },

    closeLiberacaoModal: function() {
        const modal = document.getElementById('modal-liberacao');
        modal.classList.add('hidden');
        this.editingLiberacao = null;
        this.clearLiberacaoForm();
    },

    fillLiberacaoForm: function(liberacao) {
        document.getElementById('liberacao-numero').value = liberacao.numero || '';
        document.getElementById('liberacao-frente').value = liberacao.frente || '';
        document.getElementById('liberacao-fazenda').value = liberacao.fazenda || '';
        document.getElementById('liberacao-previsto').value = liberacao.previsto || '';
        document.getElementById('liberacao-realizado').value = liberacao.realizado || '';
        document.getElementById('liberacao-status').value = liberacao.status || 'aberto';
        document.getElementById('liberacao-data').value = liberacao.data || Utils.getLocalDateString();
        document.getElementById('liberacao-observacoes').value = liberacao.observacoes || '';
    },

    clearLiberacaoForm: function() {
        document.getElementById('form-liberacao').reset();
        document.getElementById('liberacao-data').value = Utils.getLocalDateString();
    },

    saveLiberacao: function() {
        try {
            const formData = {
                numero: document.getElementById('liberacao-numero').value,
                frente: document.getElementById('liberacao-frente').value,
                fazenda: document.getElementById('liberacao-fazenda').value,
                previsto: parseFloat(document.getElementById('liberacao-previsto').value),
                realizado: parseFloat(document.getElementById('liberacao-realizado').value),
                status: document.getElementById('liberacao-status').value,
                data: document.getElementById('liberacao-data').value,
                observacoes: document.getElementById('liberacao-observacoes').value
            };
            
            if (this.editingLiberacao) {
                formData.id = this.editingLiberacao.id;
                DB.liberacoes.update(formData);
                Toast.show('Liberação atualizada com sucesso!', 'success');
            } else {
                DB.liberacoes.add(formData);
                Toast.show('Liberação criada com sucesso!', 'success');
            }
            
            this.closeLiberacaoModal();
            this.loadLiberacoes();
            
        } catch (error) {
            console.error('Erro ao salvar liberação:', error);
            Toast.show(error.message, 'error');
        }
    },

    editLiberacao: function(id) {
        const liberacao = DB.liberacoes.get(id);
        if (liberacao) {
            this.openLiberacaoModal(liberacao);
        }
    },

    deleteLiberacao: function(id) {
        this.showConfirmDialog('Tem certeza que deseja excluir esta liberação?', () => {
            try {
                DB.liberacoes.remove(id);
                Toast.show('Liberação excluída com sucesso!', 'success');
                this.loadLiberacoes();
            } catch (error) {
                console.error('Erro ao excluir liberação:', error);
                Toast.show(error.message, 'error');
            }
        });
    },

    loadFrentes: function() {
        try {
            this.updateFrentesKPIs();
            this.loadFrentesData();
            this.initFrentesEventListeners();
        } catch (error) {
            console.error('Erro ao carregar frentes:', error);
            Toast.show('Erro ao carregar frentes', 'error');
        }
    },

    updateFrentesKPIs: function() {
        const frentes = DB.frentes.getAll();
        
        const proprias = frentes.filter(f => f.tipo === 'propria').length;
        const terceiras = frentes.filter(f => f.tipo === 'terceira').length;
        const desconhecidas = frentes.filter(f => f.tipo === 'desconhecido').length;
        const ativas = frentes.filter(f => f.status === 'ativa').length;
        
        document.getElementById('total-frentes-proprias').textContent = proprias;
        document.getElementById('total-frentes-terceiras').textContent = terceiras;
        document.getElementById('total-frentes-desconhecidas').textContent = desconhecidas;
        document.getElementById('total-frentes-ativas').textContent = ativas;
    },

    loadFrentesData: function() {
        const frentes = DB.frentes.getAll();
        this.renderFrentesTable(frentes);
        document.getElementById('total-frentes-lista').textContent = frentes.length;
    },

    renderFrentesTable: function(frentes) {
        const tbody = document.getElementById('tabela-frentes');
        if (!tbody) return;
        
        tbody.innerHTML = frentes.map(frente => {
            const statusColor = Utils.getStatusColor(frente.status);
            const tipoColor = frente.tipo === 'propria' ? 'text-green-600 bg-green-100 dark:text-green-400 dark:bg-green-900' :
                             frente.tipo === 'terceira' ? 'text-blue-600 bg-blue-100 dark:text-blue-400 dark:bg-blue-900' :
                             'text-yellow-600 bg-yellow-100 dark:text-yellow-400 dark:bg-yellow-900';
            
            return `
                <tr class="hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                    <td class="px-6 py-4 font-medium text-gray-800 dark:text-white">${frente.nome}</td>
                    <td class="px-6 py-4 text-gray-800 dark:text-gray-300">${frente.fazenda}</td>
                    <td class="px-6 py-4">
                        <span class="px-2 py-1 text-xs rounded-full ${tipoColor}">${Utils.formatarStatus(frente.tipo)}</span>
                    </td>
                    <td class="px-6 py-4 text-gray-800 dark:text-gray-300">${frente.responsavel}</td>
                    <td class="px-6 py-4">
                        <span class="px-2 py-1 text-xs rounded-full ${statusColor}">${Utils.formatarStatus(frente.status)}</span>
                    </td>
                    <td class="px-6 py-4">
                        <div class="flex items-center space-x-2">
                            <button onclick="App.editFrente('${frente.id}')" class="text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button onclick="App.deleteFrente('${frente.id}')" class="text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                </tr>
            `;
        }).join('');
    },

    initFrentesEventListeners: function() {
        // Nova frente
        const btnNova = document.getElementById('btn-nova-frente');
        if (btnNova) {
            btnNova.addEventListener('click', () => {
                this.openFrenteModal();
            });
        }
        
        // Modal de frente
        const modal = document.getElementById('modal-frente');
        const btnFechar = document.getElementById('btn-fechar-modal-frente');
        const btnCancelar = document.getElementById('btn-cancelar-frente');
        const form = document.getElementById('form-frente');
        
        if (btnFechar) {
            btnFechar.addEventListener('click', () => {
                this.closeFrenteModal();
            });
        }
        
        if (btnCancelar) {
            btnCancelar.addEventListener('click', () => {
                this.closeFrenteModal();
            });
        }
        
        if (form) {
            form.addEventListener('submit', (e) => {
                e.preventDefault();
                this.saveFrente();
            });
        }
    },

    openFrenteModal: function(frente = null) {
        const modal = document.getElementById('modal-frente');
        const title = document.getElementById('modal-frente-title');
        
        this.editingFrente = frente;
        
        if (frente) {
            title.textContent = 'Editar Frente';
            this.fillFrenteForm(frente);
        } else {
            title.textContent = 'Nova Frente';
            this.clearFrenteForm();
        }
        
        modal.classList.remove('hidden');
    },

    closeFrenteModal: function() {
        const modal = document.getElementById('modal-frente');
        modal.classList.add('hidden');
        this.editingFrente = null;
        this.clearFrenteForm();
    },

    fillFrenteForm: function(frente) {
        document.getElementById('frente-nome').value = frente.nome || '';
        document.getElementById('frente-fazenda').value = frente.fazenda || '';
        document.getElementById('frente-tipo').value = frente.tipo || 'propria';
        document.getElementById('frente-responsavel').value = frente.responsavel || '';
        document.getElementById('frente-status').value = frente.status || 'ativa';
        document.getElementById('frente-observacoes').value = frente.observacoes || '';
    },

    clearFrenteForm: function() {
        document.getElementById('form-frente').reset();
    },

    saveFrente: function() {
        try {
            const formData = {
                nome: document.getElementById('frente-nome').value,
                fazenda: document.getElementById('frente-fazenda').value,
                tipo: document.getElementById('frente-tipo').value,
                responsavel: document.getElementById('frente-responsavel').value,
                status: document.getElementById('frente-status').value,
                observacoes: document.getElementById('frente-observacoes').value
            };
            
            if (this.editingFrente) {
                formData.id = this.editingFrente.id;
                DB.frentes.update(formData);
                Toast.show('Frente atualizada com sucesso!', 'success');
            } else {
                DB.frentes.add(formData);
                Toast.show('Frente criada com sucesso!', 'success');
            }
            
            this.closeFrenteModal();
            this.loadFrentes();
            
            // Atualizar filtros nos gráficos
            this.updateChartFrentesFilter();
            
        } catch (error) {
            console.error('Erro ao salvar frente:', error);
            Toast.show(error.message, 'error');
        }
    },

    editFrente: function(id) {
        const frente = DB.frentes.get(id);
        if (frente) {
            this.openFrenteModal(frente);
        }
    },

    deleteFrente: function(id) {
        this.showConfirmDialog('Tem certeza que deseja excluir esta frente?', () => {
            try {
                DB.frentes.remove(id);
                Toast.show('Frente excluída com sucesso!', 'success');
                this.loadFrentes();
                this.updateChartFrentesFilter();
            } catch (error) {
                console.error('Erro ao excluir frente:', error);
                Toast.show(error.message, 'error');
            }
        });
    },

    loadMetas: function() {
        try {
            this.loadMetasData();
        } catch (error) {
            console.error('Erro ao carregar metas:', error);
            Toast.show('Erro ao carregar metas', 'error');
        }
    },

    loadMetasData: function() {
        const metas = DB.metas.getAll();
        const frentes = DB.frentes.getAll();
        
        const metasComFrente = metas.map(meta => {
            const frente = frentes.find(f => f.id === meta.frenteId);
            return {
                ...meta,
                frenteNome: frente ? frente.nome : 'Frente não encontrada'
            };
        });
        
        this.renderMetasTable(metasComFrente);
    },

    renderMetasTable: function(metas) {
        const tbody = document.getElementById('tabela-metas');
        if (!tbody) return;
        
        tbody.innerHTML = metas.map(meta => {
            const tipoColor = meta.tipo === 'propria' ? 'text-green-600 bg-green-100 dark:text-green-400 dark:bg-green-900' :
                             'text-blue-600 bg-blue-100 dark:text-blue-400 dark:bg-blue-900';
            
            return `
                <tr class="hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                    <td class="px-6 py-4 font-medium text-gray-800 dark:text-white">${meta.frenteNome}</td>
                    <td class="px-6 py-4">
                        <span class="px-2 py-1 text-xs rounded-full ${tipoColor}">${Utils.formatarStatus(meta.tipo)}</span>
                    </td>
                    <td class="px-6 py-4 text-gray-800 dark:text-gray-300">${Utils.formatarStatus(meta.periodo)}</td>
                    <td class="px-6 py-4 font-medium text-gray-800 dark:text-white">${Utils.formatarToneladas(meta.valor)}</td>
                    <td class="px-6 py-4 text-gray-800 dark:text-gray-300">${Utils.formatarData(meta.dataInicio)}</td>
                    <td class="px-6 py-4 text-gray-800 dark:text-gray-300">${Utils.formatarData(meta.dataFim)}</td>
                    <td class="px-6 py-4">
                        <div class="flex items-center space-x-2">
                            <button onclick="App.editMeta('${meta.id}')" class="text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button onclick="App.deleteMeta('${meta.id}')" class="text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                </tr>
            `;
        }).join('') || '<tr><td colspan="7" class="px-6 py-4 text-center text-gray-500 dark:text-gray-400">Nenhuma meta encontrada</td></tr>';
    },

    editMeta: function(id) {
        Toast.show('Funcionalidade em desenvolvimento', 'info');
    },

    deleteMeta: function(id) {
        this.showConfirmDialog('Tem certeza que deseja excluir esta meta?', () => {
            try {
                DB.metas.remove(id);
                Toast.show('Meta excluída com sucesso!', 'success');
                this.loadMetas();
            } catch (error) {
                console.error('Erro ao excluir meta:', error);
                Toast.show(error.message, 'error');
            }
        });
    },

    loadCaminhoes: function() {
        try {
            this.loadCaminhoesData();
        } catch (error) {
            console.error('Erro ao carregar caminhões:', error);
            Toast.show('Erro ao carregar caminhões', 'error');
        }
    },

    loadCaminhoesData: function() {
        const caminhoes = DB.caminhoes.getAll();
        this.renderCaminhoesTable(caminhoes);
    },

    renderCaminhoesTable: function(caminhoes) {
        const tbody = document.getElementById('tabela-caminhoes');
        if (!tbody) return;
        
        tbody.innerHTML = caminhoes.map(caminhao => {
            const statusColor = Utils.getStatusColor(caminhao.status);
            const tipoColor = caminhao.tipo === 'proprio' ? 'text-green-600 bg-green-100 dark:text-green-400 dark:bg-green-900' :
                             'text-blue-600 bg-blue-100 dark:text-blue-400 dark:bg-blue-900';
            
            return `
                <tr class="hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                    <td class="px-6 py-4 font-medium text-gray-800 dark:text-white">${caminhao.placa}</td>
                    <td class="px-6 py-4 text-gray-800 dark:text-gray-300">${caminhao.modelo}</td>
                    <td class="px-6 py-4">
                        <span class="px-2 py-1 text-xs rounded-full ${tipoColor}">${Utils.formatarStatus(caminhao.tipo)}</span>
                    </td>
                    <td class="px-6 py-4 text-gray-800 dark:text-gray-300">${caminhao.motorista}</td>
                    <td class="px-6 py-4 text-gray-800 dark:text-gray-300">${caminhao.capacidade} T</td>
                    <td class="px-6 py-4">
                        <span class="px-2 py-1 text-xs rounded-full ${statusColor}">${Utils.formatarStatus(caminhao.status)}</span>
                    </td>
                    <td class="px-6 py-4">
                        <div class="flex items-center space-x-2">
                            <button onclick="App.editCaminhao('${caminhao.id}')" class="text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button onclick="App.deleteCaminhao('${caminhao.id}')" class="text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                </tr>
            `;
        }).join('') || '<tr><td colspan="7" class="px-6 py-4 text-center text-gray-500 dark:text-gray-400">Nenhum caminhão encontrado</td></tr>';
    },

    editCaminhao: function(id) {
        Toast.show('Funcionalidade em desenvolvimento', 'info');
    },

    deleteCaminhao: function(id) {
        this.showConfirmDialog('Tem certeza que deseja excluir este caminhão?', () => {
            try {
                DB.caminhoes.remove(id);
                Toast.show('Caminhão excluído com sucesso!', 'success');
                this.loadCaminhoes();
            } catch (error) {
                console.error('Erro ao excluir caminhão:', error);
                Toast.show(error.message, 'error');
            }
        });
    },

    loadRelatorios: function() {
        Toast.show('Módulo de relatórios em desenvolvimento', 'info');
    },

    loadConfiguracoes: function() {
        Toast.show('Carregando configurações...', 'info');
    },

    // Funções auxiliares que estavam faltando (IMPLEMENTADAS COMPLETAS)
    initConfigEventListeners: function() {
        // Export data
        const exportBtn = document.getElementById('btn-export-data');
        if (exportBtn) {
            exportBtn.addEventListener('click', () => {
                try {
                    const data = DB.exportData();
                    const blob = new Blob([data], { type: 'application/json' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `ggomes-backup-${new Date().toISOString().split('T')[0]}.json`;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                    Toast.show('Backup exportado com sucesso!', 'success');
                } catch (error) {
                    Toast.show('Erro ao exportar dados', 'error');
                }
            });
        }

        // Import data
        const importBtn = document.getElementById('btn-import-data');
        if (importBtn) {
            importBtn.addEventListener('click', () => {
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = '.json';
                input.onchange = (e) => {
                    const file = e.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = (e) => {
                            try {
                                DB.importData(e.target.result);
                                Toast.show('Dados importados com sucesso!', 'success');
                                this.loadDashboard();
                            } catch (error) {
                                Toast.show('Erro ao importar dados: ' + error.message, 'error');
                            }
                        };
                        reader.readAsText(file);
                    }
                };
                input.click();
            });
        }

        // Clear data
        const clearBtn = document.getElementById('btn-clear-data');
        if (clearBtn) {
            clearBtn.addEventListener('click', () => {
                this.showConfirmDialog('Tem certeza que deseja limpar todos os dados? Esta ação não pode ser desfeita.', () => {
                    if (DB.clearAll()) {
                        Toast.show('Dados limpos com sucesso!', 'success');
                        this.loadDashboard();
                    } else {
                        Toast.show('Erro ao limpar dados', 'error');
                    }
                });
            });
        }
    },

    initTabEventListeners: function() {
        // Links da sidebar
        document.querySelectorAll('.sidebar-link').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const page = link.getAttribute('href').replace('#', '');
                this.navigateTo(page);
            });
        });
    },

    initFormEventListeners: function() {
        // Implementação básica para formulários
        // Event listeners para filtros de acompanhamento
        const filtroFrente = document.getElementById('filtro-frente-acomp');
        const filtroFazenda = document.getElementById('filtro-fazenda-acomp');
        const filtroPeriodo = document.getElementById('filtro-periodo-acomp');
        
        if (filtroFrente) {
            filtroFrente.addEventListener('change', () => {
                this.applyAcompanhamentoFilters();
            });
        }
        
        if (filtroFazenda) {
            filtroFazenda.addEventListener('change', () => {
                this.applyAcompanhamentoFilters();
            });
        }
        
        if (filtroPeriodo) {
            filtroPeriodo.addEventListener('change', () => {
                const periodoPersonalizado = document.getElementById('periodo-personalizado-acomp');
                if (filtroPeriodo.value === 'personalizado') {
                    periodoPersonalizado.classList.remove('hidden');
                } else {
                    periodoPersonalizado.classList.add('hidden');
                }
                this.applyAcompanhamentoFilters();
            });
        }
        
        // Event listeners para filtros de liberações
        const filtroFrenteLib = document.getElementById('filtro-frente-lib');
        const filtroStatusLib = document.getElementById('filtro-status-lib');
        const filtroFazendaLib = document.getElementById('filtro-fazenda-lib');
        
        if (filtroFrenteLib) {
            filtroFrenteLib.addEventListener('change', () => {
                this.applyLiberacoesFilters();
            });
        }
        
        if (filtroStatusLib) {
            filtroStatusLib.addEventListener('change', () => {
                this.applyLiberacoesFilters();
            });
        }
        
        if (filtroFazendaLib) {
            filtroFazendaLib.addEventListener('change', () => {
                this.applyLiberacoesFilters();
            });
        }
    },

    applyAcompanhamentoFilters: function() {
        const filtroFrente = document.getElementById('filtro-frente-acomp').value;
        const filtroFazenda = document.getElementById('filtro-fazenda-acomp').value;
        const filtroPeriodo = document.getElementById('filtro-periodo-acomp').value;
        
        // Implementar lógica de filtros
        this.loadAcompanhamentoData();
        Toast.show('Filtros aplicados', 'success');
    },

    applyLiberacoesFilters: function() {
        const filtroFrente = document.getElementById('filtro-frente-lib').value;
        const filtroStatus = document.getElementById('filtro-status-lib').value;
        const filtroFazenda = document.getElementById('filtro-fazenda-lib').value;
        
        let liberacoes = DB.liberacoes.getAll();
        
        if (filtroFrente) {
            liberacoes = liberacoes.filter(l => l.frente === filtroFrente);
        }
        
        if (filtroStatus) {
            liberacoes = liberacoes.filter(l => l.status === filtroStatus);
        }
        
        if (filtroFazenda) {
            liberacoes = liberacoes.filter(l => l.fazenda === filtroFazenda);
        }
        
        this.renderLiberacoesTable(liberacoes);
        document.getElementById('total-liberacoes').textContent = liberacoes.length;
    },

    performGlobalSearch: function(query) {
        if (!query.trim()) return;
        
        // Implementar busca global
        Toast.show(`Buscando por: "${query}"`, 'info');
    },

    sortAcompanhamento: function(field) {
        if (currentAcompanhamentoSort.field === field) {
            currentAcompanhamentoSort.direction = currentAcompanhamentoSort.direction === 'asc' ? 'desc' : 'asc';
        } else {
            currentAcompanhamentoSort = { field, direction: 'asc' };
        }
        
        this.loadAcompanhamentoData();
    },

    showNotifications: function() {
        Toast.show('Sistema de notificações em desenvolvimento', 'info');
    },

    toggleAutoRefresh: function() {
        AppConfig.autoRefresh = !AppConfig.autoRefresh;
        const btn = document.getElementById('btn-auto-refresh-acompanhamento');
        
        if (AppConfig.autoRefresh) {
            AppConfig.refreshInterval = setInterval(() => {
                this.loadDashboard();
                this.loadAcompanhamento();
            }, 30000); // 30 segundos
            if (btn) btn.innerHTML = '<i class="fas fa-sync-alt mr-2"></i>Auto-refresh ON';
            Toast.show('Auto-refresh ativado (30s)', 'success');
        } else {
            if (AppConfig.refreshInterval) {
                clearInterval(AppConfig.refreshInterval);
            }
            if (btn) btn.innerHTML = '<i class="fas fa-sync-alt mr-2"></i>Auto-refresh OFF';
            Toast.show('Auto-refresh desativado', 'info');
        }
    },

    // Função de diálogo personalizada (substitui confirm/alert)
    showConfirmDialog: function(message, onConfirm) {
        const modal = document.createElement('div');
        modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
        modal.innerHTML = `
            <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg max-w-sm w-full mx-4">
                <p class="text-gray-700 dark:text-gray-300 mb-4">${message}</p>
                <div class="flex justify-end space-x-3">
                    <button class="cancel-btn px-4 py-2 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded transition-all-300">Cancelar</button>
                    <button class="confirm-btn px-4 py-2 bg-red-500 text-white hover:bg-red-600 rounded transition-all-300">Confirmar</button>
                </div>
            </div>
        `;
        
        const cancelBtn = modal.querySelector('.cancel-btn');
        const confirmBtn = modal.querySelector('.confirm-btn');
        
        cancelBtn.addEventListener('click', () => {
            document.body.removeChild(modal);
        });
        
        confirmBtn.addEventListener('click', () => {
            document.body.removeChild(modal);
            onConfirm();
        });
        
        document.body.appendChild(modal);
        return true;
    }
};

// Inicialização da aplicação
document.addEventListener('DOMContentLoaded', function() {
    try {
        App.init();
    } catch (error) {
        console.error('Erro crítico na inicialização:', error);
        Toast.show('Erro crítico na inicialização da aplicação', 'error');
    }
});

// Export para debug (se necessário)
window.GGOMES = { App, DB, ChartManager, Utils, Toast, AppConfig };

console.log('🚀 GGOMES-LOG v2.1 Avançado com Filtros carregado com sucesso!');

</script>
</body>
</html>
